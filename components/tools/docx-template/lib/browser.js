var commonjsGlobal=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},buffer$1={},base64Js={};base64Js.byteLength=byteLength,base64Js.toByteArray=toByteArray,base64Js.fromByteArray=fromByteArray;for(var lookup=[],revLookup=[],Arr=typeof Uint8Array!="undefined"?Uint8Array:Array,code="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i$2=0,len=code.length;i$2<len;++i$2)lookup[i$2]=code[i$2],revLookup[code.charCodeAt(i$2)]=i$2;revLookup["-".charCodeAt(0)]=62,revLookup["_".charCodeAt(0)]=63;function getLens(e){var r=e.length;if(r%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var t=e.indexOf("=");t===-1&&(t=r);var v=t===r?0:4-t%4;return[t,v]}function byteLength(e){var r=getLens(e),t=r[0],v=r[1];return(t+v)*3/4-v}function _byteLength(e,r,t){return(r+t)*3/4-t}function toByteArray(e){var r,t=getLens(e),v=t[0],I=t[1],b=new Arr(_byteLength(e,v,I)),N=0,T=I>0?v-4:v,ae;for(ae=0;ae<T;ae+=4)r=revLookup[e.charCodeAt(ae)]<<18|revLookup[e.charCodeAt(ae+1)]<<12|revLookup[e.charCodeAt(ae+2)]<<6|revLookup[e.charCodeAt(ae+3)],b[N++]=r>>16&255,b[N++]=r>>8&255,b[N++]=r&255;return I===2&&(r=revLookup[e.charCodeAt(ae)]<<2|revLookup[e.charCodeAt(ae+1)]>>4,b[N++]=r&255),I===1&&(r=revLookup[e.charCodeAt(ae)]<<10|revLookup[e.charCodeAt(ae+1)]<<4|revLookup[e.charCodeAt(ae+2)]>>2,b[N++]=r>>8&255,b[N++]=r&255),b}function tripletToBase64(e){return lookup[e>>18&63]+lookup[e>>12&63]+lookup[e>>6&63]+lookup[e&63]}function encodeChunk(e,r,t){for(var v,I=[],b=r;b<t;b+=3)v=(e[b]<<16&16711680)+(e[b+1]<<8&65280)+(e[b+2]&255),I.push(tripletToBase64(v));return I.join("")}function fromByteArray(e){for(var r,t=e.length,v=t%3,I=[],b=16383,N=0,T=t-v;N<T;N+=b)I.push(encodeChunk(e,N,N+b>T?T:N+b));return v===1?(r=e[t-1],I.push(lookup[r>>2]+lookup[r<<4&63]+"==")):v===2&&(r=(e[t-2]<<8)+e[t-1],I.push(lookup[r>>10]+lookup[r>>4&63]+lookup[r<<2&63]+"=")),I.join("")}var ieee754={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */ieee754.read=function(e,r,t,v,I){var b,N,T=I*8-v-1,ae=(1<<T)-1,X=ae>>1,G=-7,ve=t?I-1:0,fe=t?-1:1,ce=e[r+ve];for(ve+=fe,b=ce&(1<<-G)-1,ce>>=-G,G+=T;G>0;b=b*256+e[r+ve],ve+=fe,G-=8);for(N=b&(1<<-G)-1,b>>=-G,G+=v;G>0;N=N*256+e[r+ve],ve+=fe,G-=8);if(b===0)b=1-X;else{if(b===ae)return N?NaN:(ce?-1:1)*(1/0);N=N+Math.pow(2,v),b=b-X}return(ce?-1:1)*N*Math.pow(2,b-v)},ieee754.write=function(e,r,t,v,I,b){var N,T,ae,X=b*8-I-1,G=(1<<X)-1,ve=G>>1,fe=I===23?Math.pow(2,-24)-Math.pow(2,-77):0,ce=v?0:b-1,_e=v?1:-1,Ee=r<0||r===0&&1/r<0?1:0;for(r=Math.abs(r),isNaN(r)||r===1/0?(T=isNaN(r)?1:0,N=G):(N=Math.floor(Math.log(r)/Math.LN2),r*(ae=Math.pow(2,-N))<1&&(N--,ae*=2),N+ve>=1?r+=fe/ae:r+=fe*Math.pow(2,1-ve),r*ae>=2&&(N++,ae/=2),N+ve>=G?(T=0,N=G):N+ve>=1?(T=(r*ae-1)*Math.pow(2,I),N=N+ve):(T=r*Math.pow(2,ve-1)*Math.pow(2,I),N=0));I>=8;e[t+ce]=T&255,ce+=_e,T/=256,I-=8);for(N=N<<I|T,X+=I;X>0;e[t+ce]=N&255,ce+=_e,N/=256,X-=8);e[t+ce-_e]|=Ee*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(e){const r=base64Js,t=ieee754,v=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;e.Buffer=T,e.SlowBuffer=Te,e.INSPECT_MAX_BYTES=50;const I=2147483647;e.kMaxLength=I,T.TYPED_ARRAY_SUPPORT=b(),!T.TYPED_ARRAY_SUPPORT&&typeof console!="undefined"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function b(){try{const P=new Uint8Array(1),x={foo:function(){return 42}};return Object.setPrototypeOf(x,Uint8Array.prototype),Object.setPrototypeOf(P,x),P.foo()===42}catch(P){return!1}}Object.defineProperty(T.prototype,"parent",{enumerable:!0,get:function(){if(!!T.isBuffer(this))return this.buffer}}),Object.defineProperty(T.prototype,"offset",{enumerable:!0,get:function(){if(!!T.isBuffer(this))return this.byteOffset}});function N(P){if(P>I)throw new RangeError('The value "'+P+'" is invalid for option "size"');const x=new Uint8Array(P);return Object.setPrototypeOf(x,T.prototype),x}function T(P,x,$){if(typeof P=="number"){if(typeof x=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return ve(P)}return ae(P,x,$)}T.poolSize=8192;function ae(P,x,$){if(typeof P=="string")return fe(P,x);if(ArrayBuffer.isView(P))return _e(P);if(P==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof P);if(Ke(P,ArrayBuffer)||P&&Ke(P.buffer,ArrayBuffer)||typeof SharedArrayBuffer!="undefined"&&(Ke(P,SharedArrayBuffer)||P&&Ke(P.buffer,SharedArrayBuffer)))return Ee(P,x,$);if(typeof P=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const le=P.valueOf&&P.valueOf();if(le!=null&&le!==P)return T.from(le,x,$);const pe=ye(P);if(pe)return pe;if(typeof Symbol!="undefined"&&Symbol.toPrimitive!=null&&typeof P[Symbol.toPrimitive]=="function")return T.from(P[Symbol.toPrimitive]("string"),x,$);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof P)}T.from=function(P,x,$){return ae(P,x,$)},Object.setPrototypeOf(T.prototype,Uint8Array.prototype),Object.setPrototypeOf(T,Uint8Array);function X(P){if(typeof P!="number")throw new TypeError('"size" argument must be of type number');if(P<0)throw new RangeError('The value "'+P+'" is invalid for option "size"')}function G(P,x,$){return X(P),P<=0?N(P):x!==void 0?typeof $=="string"?N(P).fill(x,$):N(P).fill(x):N(P)}T.alloc=function(P,x,$){return G(P,x,$)};function ve(P){return X(P),N(P<0?0:be(P)|0)}T.allocUnsafe=function(P){return ve(P)},T.allocUnsafeSlow=function(P){return ve(P)};function fe(P,x){if((typeof x!="string"||x==="")&&(x="utf8"),!T.isEncoding(x))throw new TypeError("Unknown encoding: "+x);const $=Ae(P,x)|0;let le=N($);const pe=le.write(P,x);return pe!==$&&(le=le.slice(0,pe)),le}function ce(P){const x=P.length<0?0:be(P.length)|0,$=N(x);for(let le=0;le<x;le+=1)$[le]=P[le]&255;return $}function _e(P){if(Ke(P,Uint8Array)){const x=new Uint8Array(P);return Ee(x.buffer,x.byteOffset,x.byteLength)}return ce(P)}function Ee(P,x,$){if(x<0||P.byteLength<x)throw new RangeError('"offset" is outside of buffer bounds');if(P.byteLength<x+($||0))throw new RangeError('"length" is outside of buffer bounds');let le;return x===void 0&&$===void 0?le=new Uint8Array(P):$===void 0?le=new Uint8Array(P,x):le=new Uint8Array(P,x,$),Object.setPrototypeOf(le,T.prototype),le}function ye(P){if(T.isBuffer(P)){const x=be(P.length)|0,$=N(x);return $.length===0||P.copy($,0,0,x),$}if(P.length!==void 0)return typeof P.length!="number"||ht(P.length)?N(0):ce(P);if(P.type==="Buffer"&&Array.isArray(P.data))return ce(P.data)}function be(P){if(P>=I)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+I.toString(16)+" bytes");return P|0}function Te(P){return+P!=P&&(P=0),T.alloc(+P)}T.isBuffer=function(x){return x!=null&&x._isBuffer===!0&&x!==T.prototype},T.compare=function(x,$){if(Ke(x,Uint8Array)&&(x=T.from(x,x.offset,x.byteLength)),Ke($,Uint8Array)&&($=T.from($,$.offset,$.byteLength)),!T.isBuffer(x)||!T.isBuffer($))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(x===$)return 0;let le=x.length,pe=$.length;for(let ge=0,we=Math.min(le,pe);ge<we;++ge)if(x[ge]!==$[ge]){le=x[ge],pe=$[ge];break}return le<pe?-1:pe<le?1:0},T.isEncoding=function(x){switch(String(x).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},T.concat=function(x,$){if(!Array.isArray(x))throw new TypeError('"list" argument must be an Array of Buffers');if(x.length===0)return T.alloc(0);let le;if($===void 0)for($=0,le=0;le<x.length;++le)$+=x[le].length;const pe=T.allocUnsafe($);let ge=0;for(le=0;le<x.length;++le){let we=x[le];if(Ke(we,Uint8Array))ge+we.length>pe.length?(T.isBuffer(we)||(we=T.from(we)),we.copy(pe,ge)):Uint8Array.prototype.set.call(pe,we,ge);else if(T.isBuffer(we))we.copy(pe,ge);else throw new TypeError('"list" argument must be an Array of Buffers');ge+=we.length}return pe};function Ae(P,x){if(T.isBuffer(P))return P.length;if(ArrayBuffer.isView(P)||Ke(P,ArrayBuffer))return P.byteLength;if(typeof P!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof P);const $=P.length,le=arguments.length>2&&arguments[2]===!0;if(!le&&$===0)return 0;let pe=!1;for(;;)switch(x){case"ascii":case"latin1":case"binary":return $;case"utf8":case"utf-8":return je(P).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return $*2;case"hex":return $>>>1;case"base64":return lt(P).length;default:if(pe)return le?-1:je(P).length;x=(""+x).toLowerCase(),pe=!0}}T.byteLength=Ae;function Se(P,x,$){let le=!1;if((x===void 0||x<0)&&(x=0),x>this.length||(($===void 0||$>this.length)&&($=this.length),$<=0)||($>>>=0,x>>>=0,$<=x))return"";for(P||(P="utf8");;)switch(P){case"hex":return nt(this,x,$);case"utf8":case"utf-8":return Ve(this,x,$);case"ascii":return Re(this,x,$);case"latin1":case"binary":return Qe(this,x,$);case"base64":return We(this,x,$);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return at(this,x,$);default:if(le)throw new TypeError("Unknown encoding: "+P);P=(P+"").toLowerCase(),le=!0}}T.prototype._isBuffer=!0;function $e(P,x,$){const le=P[x];P[x]=P[$],P[$]=le}T.prototype.swap16=function(){const x=this.length;if(x%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let $=0;$<x;$+=2)$e(this,$,$+1);return this},T.prototype.swap32=function(){const x=this.length;if(x%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let $=0;$<x;$+=4)$e(this,$,$+3),$e(this,$+1,$+2);return this},T.prototype.swap64=function(){const x=this.length;if(x%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let $=0;$<x;$+=8)$e(this,$,$+7),$e(this,$+1,$+6),$e(this,$+2,$+5),$e(this,$+3,$+4);return this},T.prototype.toString=function(){const x=this.length;return x===0?"":arguments.length===0?Ve(this,0,x):Se.apply(this,arguments)},T.prototype.toLocaleString=T.prototype.toString,T.prototype.equals=function(x){if(!T.isBuffer(x))throw new TypeError("Argument must be a Buffer");return this===x?!0:T.compare(this,x)===0},T.prototype.inspect=function(){let x="";const $=e.INSPECT_MAX_BYTES;return x=this.toString("hex",0,$).replace(/(.{2})/g,"$1 ").trim(),this.length>$&&(x+=" ... "),"<Buffer "+x+">"},v&&(T.prototype[v]=T.prototype.inspect),T.prototype.compare=function(x,$,le,pe,ge){if(Ke(x,Uint8Array)&&(x=T.from(x,x.offset,x.byteLength)),!T.isBuffer(x))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof x);if($===void 0&&($=0),le===void 0&&(le=x?x.length:0),pe===void 0&&(pe=0),ge===void 0&&(ge=this.length),$<0||le>x.length||pe<0||ge>this.length)throw new RangeError("out of range index");if(pe>=ge&&$>=le)return 0;if(pe>=ge)return-1;if($>=le)return 1;if($>>>=0,le>>>=0,pe>>>=0,ge>>>=0,this===x)return 0;let we=ge-pe,Oe=le-$;const ze=Math.min(we,Oe),Pe=this.slice(pe,ge),He=x.slice($,le);for(let Le=0;Le<ze;++Le)if(Pe[Le]!==He[Le]){we=Pe[Le],Oe=He[Le];break}return we<Oe?-1:Oe<we?1:0};function ke(P,x,$,le,pe){if(P.length===0)return-1;if(typeof $=="string"?(le=$,$=0):$>2147483647?$=2147483647:$<-2147483648&&($=-2147483648),$=+$,ht($)&&($=pe?0:P.length-1),$<0&&($=P.length+$),$>=P.length){if(pe)return-1;$=P.length-1}else if($<0)if(pe)$=0;else return-1;if(typeof x=="string"&&(x=T.from(x,le)),T.isBuffer(x))return x.length===0?-1:Ne(P,x,$,le,pe);if(typeof x=="number")return x=x&255,typeof Uint8Array.prototype.indexOf=="function"?pe?Uint8Array.prototype.indexOf.call(P,x,$):Uint8Array.prototype.lastIndexOf.call(P,x,$):Ne(P,[x],$,le,pe);throw new TypeError("val must be string, number or Buffer")}function Ne(P,x,$,le,pe){let ge=1,we=P.length,Oe=x.length;if(le!==void 0&&(le=String(le).toLowerCase(),le==="ucs2"||le==="ucs-2"||le==="utf16le"||le==="utf-16le")){if(P.length<2||x.length<2)return-1;ge=2,we/=2,Oe/=2,$/=2}function ze(He,Le){return ge===1?He[Le]:He.readUInt16BE(Le*ge)}let Pe;if(pe){let He=-1;for(Pe=$;Pe<we;Pe++)if(ze(P,Pe)===ze(x,He===-1?0:Pe-He)){if(He===-1&&(He=Pe),Pe-He+1===Oe)return He*ge}else He!==-1&&(Pe-=Pe-He),He=-1}else for($+Oe>we&&($=we-Oe),Pe=$;Pe>=0;Pe--){let He=!0;for(let Le=0;Le<Oe;Le++)if(ze(P,Pe+Le)!==ze(x,Le)){He=!1;break}if(He)return Pe}return-1}T.prototype.includes=function(x,$,le){return this.indexOf(x,$,le)!==-1},T.prototype.indexOf=function(x,$,le){return ke(this,x,$,le,!0)},T.prototype.lastIndexOf=function(x,$,le){return ke(this,x,$,le,!1)};function Ce(P,x,$,le){$=Number($)||0;const pe=P.length-$;le?(le=Number(le),le>pe&&(le=pe)):le=pe;const ge=x.length;le>ge/2&&(le=ge/2);let we;for(we=0;we<le;++we){const Oe=parseInt(x.substr(we*2,2),16);if(ht(Oe))return we;P[$+we]=Oe}return we}function he(P,x,$,le){return rt(je(x,P.length-$),P,$,le)}function Be(P,x,$,le){return rt(qe(x),P,$,le)}function Ie(P,x,$,le){return rt(lt(x),P,$,le)}function De(P,x,$,le){return rt(ct(x,P.length-$),P,$,le)}T.prototype.write=function(x,$,le,pe){if($===void 0)pe="utf8",le=this.length,$=0;else if(le===void 0&&typeof $=="string")pe=$,le=this.length,$=0;else if(isFinite($))$=$>>>0,isFinite(le)?(le=le>>>0,pe===void 0&&(pe="utf8")):(pe=le,le=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const ge=this.length-$;if((le===void 0||le>ge)&&(le=ge),x.length>0&&(le<0||$<0)||$>this.length)throw new RangeError("Attempt to write outside buffer bounds");pe||(pe="utf8");let we=!1;for(;;)switch(pe){case"hex":return Ce(this,x,$,le);case"utf8":case"utf-8":return he(this,x,$,le);case"ascii":case"latin1":case"binary":return Be(this,x,$,le);case"base64":return Ie(this,x,$,le);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return De(this,x,$,le);default:if(we)throw new TypeError("Unknown encoding: "+pe);pe=(""+pe).toLowerCase(),we=!0}},T.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function We(P,x,$){return x===0&&$===P.length?r.fromByteArray(P):r.fromByteArray(P.slice(x,$))}function Ve(P,x,$){$=Math.min(P.length,$);const le=[];let pe=x;for(;pe<$;){const ge=P[pe];let we=null,Oe=ge>239?4:ge>223?3:ge>191?2:1;if(pe+Oe<=$){let ze,Pe,He,Le;switch(Oe){case 1:ge<128&&(we=ge);break;case 2:ze=P[pe+1],(ze&192)===128&&(Le=(ge&31)<<6|ze&63,Le>127&&(we=Le));break;case 3:ze=P[pe+1],Pe=P[pe+2],(ze&192)===128&&(Pe&192)===128&&(Le=(ge&15)<<12|(ze&63)<<6|Pe&63,Le>2047&&(Le<55296||Le>57343)&&(we=Le));break;case 4:ze=P[pe+1],Pe=P[pe+2],He=P[pe+3],(ze&192)===128&&(Pe&192)===128&&(He&192)===128&&(Le=(ge&15)<<18|(ze&63)<<12|(Pe&63)<<6|He&63,Le>65535&&Le<1114112&&(we=Le))}}we===null?(we=65533,Oe=1):we>65535&&(we-=65536,le.push(we>>>10&1023|55296),we=56320|we&1023),le.push(we),pe+=Oe}return et(le)}const Xe=4096;function et(P){const x=P.length;if(x<=Xe)return String.fromCharCode.apply(String,P);let $="",le=0;for(;le<x;)$+=String.fromCharCode.apply(String,P.slice(le,le+=Xe));return $}function Re(P,x,$){let le="";$=Math.min(P.length,$);for(let pe=x;pe<$;++pe)le+=String.fromCharCode(P[pe]&127);return le}function Qe(P,x,$){let le="";$=Math.min(P.length,$);for(let pe=x;pe<$;++pe)le+=String.fromCharCode(P[pe]);return le}function nt(P,x,$){const le=P.length;(!x||x<0)&&(x=0),(!$||$<0||$>le)&&($=le);let pe="";for(let ge=x;ge<$;++ge)pe+=dt[P[ge]];return pe}function at(P,x,$){const le=P.slice(x,$);let pe="";for(let ge=0;ge<le.length-1;ge+=2)pe+=String.fromCharCode(le[ge]+le[ge+1]*256);return pe}T.prototype.slice=function(x,$){const le=this.length;x=~~x,$=$===void 0?le:~~$,x<0?(x+=le,x<0&&(x=0)):x>le&&(x=le),$<0?($+=le,$<0&&($=0)):$>le&&($=le),$<x&&($=x);const pe=this.subarray(x,$);return Object.setPrototypeOf(pe,T.prototype),pe};function Me(P,x,$){if(P%1!==0||P<0)throw new RangeError("offset is not uint");if(P+x>$)throw new RangeError("Trying to access beyond buffer length")}T.prototype.readUintLE=T.prototype.readUIntLE=function(x,$,le){x=x>>>0,$=$>>>0,le||Me(x,$,this.length);let pe=this[x],ge=1,we=0;for(;++we<$&&(ge*=256);)pe+=this[x+we]*ge;return pe},T.prototype.readUintBE=T.prototype.readUIntBE=function(x,$,le){x=x>>>0,$=$>>>0,le||Me(x,$,this.length);let pe=this[x+--$],ge=1;for(;$>0&&(ge*=256);)pe+=this[x+--$]*ge;return pe},T.prototype.readUint8=T.prototype.readUInt8=function(x,$){return x=x>>>0,$||Me(x,1,this.length),this[x]},T.prototype.readUint16LE=T.prototype.readUInt16LE=function(x,$){return x=x>>>0,$||Me(x,2,this.length),this[x]|this[x+1]<<8},T.prototype.readUint16BE=T.prototype.readUInt16BE=function(x,$){return x=x>>>0,$||Me(x,2,this.length),this[x]<<8|this[x+1]},T.prototype.readUint32LE=T.prototype.readUInt32LE=function(x,$){return x=x>>>0,$||Me(x,4,this.length),(this[x]|this[x+1]<<8|this[x+2]<<16)+this[x+3]*16777216},T.prototype.readUint32BE=T.prototype.readUInt32BE=function(x,$){return x=x>>>0,$||Me(x,4,this.length),this[x]*16777216+(this[x+1]<<16|this[x+2]<<8|this[x+3])},T.prototype.readBigUInt64LE=it(function(x){x=x>>>0,Ue(x,"offset");const $=this[x],le=this[x+7];($===void 0||le===void 0)&&Ge(x,this.length-8);const pe=$+this[++x]*2**8+this[++x]*2**16+this[++x]*2**24,ge=this[++x]+this[++x]*2**8+this[++x]*2**16+le*2**24;return BigInt(pe)+(BigInt(ge)<<BigInt(32))}),T.prototype.readBigUInt64BE=it(function(x){x=x>>>0,Ue(x,"offset");const $=this[x],le=this[x+7];($===void 0||le===void 0)&&Ge(x,this.length-8);const pe=$*2**24+this[++x]*2**16+this[++x]*2**8+this[++x],ge=this[++x]*2**24+this[++x]*2**16+this[++x]*2**8+le;return(BigInt(pe)<<BigInt(32))+BigInt(ge)}),T.prototype.readIntLE=function(x,$,le){x=x>>>0,$=$>>>0,le||Me(x,$,this.length);let pe=this[x],ge=1,we=0;for(;++we<$&&(ge*=256);)pe+=this[x+we]*ge;return ge*=128,pe>=ge&&(pe-=Math.pow(2,8*$)),pe},T.prototype.readIntBE=function(x,$,le){x=x>>>0,$=$>>>0,le||Me(x,$,this.length);let pe=$,ge=1,we=this[x+--pe];for(;pe>0&&(ge*=256);)we+=this[x+--pe]*ge;return ge*=128,we>=ge&&(we-=Math.pow(2,8*$)),we},T.prototype.readInt8=function(x,$){return x=x>>>0,$||Me(x,1,this.length),this[x]&128?(255-this[x]+1)*-1:this[x]},T.prototype.readInt16LE=function(x,$){x=x>>>0,$||Me(x,2,this.length);const le=this[x]|this[x+1]<<8;return le&32768?le|4294901760:le},T.prototype.readInt16BE=function(x,$){x=x>>>0,$||Me(x,2,this.length);const le=this[x+1]|this[x]<<8;return le&32768?le|4294901760:le},T.prototype.readInt32LE=function(x,$){return x=x>>>0,$||Me(x,4,this.length),this[x]|this[x+1]<<8|this[x+2]<<16|this[x+3]<<24},T.prototype.readInt32BE=function(x,$){return x=x>>>0,$||Me(x,4,this.length),this[x]<<24|this[x+1]<<16|this[x+2]<<8|this[x+3]},T.prototype.readBigInt64LE=it(function(x){x=x>>>0,Ue(x,"offset");const $=this[x],le=this[x+7];($===void 0||le===void 0)&&Ge(x,this.length-8);const pe=this[x+4]+this[x+5]*2**8+this[x+6]*2**16+(le<<24);return(BigInt(pe)<<BigInt(32))+BigInt($+this[++x]*2**8+this[++x]*2**16+this[++x]*2**24)}),T.prototype.readBigInt64BE=it(function(x){x=x>>>0,Ue(x,"offset");const $=this[x],le=this[x+7];($===void 0||le===void 0)&&Ge(x,this.length-8);const pe=($<<24)+this[++x]*2**16+this[++x]*2**8+this[++x];return(BigInt(pe)<<BigInt(32))+BigInt(this[++x]*2**24+this[++x]*2**16+this[++x]*2**8+le)}),T.prototype.readFloatLE=function(x,$){return x=x>>>0,$||Me(x,4,this.length),t.read(this,x,!0,23,4)},T.prototype.readFloatBE=function(x,$){return x=x>>>0,$||Me(x,4,this.length),t.read(this,x,!1,23,4)},T.prototype.readDoubleLE=function(x,$){return x=x>>>0,$||Me(x,8,this.length),t.read(this,x,!0,52,8)},T.prototype.readDoubleBE=function(x,$){return x=x>>>0,$||Me(x,8,this.length),t.read(this,x,!1,52,8)};function Ye(P,x,$,le,pe,ge){if(!T.isBuffer(P))throw new TypeError('"buffer" argument must be a Buffer instance');if(x>pe||x<ge)throw new RangeError('"value" argument is out of bounds');if($+le>P.length)throw new RangeError("Index out of range")}T.prototype.writeUintLE=T.prototype.writeUIntLE=function(x,$,le,pe){if(x=+x,$=$>>>0,le=le>>>0,!pe){const Oe=Math.pow(2,8*le)-1;Ye(this,x,$,le,Oe,0)}let ge=1,we=0;for(this[$]=x&255;++we<le&&(ge*=256);)this[$+we]=x/ge&255;return $+le},T.prototype.writeUintBE=T.prototype.writeUIntBE=function(x,$,le,pe){if(x=+x,$=$>>>0,le=le>>>0,!pe){const Oe=Math.pow(2,8*le)-1;Ye(this,x,$,le,Oe,0)}let ge=le-1,we=1;for(this[$+ge]=x&255;--ge>=0&&(we*=256);)this[$+ge]=x/we&255;return $+le},T.prototype.writeUint8=T.prototype.writeUInt8=function(x,$,le){return x=+x,$=$>>>0,le||Ye(this,x,$,1,255,0),this[$]=x&255,$+1},T.prototype.writeUint16LE=T.prototype.writeUInt16LE=function(x,$,le){return x=+x,$=$>>>0,le||Ye(this,x,$,2,65535,0),this[$]=x&255,this[$+1]=x>>>8,$+2},T.prototype.writeUint16BE=T.prototype.writeUInt16BE=function(x,$,le){return x=+x,$=$>>>0,le||Ye(this,x,$,2,65535,0),this[$]=x>>>8,this[$+1]=x&255,$+2},T.prototype.writeUint32LE=T.prototype.writeUInt32LE=function(x,$,le){return x=+x,$=$>>>0,le||Ye(this,x,$,4,4294967295,0),this[$+3]=x>>>24,this[$+2]=x>>>16,this[$+1]=x>>>8,this[$]=x&255,$+4},T.prototype.writeUint32BE=T.prototype.writeUInt32BE=function(x,$,le){return x=+x,$=$>>>0,le||Ye(this,x,$,4,4294967295,0),this[$]=x>>>24,this[$+1]=x>>>16,this[$+2]=x>>>8,this[$+3]=x&255,$+4};function ft(P,x,$,le,pe){Ze(x,le,pe,P,$,7);let ge=Number(x&BigInt(4294967295));P[$++]=ge,ge=ge>>8,P[$++]=ge,ge=ge>>8,P[$++]=ge,ge=ge>>8,P[$++]=ge;let we=Number(x>>BigInt(32)&BigInt(4294967295));return P[$++]=we,we=we>>8,P[$++]=we,we=we>>8,P[$++]=we,we=we>>8,P[$++]=we,$}function ot(P,x,$,le,pe){Ze(x,le,pe,P,$,7);let ge=Number(x&BigInt(4294967295));P[$+7]=ge,ge=ge>>8,P[$+6]=ge,ge=ge>>8,P[$+5]=ge,ge=ge>>8,P[$+4]=ge;let we=Number(x>>BigInt(32)&BigInt(4294967295));return P[$+3]=we,we=we>>8,P[$+2]=we,we=we>>8,P[$+1]=we,we=we>>8,P[$]=we,$+8}T.prototype.writeBigUInt64LE=it(function(x,$=0){return ft(this,x,$,BigInt(0),BigInt("0xffffffffffffffff"))}),T.prototype.writeBigUInt64BE=it(function(x,$=0){return ot(this,x,$,BigInt(0),BigInt("0xffffffffffffffff"))}),T.prototype.writeIntLE=function(x,$,le,pe){if(x=+x,$=$>>>0,!pe){const ze=Math.pow(2,8*le-1);Ye(this,x,$,le,ze-1,-ze)}let ge=0,we=1,Oe=0;for(this[$]=x&255;++ge<le&&(we*=256);)x<0&&Oe===0&&this[$+ge-1]!==0&&(Oe=1),this[$+ge]=(x/we>>0)-Oe&255;return $+le},T.prototype.writeIntBE=function(x,$,le,pe){if(x=+x,$=$>>>0,!pe){const ze=Math.pow(2,8*le-1);Ye(this,x,$,le,ze-1,-ze)}let ge=le-1,we=1,Oe=0;for(this[$+ge]=x&255;--ge>=0&&(we*=256);)x<0&&Oe===0&&this[$+ge+1]!==0&&(Oe=1),this[$+ge]=(x/we>>0)-Oe&255;return $+le},T.prototype.writeInt8=function(x,$,le){return x=+x,$=$>>>0,le||Ye(this,x,$,1,127,-128),x<0&&(x=255+x+1),this[$]=x&255,$+1},T.prototype.writeInt16LE=function(x,$,le){return x=+x,$=$>>>0,le||Ye(this,x,$,2,32767,-32768),this[$]=x&255,this[$+1]=x>>>8,$+2},T.prototype.writeInt16BE=function(x,$,le){return x=+x,$=$>>>0,le||Ye(this,x,$,2,32767,-32768),this[$]=x>>>8,this[$+1]=x&255,$+2},T.prototype.writeInt32LE=function(x,$,le){return x=+x,$=$>>>0,le||Ye(this,x,$,4,2147483647,-2147483648),this[$]=x&255,this[$+1]=x>>>8,this[$+2]=x>>>16,this[$+3]=x>>>24,$+4},T.prototype.writeInt32BE=function(x,$,le){return x=+x,$=$>>>0,le||Ye(this,x,$,4,2147483647,-2147483648),x<0&&(x=4294967295+x+1),this[$]=x>>>24,this[$+1]=x>>>16,this[$+2]=x>>>8,this[$+3]=x&255,$+4},T.prototype.writeBigInt64LE=it(function(x,$=0){return ft(this,x,$,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),T.prototype.writeBigInt64BE=it(function(x,$=0){return ot(this,x,$,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function st(P,x,$,le,pe,ge){if($+le>P.length)throw new RangeError("Index out of range");if($<0)throw new RangeError("Index out of range")}function ut(P,x,$,le,pe){return x=+x,$=$>>>0,pe||st(P,x,$,4),t.write(P,x,$,le,23,4),$+4}T.prototype.writeFloatLE=function(x,$,le){return ut(this,x,$,!0,le)},T.prototype.writeFloatBE=function(x,$,le){return ut(this,x,$,!1,le)};function Q(P,x,$,le,pe){return x=+x,$=$>>>0,pe||st(P,x,$,8),t.write(P,x,$,le,52,8),$+8}T.prototype.writeDoubleLE=function(x,$,le){return Q(this,x,$,!0,le)},T.prototype.writeDoubleBE=function(x,$,le){return Q(this,x,$,!1,le)},T.prototype.copy=function(x,$,le,pe){if(!T.isBuffer(x))throw new TypeError("argument should be a Buffer");if(le||(le=0),!pe&&pe!==0&&(pe=this.length),$>=x.length&&($=x.length),$||($=0),pe>0&&pe<le&&(pe=le),pe===le||x.length===0||this.length===0)return 0;if($<0)throw new RangeError("targetStart out of bounds");if(le<0||le>=this.length)throw new RangeError("Index out of range");if(pe<0)throw new RangeError("sourceEnd out of bounds");pe>this.length&&(pe=this.length),x.length-$<pe-le&&(pe=x.length-$+le);const ge=pe-le;return this===x&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin($,le,pe):Uint8Array.prototype.set.call(x,this.subarray(le,pe),$),ge},T.prototype.fill=function(x,$,le,pe){if(typeof x=="string"){if(typeof $=="string"?(pe=$,$=0,le=this.length):typeof le=="string"&&(pe=le,le=this.length),pe!==void 0&&typeof pe!="string")throw new TypeError("encoding must be a string");if(typeof pe=="string"&&!T.isEncoding(pe))throw new TypeError("Unknown encoding: "+pe);if(x.length===1){const we=x.charCodeAt(0);(pe==="utf8"&&we<128||pe==="latin1")&&(x=we)}}else typeof x=="number"?x=x&255:typeof x=="boolean"&&(x=Number(x));if($<0||this.length<$||this.length<le)throw new RangeError("Out of range index");if(le<=$)return this;$=$>>>0,le=le===void 0?this.length:le>>>0,x||(x=0);let ge;if(typeof x=="number")for(ge=$;ge<le;++ge)this[ge]=x;else{const we=T.isBuffer(x)?x:T.from(x,pe),Oe=we.length;if(Oe===0)throw new TypeError('The value "'+x+'" is invalid for argument "value"');for(ge=0;ge<le-$;++ge)this[ge+$]=we[ge%Oe]}return this};const j={};function xe(P,x,$){j[P]=class extends ${constructor(){super(),Object.defineProperty(this,"message",{value:x.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${P}]`,this.stack,delete this.name}get code(){return P}set code(pe){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:pe,writable:!0})}toString(){return`${this.name} [${P}]: ${this.message}`}}}xe("ERR_BUFFER_OUT_OF_BOUNDS",function(P){return P?`${P} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),xe("ERR_INVALID_ARG_TYPE",function(P,x){return`The "${P}" argument must be of type number. Received type ${typeof x}`},TypeError),xe("ERR_OUT_OF_RANGE",function(P,x,$){let le=`The value of "${P}" is out of range.`,pe=$;return Number.isInteger($)&&Math.abs($)>2**32?pe=me(String($)):typeof $=="bigint"&&(pe=String($),($>BigInt(2)**BigInt(32)||$<-(BigInt(2)**BigInt(32)))&&(pe=me(pe)),pe+="n"),le+=` It must be ${x}. Received ${pe}`,le},RangeError);function me(P){let x="",$=P.length;const le=P[0]==="-"?1:0;for(;$>=le+4;$-=3)x=`_${P.slice($-3,$)}${x}`;return`${P.slice(0,$)}${x}`}function Fe(P,x,$){Ue(x,"offset"),(P[x]===void 0||P[x+$]===void 0)&&Ge(x,P.length-($+1))}function Ze(P,x,$,le,pe,ge){if(P>$||P<x){const we=typeof x=="bigint"?"n":"";let Oe;throw ge>3?x===0||x===BigInt(0)?Oe=`>= 0${we} and < 2${we} ** ${(ge+1)*8}${we}`:Oe=`>= -(2${we} ** ${(ge+1)*8-1}${we}) and < 2 ** ${(ge+1)*8-1}${we}`:Oe=`>= ${x}${we} and <= ${$}${we}`,new j.ERR_OUT_OF_RANGE("value",Oe,P)}Fe(le,pe,ge)}function Ue(P,x){if(typeof P!="number")throw new j.ERR_INVALID_ARG_TYPE(x,"number",P)}function Ge(P,x,$){throw Math.floor(P)!==P?(Ue(P,$),new j.ERR_OUT_OF_RANGE($||"offset","an integer",P)):x<0?new j.ERR_BUFFER_OUT_OF_BOUNDS:new j.ERR_OUT_OF_RANGE($||"offset",`>= ${$?1:0} and <= ${x}`,P)}const Je=/[^+/0-9A-Za-z-_]/g;function tt(P){if(P=P.split("=")[0],P=P.trim().replace(Je,""),P.length<2)return"";for(;P.length%4!==0;)P=P+"=";return P}function je(P,x){x=x||1/0;let $;const le=P.length;let pe=null;const ge=[];for(let we=0;we<le;++we){if($=P.charCodeAt(we),$>55295&&$<57344){if(!pe){if($>56319){(x-=3)>-1&&ge.push(239,191,189);continue}else if(we+1===le){(x-=3)>-1&&ge.push(239,191,189);continue}pe=$;continue}if($<56320){(x-=3)>-1&&ge.push(239,191,189),pe=$;continue}$=(pe-55296<<10|$-56320)+65536}else pe&&(x-=3)>-1&&ge.push(239,191,189);if(pe=null,$<128){if((x-=1)<0)break;ge.push($)}else if($<2048){if((x-=2)<0)break;ge.push($>>6|192,$&63|128)}else if($<65536){if((x-=3)<0)break;ge.push($>>12|224,$>>6&63|128,$&63|128)}else if($<1114112){if((x-=4)<0)break;ge.push($>>18|240,$>>12&63|128,$>>6&63|128,$&63|128)}else throw new Error("Invalid code point")}return ge}function qe(P){const x=[];for(let $=0;$<P.length;++$)x.push(P.charCodeAt($)&255);return x}function ct(P,x){let $,le,pe;const ge=[];for(let we=0;we<P.length&&!((x-=2)<0);++we)$=P.charCodeAt(we),le=$>>8,pe=$%256,ge.push(pe),ge.push(le);return ge}function lt(P){return r.toByteArray(tt(P))}function rt(P,x,$,le){let pe;for(pe=0;pe<le&&!(pe+$>=x.length||pe>=P.length);++pe)x[pe+$]=P[pe];return pe}function Ke(P,x){return P instanceof x||P!=null&&P.constructor!=null&&P.constructor.name!=null&&P.constructor.name===x.name}function ht(P){return P!==P}const dt=function(){const P="0123456789abcdef",x=new Array(256);for(let $=0;$<16;++$){const le=$*16;for(let pe=0;pe<16;++pe)x[le+pe]=P[$]+P[pe]}return x}();function it(P){return typeof BigInt=="undefined"?_t:P}function _t(){throw new Error("BigInt not supported")}})(buffer$1),globalThis.Buffer=buffer$1.Buffer;var utf8$5={},utils$r={},support$5={},nodestream,blob;if(support$5.base64=!0,support$5.array=!0,support$5.string=!0,support$5.arraybuffer=typeof ArrayBuffer!="undefined"&&typeof Uint8Array!="undefined",support$5.nodebuffer=typeof Buffer!="undefined",support$5.uint8array=typeof Uint8Array!="undefined",typeof ArrayBuffer=="undefined")blob=support$5.blob=!1;else{var buffer=new ArrayBuffer(0);try{blob=support$5.blob=new Blob([buffer],{type:"application/zip"}).size===0}catch(e){try{var Builder=self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder,builder=new Builder;builder.append(buffer),blob=support$5.blob=builder.getBlob("application/zip").size===0}catch(r){blob=support$5.blob=!1}}}try{nodestream=support$5.nodestream=!!require("readable-stream").Readable}catch(e){nodestream=support$5.nodestream=!1}var base64$1={},utils$q=utils$r,support$4=support$5,_keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";base64$1.encode=function(e){for(var r=[],t,v,I,b,N,T,ae,X=0,G=e.length,ve=G,fe=utils$q.getTypeOf(e)!=="string";X<e.length;)ve=G-X,fe?(t=e[X++],v=X<G?e[X++]:0,I=X<G?e[X++]:0):(t=e.charCodeAt(X++),v=X<G?e.charCodeAt(X++):0,I=X<G?e.charCodeAt(X++):0),b=t>>2,N=(t&3)<<4|v>>4,T=ve>1?(v&15)<<2|I>>6:64,ae=ve>2?I&63:64,r.push(_keyStr.charAt(b)+_keyStr.charAt(N)+_keyStr.charAt(T)+_keyStr.charAt(ae));return r.join("")},base64$1.decode=function(e){var r,t,v,I,b,N,T,ae=0,X=0,G="data:";if(e.substr(0,G.length)===G)throw new Error("Invalid base64 input, it looks like a data url.");e=e.replace(/[^A-Za-z0-9+/=]/g,"");var ve=e.length*3/4;if(e.charAt(e.length-1)===_keyStr.charAt(64)&&ve--,e.charAt(e.length-2)===_keyStr.charAt(64)&&ve--,ve%1!==0)throw new Error("Invalid base64 input, bad content length.");var fe;for(support$4.uint8array?fe=new Uint8Array(ve|0):fe=new Array(ve|0);ae<e.length;)I=_keyStr.indexOf(e.charAt(ae++)),b=_keyStr.indexOf(e.charAt(ae++)),N=_keyStr.indexOf(e.charAt(ae++)),T=_keyStr.indexOf(e.charAt(ae++)),r=I<<2|b>>4,t=(b&15)<<4|N>>2,v=(N&3)<<6|T,fe[X++]=r,N!==64&&(fe[X++]=t),T!==64&&(fe[X++]=v);return fe};var nodejsUtils$2={isNode:typeof Buffer!="undefined",newBufferFrom:function(e,r){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(e,r);if(typeof e=="number")throw new Error('The "data" argument must not be a number');return new Buffer(e,r)},allocBuffer:function(e){if(Buffer.alloc)return Buffer.alloc(e);var r=new Buffer(e);return r.fill(0),r},isBuffer:function(e){return Buffer.isBuffer(e)},isStream:function(e){return e&&typeof e.on=="function"&&typeof e.pause=="function"&&typeof e.resume=="function"}},Mutation=commonjsGlobal.MutationObserver||commonjsGlobal.WebKitMutationObserver,scheduleDrain;if(Mutation){var called=0,observer=new Mutation(nextTick),element=commonjsGlobal.document.createTextNode("");observer.observe(element,{characterData:!0}),scheduleDrain=function(){element.data=called=++called%2}}else if(!commonjsGlobal.setImmediate&&typeof commonjsGlobal.MessageChannel!="undefined"){var channel=new commonjsGlobal.MessageChannel;channel.port1.onmessage=nextTick,scheduleDrain=function(){channel.port2.postMessage(0)}}else"document"in commonjsGlobal&&"onreadystatechange"in commonjsGlobal.document.createElement("script")?scheduleDrain=function(){var e=commonjsGlobal.document.createElement("script");e.onreadystatechange=function(){nextTick(),e.onreadystatechange=null,e.parentNode.removeChild(e),e=null},commonjsGlobal.document.documentElement.appendChild(e)}:scheduleDrain=function(){setTimeout(nextTick,0)};var draining,queue=[];function nextTick(){draining=!0;for(var e,r,t=queue.length;t;){for(r=queue,queue=[],e=-1;++e<t;)r[e]();t=queue.length}draining=!1}var lib$2=immediate$1;function immediate$1(e){queue.push(e)===1&&!draining&&scheduleDrain()}var immediate=lib$2;function INTERNAL(){}var handlers={},REJECTED=["REJECTED"],FULFILLED=["FULFILLED"],PENDING=["PENDING"],lib$1=Promise$1;function Promise$1(e){if(typeof e!="function")throw new TypeError("resolver must be a function");this.state=PENDING,this.queue=[],this.outcome=void 0,e!==INTERNAL&&safelyResolveThenable(this,e)}Promise$1.prototype.finally=function(e){if(typeof e!="function")return this;var r=this.constructor;return this.then(t,v);function t(I){function b(){return I}return r.resolve(e()).then(b)}function v(I){function b(){throw I}return r.resolve(e()).then(b)}},Promise$1.prototype.catch=function(e){return this.then(null,e)},Promise$1.prototype.then=function(e,r){if(typeof e!="function"&&this.state===FULFILLED||typeof r!="function"&&this.state===REJECTED)return this;var t=new this.constructor(INTERNAL);if(this.state!==PENDING){var v=this.state===FULFILLED?e:r;unwrap(t,v,this.outcome)}else this.queue.push(new QueueItem(t,e,r));return t};function QueueItem(e,r,t){this.promise=e,typeof r=="function"&&(this.onFulfilled=r,this.callFulfilled=this.otherCallFulfilled),typeof t=="function"&&(this.onRejected=t,this.callRejected=this.otherCallRejected)}QueueItem.prototype.callFulfilled=function(e){handlers.resolve(this.promise,e)},QueueItem.prototype.otherCallFulfilled=function(e){unwrap(this.promise,this.onFulfilled,e)},QueueItem.prototype.callRejected=function(e){handlers.reject(this.promise,e)},QueueItem.prototype.otherCallRejected=function(e){unwrap(this.promise,this.onRejected,e)};function unwrap(e,r,t){immediate(function(){var v;try{v=r(t)}catch(I){return handlers.reject(e,I)}v===e?handlers.reject(e,new TypeError("Cannot resolve promise with itself")):handlers.resolve(e,v)})}handlers.resolve=function(e,r){var t=tryCatch(getThen,r);if(t.status==="error")return handlers.reject(e,t.value);var v=t.value;if(v)safelyResolveThenable(e,v);else{e.state=FULFILLED,e.outcome=r;for(var I=-1,b=e.queue.length;++I<b;)e.queue[I].callFulfilled(r)}return e},handlers.reject=function(e,r){e.state=REJECTED,e.outcome=r;for(var t=-1,v=e.queue.length;++t<v;)e.queue[t].callRejected(r);return e};function getThen(e){var r=e&&e.then;if(e&&(typeof e=="object"||typeof e=="function")&&typeof r=="function")return function(){r.apply(e,arguments)}}function safelyResolveThenable(e,r){var t=!1;function v(T){t||(t=!0,handlers.reject(e,T))}function I(T){t||(t=!0,handlers.resolve(e,T))}function b(){r(I,v)}var N=tryCatch(b);N.status==="error"&&v(N.value)}function tryCatch(e,r){var t={};try{t.value=e(r),t.status="success"}catch(v){t.status="error",t.value=v}return t}Promise$1.resolve=resolve;function resolve(e){return e instanceof this?e:handlers.resolve(new this(INTERNAL),e)}Promise$1.reject=reject;function reject(e){var r=new this(INTERNAL);return handlers.reject(r,e)}Promise$1.all=all;function all(e){var r=this;if(Object.prototype.toString.call(e)!=="[object Array]")return this.reject(new TypeError("must be an array"));var t=e.length,v=!1;if(!t)return this.resolve([]);for(var I=new Array(t),b=0,N=-1,T=new this(INTERNAL);++N<t;)ae(e[N],N);return T;function ae(X,G){r.resolve(X).then(ve,function(fe){v||(v=!0,handlers.reject(T,fe))});function ve(fe){I[G]=fe,++b===t&&!v&&(v=!0,handlers.resolve(T,I))}}}Promise$1.race=race;function race(e){var r=this;if(Object.prototype.toString.call(e)!=="[object Array]")return this.reject(new TypeError("must be an array"));var t=e.length,v=!1;if(!t)return this.resolve([]);for(var I=-1,b=new this(INTERNAL);++I<t;)N(e[I]);return b;function N(T){r.resolve(T).then(function(ae){v||(v=!0,handlers.resolve(b,ae))},function(ae){v||(v=!0,handlers.reject(b,ae))})}}var ES6Promise=null;typeof Promise!="undefined"?ES6Promise=Promise:ES6Promise=lib$1;var external$3={Promise:ES6Promise};(function(e,r){if(e.setImmediate)return;var t=1,v={},I=!1,b=e.document,N;function T(Te){typeof Te!="function"&&(Te=new Function(""+Te));for(var Ae=new Array(arguments.length-1),Se=0;Se<Ae.length;Se++)Ae[Se]=arguments[Se+1];var $e={callback:Te,args:Ae};return v[t]=$e,N(t),t++}function ae(Te){delete v[Te]}function X(Te){var Ae=Te.callback,Se=Te.args;switch(Se.length){case 0:Ae();break;case 1:Ae(Se[0]);break;case 2:Ae(Se[0],Se[1]);break;case 3:Ae(Se[0],Se[1],Se[2]);break;default:Ae.apply(r,Se);break}}function G(Te){if(I)setTimeout(G,0,Te);else{var Ae=v[Te];if(Ae){I=!0;try{X(Ae)}finally{ae(Te),I=!1}}}}function ve(){N=function(Te){setTimeout(function(){G(Te)})}}function fe(){if(e.postMessage&&!e.importScripts){var Te=!0,Ae=e.onmessage;return e.onmessage=function(){Te=!1},e.postMessage("","*"),e.onmessage=Ae,Te}}function ce(){var Te="setImmediate$"+Math.random()+"$",Ae=function(Se){Se.source===e&&typeof Se.data=="string"&&Se.data.indexOf(Te)===0&&G(+Se.data.slice(Te.length))};e.addEventListener?e.addEventListener("message",Ae,!1):e.attachEvent("onmessage",Ae),N=function(Se){e.postMessage(Te+Se,"*")}}function _e(){var Te=new MessageChannel;Te.port1.onmessage=function(Ae){var Se=Ae.data;G(Se)},N=function(Ae){Te.port2.postMessage(Ae)}}function Ee(){var Te=b.documentElement;N=function(Ae){var Se=b.createElement("script");Se.onreadystatechange=function(){G(Ae),Se.onreadystatechange=null,Te.removeChild(Se),Se=null},Te.appendChild(Se)}}function ye(){N=function(Te){setTimeout(G,0,Te)}}var be=Object.getPrototypeOf&&Object.getPrototypeOf(e);be=be&&be.setTimeout?be:e,{}.toString.call(e.undefined)==="[object undefined]"?ve():fe()?ce():e.MessageChannel?_e():b&&"onreadystatechange"in b.createElement("script")?Ee():ye(),be.setImmediate=T,be.clearImmediate=ae})(typeof self=="undefined"?commonjsGlobal:self),function(e){var r=support$5,t=base64$1,v=nodejsUtils$2,I=external$3;function b(fe){var ce=null;return r.uint8array?ce=new Uint8Array(fe.length):ce=new Array(fe.length),T(fe,ce)}e.newBlob=function(fe,ce){e.checkSupport("blob");try{return new Blob([fe],{type:ce})}catch(ye){try{var _e=self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder,Ee=new _e;return Ee.append(fe),Ee.getBlob(ce)}catch(be){throw new Error("Bug : can't construct the Blob.")}}};function N(fe){return fe}function T(fe,ce){for(var _e=0;_e<fe.length;++_e)ce[_e]=fe.charCodeAt(_e)&255;return ce}var ae={stringifyByChunk:function(fe,ce,_e){var Ee=[],ye=0,be=fe.length;if(be<=_e)return String.fromCharCode.apply(null,fe);for(;ye<be;)ce==="array"||ce==="nodebuffer"?Ee.push(String.fromCharCode.apply(null,fe.slice(ye,Math.min(ye+_e,be)))):Ee.push(String.fromCharCode.apply(null,fe.subarray(ye,Math.min(ye+_e,be)))),ye+=_e;return Ee.join("")},stringifyByChar:function(fe){for(var ce="",_e=0;_e<fe.length;_e++)ce+=String.fromCharCode(fe[_e]);return ce},applyCanBeUsed:{uint8array:function(){try{return r.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch(fe){return!1}}(),nodebuffer:function(){try{return r.nodebuffer&&String.fromCharCode.apply(null,v.allocBuffer(1)).length===1}catch(fe){return!1}}()}};function X(fe){var ce=65536,_e=e.getTypeOf(fe),Ee=!0;if(_e==="uint8array"?Ee=ae.applyCanBeUsed.uint8array:_e==="nodebuffer"&&(Ee=ae.applyCanBeUsed.nodebuffer),Ee)for(;ce>1;)try{return ae.stringifyByChunk(fe,_e,ce)}catch(ye){ce=Math.floor(ce/2)}return ae.stringifyByChar(fe)}e.applyFromCharCode=X;function G(fe,ce){for(var _e=0;_e<fe.length;_e++)ce[_e]=fe[_e];return ce}var ve={};ve.string={string:N,array:function(fe){return T(fe,new Array(fe.length))},arraybuffer:function(fe){return ve.string.uint8array(fe).buffer},uint8array:function(fe){return T(fe,new Uint8Array(fe.length))},nodebuffer:function(fe){return T(fe,v.allocBuffer(fe.length))}},ve.array={string:X,array:N,arraybuffer:function(fe){return new Uint8Array(fe).buffer},uint8array:function(fe){return new Uint8Array(fe)},nodebuffer:function(fe){return v.newBufferFrom(fe)}},ve.arraybuffer={string:function(fe){return X(new Uint8Array(fe))},array:function(fe){return G(new Uint8Array(fe),new Array(fe.byteLength))},arraybuffer:N,uint8array:function(fe){return new Uint8Array(fe)},nodebuffer:function(fe){return v.newBufferFrom(new Uint8Array(fe))}},ve.uint8array={string:X,array:function(fe){return G(fe,new Array(fe.length))},arraybuffer:function(fe){return fe.buffer},uint8array:N,nodebuffer:function(fe){return v.newBufferFrom(fe)}},ve.nodebuffer={string:X,array:function(fe){return G(fe,new Array(fe.length))},arraybuffer:function(fe){return ve.nodebuffer.uint8array(fe).buffer},uint8array:function(fe){return G(fe,new Uint8Array(fe.length))},nodebuffer:N},e.transformTo=function(fe,ce){if(ce||(ce=""),!fe)return ce;e.checkSupport(fe);var _e=e.getTypeOf(ce),Ee=ve[_e][fe](ce);return Ee},e.resolve=function(fe){for(var ce=fe.split("/"),_e=[],Ee=0;Ee<ce.length;Ee++){var ye=ce[Ee];ye==="."||ye===""&&Ee!==0&&Ee!==ce.length-1||(ye===".."?_e.pop():_e.push(ye))}return _e.join("/")},e.getTypeOf=function(fe){if(typeof fe=="string")return"string";if(Object.prototype.toString.call(fe)==="[object Array]")return"array";if(r.nodebuffer&&v.isBuffer(fe))return"nodebuffer";if(r.uint8array&&fe instanceof Uint8Array)return"uint8array";if(r.arraybuffer&&fe instanceof ArrayBuffer)return"arraybuffer"},e.checkSupport=function(fe){var ce=r[fe.toLowerCase()];if(!ce)throw new Error(fe+" is not supported by this platform")},e.MAX_VALUE_16BITS=65535,e.MAX_VALUE_32BITS=-1,e.pretty=function(fe){var ce="",_e,Ee;for(Ee=0;Ee<(fe||"").length;Ee++)_e=fe.charCodeAt(Ee),ce+="\\x"+(_e<16?"0":"")+_e.toString(16).toUpperCase();return ce},e.delay=function(fe,ce,_e){setImmediate(function(){fe.apply(_e||null,ce||[])})},e.inherits=function(fe,ce){var _e=function(){};_e.prototype=ce.prototype,fe.prototype=new _e},e.extend=function(){var fe={},ce,_e;for(ce=0;ce<arguments.length;ce++)for(_e in arguments[ce])Object.prototype.hasOwnProperty.call(arguments[ce],_e)&&typeof fe[_e]=="undefined"&&(fe[_e]=arguments[ce][_e]);return fe},e.prepareContent=function(fe,ce,_e,Ee,ye){var be=I.Promise.resolve(ce).then(function(Te){var Ae=r.blob&&(Te instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(Te))!==-1);return Ae&&typeof FileReader!="undefined"?new I.Promise(function(Se,$e){var ke=new FileReader;ke.onload=function(Ne){Se(Ne.target.result)},ke.onerror=function(Ne){$e(Ne.target.error)},ke.readAsArrayBuffer(Te)}):Te});return be.then(function(Te){var Ae=e.getTypeOf(Te);return Ae?(Ae==="arraybuffer"?Te=e.transformTo("uint8array",Te):Ae==="string"&&(ye?Te=t.decode(Te):_e&&Ee!==!0&&(Te=b(Te))),Te):I.Promise.reject(new Error("Can't read the data of '"+fe+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}}(utils$r);function GenericWorker$b(e){this.name=e||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}GenericWorker$b.prototype={push:function(e){this.emit("data",e)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(e){this.emit("error",e)}return!0},error:function(e){return this.isFinished?!1:(this.isPaused?this.generatedError=e:(this.isFinished=!0,this.emit("error",e),this.previous&&this.previous.error(e),this.cleanUp()),!0)},on:function(e,r){return this._listeners[e].push(r),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(e,r){if(this._listeners[e])for(var t=0;t<this._listeners[e].length;t++)this._listeners[e][t].call(this,r)},pipe:function(e){return e.registerPrevious(this)},registerPrevious:function(e){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=e.streamInfo,this.mergeStreamInfo(),this.previous=e;var r=this;return e.on("data",function(t){r.processChunk(t)}),e.on("end",function(){r.end()}),e.on("error",function(t){r.error(t)}),this},pause:function(){return this.isPaused||this.isFinished?!1:(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;this.isPaused=!1;var e=!1;return this.generatedError&&(this.error(this.generatedError),e=!0),this.previous&&this.previous.resume(),!e},flush:function(){},processChunk:function(e){this.push(e)},withStreamInfo:function(e,r){return this.extraStreamInfo[e]=r,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var e in this.extraStreamInfo)!Object.prototype.hasOwnProperty.call(this.extraStreamInfo,e)||(this.streamInfo[e]=this.extraStreamInfo[e])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var e="Worker "+this.name;return this.previous?this.previous+" -> "+e:e}};var GenericWorker_1=GenericWorker$b;(function(e){for(var r=utils$r,t=support$5,v=nodejsUtils$2,I=GenericWorker_1,b=new Array(256),N=0;N<256;N++)b[N]=N>=252?6:N>=248?5:N>=240?4:N>=224?3:N>=192?2:1;b[254]=b[254]=1;var T=function(fe){var ce,_e,Ee,ye,be,Te=fe.length,Ae=0;for(ye=0;ye<Te;ye++)_e=fe.charCodeAt(ye),(_e&64512)===55296&&ye+1<Te&&(Ee=fe.charCodeAt(ye+1),(Ee&64512)===56320&&(_e=65536+(_e-55296<<10)+(Ee-56320),ye++)),Ae+=_e<128?1:_e<2048?2:_e<65536?3:4;for(t.uint8array?ce=new Uint8Array(Ae):ce=new Array(Ae),be=0,ye=0;be<Ae;ye++)_e=fe.charCodeAt(ye),(_e&64512)===55296&&ye+1<Te&&(Ee=fe.charCodeAt(ye+1),(Ee&64512)===56320&&(_e=65536+(_e-55296<<10)+(Ee-56320),ye++)),_e<128?ce[be++]=_e:_e<2048?(ce[be++]=192|_e>>>6,ce[be++]=128|_e&63):_e<65536?(ce[be++]=224|_e>>>12,ce[be++]=128|_e>>>6&63,ce[be++]=128|_e&63):(ce[be++]=240|_e>>>18,ce[be++]=128|_e>>>12&63,ce[be++]=128|_e>>>6&63,ce[be++]=128|_e&63);return ce},ae=function(fe,ce){var _e;for(ce=ce||fe.length,ce>fe.length&&(ce=fe.length),_e=ce-1;_e>=0&&(fe[_e]&192)===128;)_e--;return _e<0||_e===0?ce:_e+b[fe[_e]]>ce?_e:ce},X=function(fe){var ce,_e,Ee,ye,be=fe.length,Te=new Array(be*2);for(_e=0,ce=0;ce<be;){if(Ee=fe[ce++],Ee<128){Te[_e++]=Ee;continue}if(ye=b[Ee],ye>4){Te[_e++]=65533,ce+=ye-1;continue}for(Ee&=ye===2?31:ye===3?15:7;ye>1&&ce<be;)Ee=Ee<<6|fe[ce++]&63,ye--;if(ye>1){Te[_e++]=65533;continue}Ee<65536?Te[_e++]=Ee:(Ee-=65536,Te[_e++]=55296|Ee>>10&1023,Te[_e++]=56320|Ee&1023)}return Te.length!==_e&&(Te.subarray?Te=Te.subarray(0,_e):Te.length=_e),r.applyFromCharCode(Te)};e.utf8encode=function(ce){return t.nodebuffer?v.newBufferFrom(ce,"utf-8"):T(ce)},e.utf8decode=function(ce){return t.nodebuffer?r.transformTo("nodebuffer",ce).toString("utf-8"):(ce=r.transformTo(t.uint8array?"uint8array":"array",ce),X(ce))};function G(){I.call(this,"utf-8 decode"),this.leftOver=null}r.inherits(G,I),G.prototype.processChunk=function(fe){var ce=r.transformTo(t.uint8array?"uint8array":"array",fe.data);if(this.leftOver&&this.leftOver.length){if(t.uint8array){var _e=ce;ce=new Uint8Array(_e.length+this.leftOver.length),ce.set(this.leftOver,0),ce.set(_e,this.leftOver.length)}else ce=this.leftOver.concat(ce);this.leftOver=null}var Ee=ae(ce),ye=ce;Ee!==ce.length&&(t.uint8array?(ye=ce.subarray(0,Ee),this.leftOver=ce.subarray(Ee,ce.length)):(ye=ce.slice(0,Ee),this.leftOver=ce.slice(Ee,ce.length))),this.push({data:e.utf8decode(ye),meta:fe.meta})},G.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:e.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},e.Utf8DecodeWorker=G;function ve(){I.call(this,"utf-8 encode")}r.inherits(ve,I),ve.prototype.processChunk=function(fe){this.push({data:e.utf8encode(fe.data),meta:fe.meta})},e.Utf8EncodeWorker=ve})(utf8$5);var GenericWorker$a=GenericWorker_1,utils$p=utils$r;function ConvertWorker$1(e){GenericWorker$a.call(this,"ConvertWorker to "+e),this.destType=e}utils$p.inherits(ConvertWorker$1,GenericWorker$a),ConvertWorker$1.prototype.processChunk=function(e){this.push({data:utils$p.transformTo(this.destType,e.data),meta:e.meta})};var ConvertWorker_1=ConvertWorker$1,utils$o=utils$r,ConvertWorker=ConvertWorker_1,GenericWorker$9=GenericWorker_1,base64=base64$1,support$3=support$5,external$2=external$3,NodejsStreamOutputAdapter=null;if(support$3.nodestream)try{NodejsStreamOutputAdapter=require("../nodejs/NodejsStreamOutputAdapter")}catch(e){}function transformZipOutput(e,r,t){switch(e){case"blob":return utils$o.newBlob(utils$o.transformTo("arraybuffer",r),t);case"base64":return base64.encode(r);default:return utils$o.transformTo(e,r)}}function concat(e,r){var t,v=0,I=null,b=0;for(t=0;t<r.length;t++)b+=r[t].length;switch(e){case"string":return r.join("");case"array":return Array.prototype.concat.apply([],r);case"uint8array":for(I=new Uint8Array(b),t=0;t<r.length;t++)I.set(r[t],v),v+=r[t].length;return I;case"nodebuffer":return Buffer.concat(r);default:throw new Error("concat : unsupported type '"+e+"'")}}function accumulate(e,r){return new external$2.Promise(function(t,v){var I=[],b=e._internalType,N=e._outputType,T=e._mimeType;e.on("data",function(ae,X){I.push(ae),r&&r(X)}).on("error",function(ae){I=[],v(ae)}).on("end",function(){try{var ae=transformZipOutput(N,concat(b,I),T);t(ae)}catch(X){v(X)}I=[]}).resume()})}function StreamHelper$2(e,r,t){var v=r;switch(r){case"blob":case"arraybuffer":v="uint8array";break;case"base64":v="string";break}try{this._internalType=v,this._outputType=r,this._mimeType=t,utils$o.checkSupport(v),this._worker=e.pipe(new ConvertWorker(v)),e.lock()}catch(I){this._worker=new GenericWorker$9("error"),this._worker.error(I)}}StreamHelper$2.prototype={accumulate:function(e){return accumulate(this,e)},on:function(e,r){var t=this;return e==="data"?this._worker.on(e,function(v){r.call(t,v.data,v.meta)}):this._worker.on(e,function(){utils$o.delay(r,arguments,t)}),this},resume:function(){return utils$o.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(e){if(utils$o.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new NodejsStreamOutputAdapter(this,{objectMode:this._outputType!=="nodebuffer"},e)}};var StreamHelper_1=StreamHelper$2,defaults$1={};defaults$1.base64=!1,defaults$1.binary=!1,defaults$1.dir=!1,defaults$1.createFolders=!0,defaults$1.date=null,defaults$1.compression=null,defaults$1.compressionOptions=null,defaults$1.comment=null,defaults$1.unixPermissions=null,defaults$1.dosPermissions=null;var utils$n=utils$r,GenericWorker$8=GenericWorker_1,DEFAULT_BLOCK_SIZE=16*1024;function DataWorker$2(e){GenericWorker$8.call(this,"DataWorker");var r=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,e.then(function(t){r.dataIsReady=!0,r.data=t,r.max=t&&t.length||0,r.type=utils$n.getTypeOf(t),r.isPaused||r._tickAndRepeat()},function(t){r.error(t)})}utils$n.inherits(DataWorker$2,GenericWorker$8),DataWorker$2.prototype.cleanUp=function(){GenericWorker$8.prototype.cleanUp.call(this),this.data=null},DataWorker$2.prototype.resume=function(){return GenericWorker$8.prototype.resume.call(this)?(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,utils$n.delay(this._tickAndRepeat,[],this)),!0):!1},DataWorker$2.prototype._tickAndRepeat=function(){this._tickScheduled=!1,!(this.isPaused||this.isFinished)&&(this._tick(),this.isFinished||(utils$n.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},DataWorker$2.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var e=DEFAULT_BLOCK_SIZE,r=null,t=Math.min(this.max,this.index+e);if(this.index>=this.max)return this.end();switch(this.type){case"string":r=this.data.substring(this.index,t);break;case"uint8array":r=this.data.subarray(this.index,t);break;case"array":case"nodebuffer":r=this.data.slice(this.index,t);break}return this.index=t,this.push({data:r,meta:{percent:this.max?this.index/this.max*100:0}})};var DataWorker_1=DataWorker$2,utils$m=utils$r;function makeTable$1(){for(var e,r=[],t=0;t<256;t++){e=t;for(var v=0;v<8;v++)e=e&1?3988292384^e>>>1:e>>>1;r[t]=e}return r}var crcTable$1=makeTable$1();function crc32$5(e,r,t,v){var I=crcTable$1,b=v+t;e=e^-1;for(var N=v;N<b;N++)e=e>>>8^I[(e^r[N])&255];return e^-1}function crc32str(e,r,t,v){var I=crcTable$1,b=v+t;e=e^-1;for(var N=v;N<b;N++)e=e>>>8^I[(e^r.charCodeAt(N))&255];return e^-1}var crc32_1$1=function(r,t){if(typeof r=="undefined"||!r.length)return 0;var v=utils$m.getTypeOf(r)!=="string";return v?crc32$5(t|0,r,r.length,0):crc32str(t|0,r,r.length,0)},GenericWorker$7=GenericWorker_1,crc32$4=crc32_1$1,utils$l=utils$r;function Crc32Probe$2(){GenericWorker$7.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}utils$l.inherits(Crc32Probe$2,GenericWorker$7),Crc32Probe$2.prototype.processChunk=function(e){this.streamInfo.crc32=crc32$4(e.data,this.streamInfo.crc32||0),this.push(e)};var Crc32Probe_1=Crc32Probe$2,utils$k=utils$r,GenericWorker$6=GenericWorker_1;function DataLengthProbe$1(e){GenericWorker$6.call(this,"DataLengthProbe for "+e),this.propName=e,this.withStreamInfo(e,0)}utils$k.inherits(DataLengthProbe$1,GenericWorker$6),DataLengthProbe$1.prototype.processChunk=function(e){if(e){var r=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=r+e.data.length}GenericWorker$6.prototype.processChunk.call(this,e)};var DataLengthProbe_1=DataLengthProbe$1,external$1=external$3,DataWorker$1=DataWorker_1,Crc32Probe$1=Crc32Probe_1,DataLengthProbe=DataLengthProbe_1;function CompressedObject$3(e,r,t,v,I){this.compressedSize=e,this.uncompressedSize=r,this.crc32=t,this.compression=v,this.compressedContent=I}CompressedObject$3.prototype={getContentWorker:function(){var e=new DataWorker$1(external$1.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new DataLengthProbe("data_length")),r=this;return e.on("end",function(){if(this.streamInfo.data_length!==r.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),e},getCompressedWorker:function(){return new DataWorker$1(external$1.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},CompressedObject$3.createWorkerFrom=function(e,r,t){return e.pipe(new Crc32Probe$1).pipe(new DataLengthProbe("uncompressedSize")).pipe(r.compressWorker(t)).pipe(new DataLengthProbe("compressedSize")).withStreamInfo("compression",r)};var compressedObject=CompressedObject$3,StreamHelper$1=StreamHelper_1,DataWorker=DataWorker_1,utf8$4=utf8$5,CompressedObject$2=compressedObject,GenericWorker$5=GenericWorker_1,ZipObject$1=function(e,r,t){this.name=e,this.dir=t.dir,this.date=t.date,this.comment=t.comment,this.unixPermissions=t.unixPermissions,this.dosPermissions=t.dosPermissions,this._data=r,this._dataBinary=t.binary,this.options={compression:t.compression,compressionOptions:t.compressionOptions}};ZipObject$1.prototype={internalStream:function(e){var r=null,t="string";try{if(!e)throw new Error("No output type specified.");t=e.toLowerCase();var v=t==="string"||t==="text";(t==="binarystring"||t==="text")&&(t="string"),r=this._decompressWorker();var I=!this._dataBinary;I&&!v&&(r=r.pipe(new utf8$4.Utf8EncodeWorker)),!I&&v&&(r=r.pipe(new utf8$4.Utf8DecodeWorker))}catch(b){r=new GenericWorker$5("error"),r.error(b)}return new StreamHelper$1(r,t,"")},async:function(e,r){return this.internalStream(e).accumulate(r)},nodeStream:function(e,r){return this.internalStream(e||"nodebuffer").toNodejsStream(r)},_compressWorker:function(e,r){if(this._data instanceof CompressedObject$2&&this._data.compression.magic===e.magic)return this._data.getCompressedWorker();var t=this._decompressWorker();return this._dataBinary||(t=t.pipe(new utf8$4.Utf8EncodeWorker)),CompressedObject$2.createWorkerFrom(t,e,r)},_decompressWorker:function(){return this._data instanceof CompressedObject$2?this._data.getContentWorker():this._data instanceof GenericWorker$5?this._data:new DataWorker(this._data)}};for(var removedMethods=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],removedFn=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},i$1=0;i$1<removedMethods.length;i$1++)ZipObject$1.prototype[removedMethods[i$1]]=removedFn;var zipObject=ZipObject$1,generate$1={},compressions$2={},flate={},common={};(function(e){var r=typeof Uint8Array!="undefined"&&typeof Uint16Array!="undefined"&&typeof Int32Array!="undefined";function t(b,N){return Object.prototype.hasOwnProperty.call(b,N)}e.assign=function(b){for(var N=Array.prototype.slice.call(arguments,1);N.length;){var T=N.shift();if(!!T){if(typeof T!="object")throw new TypeError(T+"must be non-object");for(var ae in T)t(T,ae)&&(b[ae]=T[ae])}}return b},e.shrinkBuf=function(b,N){return b.length===N?b:b.subarray?b.subarray(0,N):(b.length=N,b)};var v={arraySet:function(b,N,T,ae,X){if(N.subarray&&b.subarray){b.set(N.subarray(T,T+ae),X);return}for(var G=0;G<ae;G++)b[X+G]=N[T+G]},flattenChunks:function(b){var N,T,ae,X,G,ve;for(ae=0,N=0,T=b.length;N<T;N++)ae+=b[N].length;for(ve=new Uint8Array(ae),X=0,N=0,T=b.length;N<T;N++)G=b[N],ve.set(G,X),X+=G.length;return ve}},I={arraySet:function(b,N,T,ae,X){for(var G=0;G<ae;G++)b[X+G]=N[T+G]},flattenChunks:function(b){return[].concat.apply([],b)}};e.setTyped=function(b){b?(e.Buf8=Uint8Array,e.Buf16=Uint16Array,e.Buf32=Int32Array,e.assign(e,v)):(e.Buf8=Array,e.Buf16=Array,e.Buf32=Array,e.assign(e,I))},e.setTyped(r)})(common);var deflate$4={},deflate$3={},trees$1={},utils$j=common,Z_FIXED$1=4,Z_BINARY=0,Z_TEXT=1,Z_UNKNOWN$1=2;function zero$1(e){for(var r=e.length;--r>=0;)e[r]=0}var STORED_BLOCK=0,STATIC_TREES=1,DYN_TREES=2,MIN_MATCH$1=3,MAX_MATCH$1=258,LENGTH_CODES$1=29,LITERALS$1=256,L_CODES$1=LITERALS$1+1+LENGTH_CODES$1,D_CODES$1=30,BL_CODES$1=19,HEAP_SIZE$1=2*L_CODES$1+1,MAX_BITS$1=15,Buf_size=16,MAX_BL_BITS=7,END_BLOCK=256,REP_3_6=16,REPZ_3_10=17,REPZ_11_138=18,extra_lbits=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],extra_dbits=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],extra_blbits=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],bl_order=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],DIST_CODE_LEN=512,static_ltree=new Array((L_CODES$1+2)*2);zero$1(static_ltree);var static_dtree=new Array(D_CODES$1*2);zero$1(static_dtree);var _dist_code=new Array(DIST_CODE_LEN);zero$1(_dist_code);var _length_code=new Array(MAX_MATCH$1-MIN_MATCH$1+1);zero$1(_length_code);var base_length=new Array(LENGTH_CODES$1);zero$1(base_length);var base_dist=new Array(D_CODES$1);zero$1(base_dist);function StaticTreeDesc(e,r,t,v,I){this.static_tree=e,this.extra_bits=r,this.extra_base=t,this.elems=v,this.max_length=I,this.has_stree=e&&e.length}var static_l_desc,static_d_desc,static_bl_desc;function TreeDesc(e,r){this.dyn_tree=e,this.max_code=0,this.stat_desc=r}function d_code(e){return e<256?_dist_code[e]:_dist_code[256+(e>>>7)]}function put_short(e,r){e.pending_buf[e.pending++]=r&255,e.pending_buf[e.pending++]=r>>>8&255}function send_bits(e,r,t){e.bi_valid>Buf_size-t?(e.bi_buf|=r<<e.bi_valid&65535,put_short(e,e.bi_buf),e.bi_buf=r>>Buf_size-e.bi_valid,e.bi_valid+=t-Buf_size):(e.bi_buf|=r<<e.bi_valid&65535,e.bi_valid+=t)}function send_code(e,r,t){send_bits(e,t[r*2],t[r*2+1])}function bi_reverse(e,r){var t=0;do t|=e&1,e>>>=1,t<<=1;while(--r>0);return t>>>1}function bi_flush(e){e.bi_valid===16?(put_short(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=e.bi_buf&255,e.bi_buf>>=8,e.bi_valid-=8)}function gen_bitlen(e,r){var t=r.dyn_tree,v=r.max_code,I=r.stat_desc.static_tree,b=r.stat_desc.has_stree,N=r.stat_desc.extra_bits,T=r.stat_desc.extra_base,ae=r.stat_desc.max_length,X,G,ve,fe,ce,_e,Ee=0;for(fe=0;fe<=MAX_BITS$1;fe++)e.bl_count[fe]=0;for(t[e.heap[e.heap_max]*2+1]=0,X=e.heap_max+1;X<HEAP_SIZE$1;X++)G=e.heap[X],fe=t[t[G*2+1]*2+1]+1,fe>ae&&(fe=ae,Ee++),t[G*2+1]=fe,!(G>v)&&(e.bl_count[fe]++,ce=0,G>=T&&(ce=N[G-T]),_e=t[G*2],e.opt_len+=_e*(fe+ce),b&&(e.static_len+=_e*(I[G*2+1]+ce)));if(Ee!==0){do{for(fe=ae-1;e.bl_count[fe]===0;)fe--;e.bl_count[fe]--,e.bl_count[fe+1]+=2,e.bl_count[ae]--,Ee-=2}while(Ee>0);for(fe=ae;fe!==0;fe--)for(G=e.bl_count[fe];G!==0;)ve=e.heap[--X],!(ve>v)&&(t[ve*2+1]!==fe&&(e.opt_len+=(fe-t[ve*2+1])*t[ve*2],t[ve*2+1]=fe),G--)}}function gen_codes(e,r,t){var v=new Array(MAX_BITS$1+1),I=0,b,N;for(b=1;b<=MAX_BITS$1;b++)v[b]=I=I+t[b-1]<<1;for(N=0;N<=r;N++){var T=e[N*2+1];T!==0&&(e[N*2]=bi_reverse(v[T]++,T))}}function tr_static_init(){var e,r,t,v,I,b=new Array(MAX_BITS$1+1);for(t=0,v=0;v<LENGTH_CODES$1-1;v++)for(base_length[v]=t,e=0;e<1<<extra_lbits[v];e++)_length_code[t++]=v;for(_length_code[t-1]=v,I=0,v=0;v<16;v++)for(base_dist[v]=I,e=0;e<1<<extra_dbits[v];e++)_dist_code[I++]=v;for(I>>=7;v<D_CODES$1;v++)for(base_dist[v]=I<<7,e=0;e<1<<extra_dbits[v]-7;e++)_dist_code[256+I++]=v;for(r=0;r<=MAX_BITS$1;r++)b[r]=0;for(e=0;e<=143;)static_ltree[e*2+1]=8,e++,b[8]++;for(;e<=255;)static_ltree[e*2+1]=9,e++,b[9]++;for(;e<=279;)static_ltree[e*2+1]=7,e++,b[7]++;for(;e<=287;)static_ltree[e*2+1]=8,e++,b[8]++;for(gen_codes(static_ltree,L_CODES$1+1,b),e=0;e<D_CODES$1;e++)static_dtree[e*2+1]=5,static_dtree[e*2]=bi_reverse(e,5);static_l_desc=new StaticTreeDesc(static_ltree,extra_lbits,LITERALS$1+1,L_CODES$1,MAX_BITS$1),static_d_desc=new StaticTreeDesc(static_dtree,extra_dbits,0,D_CODES$1,MAX_BITS$1),static_bl_desc=new StaticTreeDesc(new Array(0),extra_blbits,0,BL_CODES$1,MAX_BL_BITS)}function init_block(e){var r;for(r=0;r<L_CODES$1;r++)e.dyn_ltree[r*2]=0;for(r=0;r<D_CODES$1;r++)e.dyn_dtree[r*2]=0;for(r=0;r<BL_CODES$1;r++)e.bl_tree[r*2]=0;e.dyn_ltree[END_BLOCK*2]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function bi_windup(e){e.bi_valid>8?put_short(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function copy_block(e,r,t,v){bi_windup(e),v&&(put_short(e,t),put_short(e,~t)),utils$j.arraySet(e.pending_buf,e.window,r,t,e.pending),e.pending+=t}function smaller(e,r,t,v){var I=r*2,b=t*2;return e[I]<e[b]||e[I]===e[b]&&v[r]<=v[t]}function pqdownheap(e,r,t){for(var v=e.heap[t],I=t<<1;I<=e.heap_len&&(I<e.heap_len&&smaller(r,e.heap[I+1],e.heap[I],e.depth)&&I++,!smaller(r,v,e.heap[I],e.depth));)e.heap[t]=e.heap[I],t=I,I<<=1;e.heap[t]=v}function compress_block(e,r,t){var v,I,b=0,N,T;if(e.last_lit!==0)do v=e.pending_buf[e.d_buf+b*2]<<8|e.pending_buf[e.d_buf+b*2+1],I=e.pending_buf[e.l_buf+b],b++,v===0?send_code(e,I,r):(N=_length_code[I],send_code(e,N+LITERALS$1+1,r),T=extra_lbits[N],T!==0&&(I-=base_length[N],send_bits(e,I,T)),v--,N=d_code(v),send_code(e,N,t),T=extra_dbits[N],T!==0&&(v-=base_dist[N],send_bits(e,v,T)));while(b<e.last_lit);send_code(e,END_BLOCK,r)}function build_tree(e,r){var t=r.dyn_tree,v=r.stat_desc.static_tree,I=r.stat_desc.has_stree,b=r.stat_desc.elems,N,T,ae=-1,X;for(e.heap_len=0,e.heap_max=HEAP_SIZE$1,N=0;N<b;N++)t[N*2]!==0?(e.heap[++e.heap_len]=ae=N,e.depth[N]=0):t[N*2+1]=0;for(;e.heap_len<2;)X=e.heap[++e.heap_len]=ae<2?++ae:0,t[X*2]=1,e.depth[X]=0,e.opt_len--,I&&(e.static_len-=v[X*2+1]);for(r.max_code=ae,N=e.heap_len>>1;N>=1;N--)pqdownheap(e,t,N);X=b;do N=e.heap[1],e.heap[1]=e.heap[e.heap_len--],pqdownheap(e,t,1),T=e.heap[1],e.heap[--e.heap_max]=N,e.heap[--e.heap_max]=T,t[X*2]=t[N*2]+t[T*2],e.depth[X]=(e.depth[N]>=e.depth[T]?e.depth[N]:e.depth[T])+1,t[N*2+1]=t[T*2+1]=X,e.heap[1]=X++,pqdownheap(e,t,1);while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],gen_bitlen(e,r),gen_codes(t,ae,e.bl_count)}function scan_tree(e,r,t){var v,I=-1,b,N=r[0*2+1],T=0,ae=7,X=4;for(N===0&&(ae=138,X=3),r[(t+1)*2+1]=65535,v=0;v<=t;v++)b=N,N=r[(v+1)*2+1],!(++T<ae&&b===N)&&(T<X?e.bl_tree[b*2]+=T:b!==0?(b!==I&&e.bl_tree[b*2]++,e.bl_tree[REP_3_6*2]++):T<=10?e.bl_tree[REPZ_3_10*2]++:e.bl_tree[REPZ_11_138*2]++,T=0,I=b,N===0?(ae=138,X=3):b===N?(ae=6,X=3):(ae=7,X=4))}function send_tree(e,r,t){var v,I=-1,b,N=r[0*2+1],T=0,ae=7,X=4;for(N===0&&(ae=138,X=3),v=0;v<=t;v++)if(b=N,N=r[(v+1)*2+1],!(++T<ae&&b===N)){if(T<X)do send_code(e,b,e.bl_tree);while(--T!==0);else b!==0?(b!==I&&(send_code(e,b,e.bl_tree),T--),send_code(e,REP_3_6,e.bl_tree),send_bits(e,T-3,2)):T<=10?(send_code(e,REPZ_3_10,e.bl_tree),send_bits(e,T-3,3)):(send_code(e,REPZ_11_138,e.bl_tree),send_bits(e,T-11,7));T=0,I=b,N===0?(ae=138,X=3):b===N?(ae=6,X=3):(ae=7,X=4)}}function build_bl_tree(e){var r;for(scan_tree(e,e.dyn_ltree,e.l_desc.max_code),scan_tree(e,e.dyn_dtree,e.d_desc.max_code),build_tree(e,e.bl_desc),r=BL_CODES$1-1;r>=3&&e.bl_tree[bl_order[r]*2+1]===0;r--);return e.opt_len+=3*(r+1)+5+5+4,r}function send_all_trees(e,r,t,v){var I;for(send_bits(e,r-257,5),send_bits(e,t-1,5),send_bits(e,v-4,4),I=0;I<v;I++)send_bits(e,e.bl_tree[bl_order[I]*2+1],3);send_tree(e,e.dyn_ltree,r-1),send_tree(e,e.dyn_dtree,t-1)}function detect_data_type(e){var r=4093624447,t;for(t=0;t<=31;t++,r>>>=1)if(r&1&&e.dyn_ltree[t*2]!==0)return Z_BINARY;if(e.dyn_ltree[9*2]!==0||e.dyn_ltree[10*2]!==0||e.dyn_ltree[13*2]!==0)return Z_TEXT;for(t=32;t<LITERALS$1;t++)if(e.dyn_ltree[t*2]!==0)return Z_TEXT;return Z_BINARY}var static_init_done=!1;function _tr_init(e){static_init_done||(tr_static_init(),static_init_done=!0),e.l_desc=new TreeDesc(e.dyn_ltree,static_l_desc),e.d_desc=new TreeDesc(e.dyn_dtree,static_d_desc),e.bl_desc=new TreeDesc(e.bl_tree,static_bl_desc),e.bi_buf=0,e.bi_valid=0,init_block(e)}function _tr_stored_block(e,r,t,v){send_bits(e,(STORED_BLOCK<<1)+(v?1:0),3),copy_block(e,r,t,!0)}function _tr_align(e){send_bits(e,STATIC_TREES<<1,3),send_code(e,END_BLOCK,static_ltree),bi_flush(e)}function _tr_flush_block(e,r,t,v){var I,b,N=0;e.level>0?(e.strm.data_type===Z_UNKNOWN$1&&(e.strm.data_type=detect_data_type(e)),build_tree(e,e.l_desc),build_tree(e,e.d_desc),N=build_bl_tree(e),I=e.opt_len+3+7>>>3,b=e.static_len+3+7>>>3,b<=I&&(I=b)):I=b=t+5,t+4<=I&&r!==-1?_tr_stored_block(e,r,t,v):e.strategy===Z_FIXED$1||b===I?(send_bits(e,(STATIC_TREES<<1)+(v?1:0),3),compress_block(e,static_ltree,static_dtree)):(send_bits(e,(DYN_TREES<<1)+(v?1:0),3),send_all_trees(e,e.l_desc.max_code+1,e.d_desc.max_code+1,N+1),compress_block(e,e.dyn_ltree,e.dyn_dtree)),init_block(e),v&&bi_windup(e)}function _tr_tally(e,r,t){return e.pending_buf[e.d_buf+e.last_lit*2]=r>>>8&255,e.pending_buf[e.d_buf+e.last_lit*2+1]=r&255,e.pending_buf[e.l_buf+e.last_lit]=t&255,e.last_lit++,r===0?e.dyn_ltree[t*2]++:(e.matches++,r--,e.dyn_ltree[(_length_code[t]+LITERALS$1+1)*2]++,e.dyn_dtree[d_code(r)*2]++),e.last_lit===e.lit_bufsize-1}trees$1._tr_init=_tr_init,trees$1._tr_stored_block=_tr_stored_block,trees$1._tr_flush_block=_tr_flush_block,trees$1._tr_tally=_tr_tally,trees$1._tr_align=_tr_align;function adler32$2(e,r,t,v){for(var I=e&65535|0,b=e>>>16&65535|0,N=0;t!==0;){N=t>2e3?2e3:t,t-=N;do I=I+r[v++]|0,b=b+I|0;while(--N);I%=65521,b%=65521}return I|b<<16|0}var adler32_1=adler32$2;function makeTable(){for(var e,r=[],t=0;t<256;t++){e=t;for(var v=0;v<8;v++)e=e&1?3988292384^e>>>1:e>>>1;r[t]=e}return r}var crcTable=makeTable();function crc32$3(e,r,t,v){var I=crcTable,b=v+t;e^=-1;for(var N=v;N<b;N++)e=e>>>8^I[(e^r[N])&255];return e^-1}var crc32_1=crc32$3,messages={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},utils$i=common,trees=trees$1,adler32$1=adler32_1,crc32$2=crc32_1,msg$2=messages,Z_NO_FLUSH$1=0,Z_PARTIAL_FLUSH=1,Z_FULL_FLUSH=3,Z_FINISH$2=4,Z_BLOCK$1=5,Z_OK$2=0,Z_STREAM_END$2=1,Z_STREAM_ERROR$1=-2,Z_DATA_ERROR$1=-3,Z_BUF_ERROR$1=-5,Z_DEFAULT_COMPRESSION$1=-1,Z_FILTERED=1,Z_HUFFMAN_ONLY=2,Z_RLE=3,Z_FIXED=4,Z_DEFAULT_STRATEGY$1=0,Z_UNKNOWN=2,Z_DEFLATED$2=8,MAX_MEM_LEVEL=9,MAX_WBITS$1=15,DEF_MEM_LEVEL=8,LENGTH_CODES=29,LITERALS=256,L_CODES=LITERALS+1+LENGTH_CODES,D_CODES=30,BL_CODES=19,HEAP_SIZE=2*L_CODES+1,MAX_BITS=15,MIN_MATCH=3,MAX_MATCH=258,MIN_LOOKAHEAD=MAX_MATCH+MIN_MATCH+1,PRESET_DICT=32,INIT_STATE=42,EXTRA_STATE=69,NAME_STATE=73,COMMENT_STATE=91,HCRC_STATE=103,BUSY_STATE=113,FINISH_STATE=666,BS_NEED_MORE=1,BS_BLOCK_DONE=2,BS_FINISH_STARTED=3,BS_FINISH_DONE=4,OS_CODE=3;function err(e,r){return e.msg=msg$2[r],r}function rank(e){return(e<<1)-(e>4?9:0)}function zero(e){for(var r=e.length;--r>=0;)e[r]=0}function flush_pending(e){var r=e.state,t=r.pending;t>e.avail_out&&(t=e.avail_out),t!==0&&(utils$i.arraySet(e.output,r.pending_buf,r.pending_out,t,e.next_out),e.next_out+=t,r.pending_out+=t,e.total_out+=t,e.avail_out-=t,r.pending-=t,r.pending===0&&(r.pending_out=0))}function flush_block_only(e,r){trees._tr_flush_block(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,r),e.block_start=e.strstart,flush_pending(e.strm)}function put_byte(e,r){e.pending_buf[e.pending++]=r}function putShortMSB(e,r){e.pending_buf[e.pending++]=r>>>8&255,e.pending_buf[e.pending++]=r&255}function read_buf(e,r,t,v){var I=e.avail_in;return I>v&&(I=v),I===0?0:(e.avail_in-=I,utils$i.arraySet(r,e.input,e.next_in,I,t),e.state.wrap===1?e.adler=adler32$1(e.adler,r,I,t):e.state.wrap===2&&(e.adler=crc32$2(e.adler,r,I,t)),e.next_in+=I,e.total_in+=I,I)}function longest_match(e,r){var t=e.max_chain_length,v=e.strstart,I,b,N=e.prev_length,T=e.nice_match,ae=e.strstart>e.w_size-MIN_LOOKAHEAD?e.strstart-(e.w_size-MIN_LOOKAHEAD):0,X=e.window,G=e.w_mask,ve=e.prev,fe=e.strstart+MAX_MATCH,ce=X[v+N-1],_e=X[v+N];e.prev_length>=e.good_match&&(t>>=2),T>e.lookahead&&(T=e.lookahead);do if(I=r,!(X[I+N]!==_e||X[I+N-1]!==ce||X[I]!==X[v]||X[++I]!==X[v+1])){v+=2,I++;do;while(X[++v]===X[++I]&&X[++v]===X[++I]&&X[++v]===X[++I]&&X[++v]===X[++I]&&X[++v]===X[++I]&&X[++v]===X[++I]&&X[++v]===X[++I]&&X[++v]===X[++I]&&v<fe);if(b=MAX_MATCH-(fe-v),v=fe-MAX_MATCH,b>N){if(e.match_start=r,N=b,b>=T)break;ce=X[v+N-1],_e=X[v+N]}}while((r=ve[r&G])>ae&&--t!==0);return N<=e.lookahead?N:e.lookahead}function fill_window(e){var r=e.w_size,t,v,I,b,N;do{if(b=e.window_size-e.lookahead-e.strstart,e.strstart>=r+(r-MIN_LOOKAHEAD)){utils$i.arraySet(e.window,e.window,r,r,0),e.match_start-=r,e.strstart-=r,e.block_start-=r,v=e.hash_size,t=v;do I=e.head[--t],e.head[t]=I>=r?I-r:0;while(--v);v=r,t=v;do I=e.prev[--t],e.prev[t]=I>=r?I-r:0;while(--v);b+=r}if(e.strm.avail_in===0)break;if(v=read_buf(e.strm,e.window,e.strstart+e.lookahead,b),e.lookahead+=v,e.lookahead+e.insert>=MIN_MATCH)for(N=e.strstart-e.insert,e.ins_h=e.window[N],e.ins_h=(e.ins_h<<e.hash_shift^e.window[N+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[N+MIN_MATCH-1])&e.hash_mask,e.prev[N&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=N,N++,e.insert--,!(e.lookahead+e.insert<MIN_MATCH)););}while(e.lookahead<MIN_LOOKAHEAD&&e.strm.avail_in!==0)}function deflate_stored(e,r){var t=65535;for(t>e.pending_buf_size-5&&(t=e.pending_buf_size-5);;){if(e.lookahead<=1){if(fill_window(e),e.lookahead===0&&r===Z_NO_FLUSH$1)return BS_NEED_MORE;if(e.lookahead===0)break}e.strstart+=e.lookahead,e.lookahead=0;var v=e.block_start+t;if((e.strstart===0||e.strstart>=v)&&(e.lookahead=e.strstart-v,e.strstart=v,flush_block_only(e,!1),e.strm.avail_out===0)||e.strstart-e.block_start>=e.w_size-MIN_LOOKAHEAD&&(flush_block_only(e,!1),e.strm.avail_out===0))return BS_NEED_MORE}return e.insert=0,r===Z_FINISH$2?(flush_block_only(e,!0),e.strm.avail_out===0?BS_FINISH_STARTED:BS_FINISH_DONE):(e.strstart>e.block_start&&(flush_block_only(e,!1),e.strm.avail_out===0),BS_NEED_MORE)}function deflate_fast(e,r){for(var t,v;;){if(e.lookahead<MIN_LOOKAHEAD){if(fill_window(e),e.lookahead<MIN_LOOKAHEAD&&r===Z_NO_FLUSH$1)return BS_NEED_MORE;if(e.lookahead===0)break}if(t=0,e.lookahead>=MIN_MATCH&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+MIN_MATCH-1])&e.hash_mask,t=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),t!==0&&e.strstart-t<=e.w_size-MIN_LOOKAHEAD&&(e.match_length=longest_match(e,t)),e.match_length>=MIN_MATCH)if(v=trees._tr_tally(e,e.strstart-e.match_start,e.match_length-MIN_MATCH),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=MIN_MATCH){e.match_length--;do e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+MIN_MATCH-1])&e.hash_mask,t=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart;while(--e.match_length!==0);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else v=trees._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(v&&(flush_block_only(e,!1),e.strm.avail_out===0))return BS_NEED_MORE}return e.insert=e.strstart<MIN_MATCH-1?e.strstart:MIN_MATCH-1,r===Z_FINISH$2?(flush_block_only(e,!0),e.strm.avail_out===0?BS_FINISH_STARTED:BS_FINISH_DONE):e.last_lit&&(flush_block_only(e,!1),e.strm.avail_out===0)?BS_NEED_MORE:BS_BLOCK_DONE}function deflate_slow(e,r){for(var t,v,I;;){if(e.lookahead<MIN_LOOKAHEAD){if(fill_window(e),e.lookahead<MIN_LOOKAHEAD&&r===Z_NO_FLUSH$1)return BS_NEED_MORE;if(e.lookahead===0)break}if(t=0,e.lookahead>=MIN_MATCH&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+MIN_MATCH-1])&e.hash_mask,t=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=MIN_MATCH-1,t!==0&&e.prev_length<e.max_lazy_match&&e.strstart-t<=e.w_size-MIN_LOOKAHEAD&&(e.match_length=longest_match(e,t),e.match_length<=5&&(e.strategy===Z_FILTERED||e.match_length===MIN_MATCH&&e.strstart-e.match_start>4096)&&(e.match_length=MIN_MATCH-1)),e.prev_length>=MIN_MATCH&&e.match_length<=e.prev_length){I=e.strstart+e.lookahead-MIN_MATCH,v=trees._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-MIN_MATCH),e.lookahead-=e.prev_length-1,e.prev_length-=2;do++e.strstart<=I&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+MIN_MATCH-1])&e.hash_mask,t=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart);while(--e.prev_length!==0);if(e.match_available=0,e.match_length=MIN_MATCH-1,e.strstart++,v&&(flush_block_only(e,!1),e.strm.avail_out===0))return BS_NEED_MORE}else if(e.match_available){if(v=trees._tr_tally(e,0,e.window[e.strstart-1]),v&&flush_block_only(e,!1),e.strstart++,e.lookahead--,e.strm.avail_out===0)return BS_NEED_MORE}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(v=trees._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<MIN_MATCH-1?e.strstart:MIN_MATCH-1,r===Z_FINISH$2?(flush_block_only(e,!0),e.strm.avail_out===0?BS_FINISH_STARTED:BS_FINISH_DONE):e.last_lit&&(flush_block_only(e,!1),e.strm.avail_out===0)?BS_NEED_MORE:BS_BLOCK_DONE}function deflate_rle(e,r){for(var t,v,I,b,N=e.window;;){if(e.lookahead<=MAX_MATCH){if(fill_window(e),e.lookahead<=MAX_MATCH&&r===Z_NO_FLUSH$1)return BS_NEED_MORE;if(e.lookahead===0)break}if(e.match_length=0,e.lookahead>=MIN_MATCH&&e.strstart>0&&(I=e.strstart-1,v=N[I],v===N[++I]&&v===N[++I]&&v===N[++I])){b=e.strstart+MAX_MATCH;do;while(v===N[++I]&&v===N[++I]&&v===N[++I]&&v===N[++I]&&v===N[++I]&&v===N[++I]&&v===N[++I]&&v===N[++I]&&I<b);e.match_length=MAX_MATCH-(b-I),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=MIN_MATCH?(t=trees._tr_tally(e,1,e.match_length-MIN_MATCH),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(t=trees._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),t&&(flush_block_only(e,!1),e.strm.avail_out===0))return BS_NEED_MORE}return e.insert=0,r===Z_FINISH$2?(flush_block_only(e,!0),e.strm.avail_out===0?BS_FINISH_STARTED:BS_FINISH_DONE):e.last_lit&&(flush_block_only(e,!1),e.strm.avail_out===0)?BS_NEED_MORE:BS_BLOCK_DONE}function deflate_huff(e,r){for(var t;;){if(e.lookahead===0&&(fill_window(e),e.lookahead===0)){if(r===Z_NO_FLUSH$1)return BS_NEED_MORE;break}if(e.match_length=0,t=trees._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,t&&(flush_block_only(e,!1),e.strm.avail_out===0))return BS_NEED_MORE}return e.insert=0,r===Z_FINISH$2?(flush_block_only(e,!0),e.strm.avail_out===0?BS_FINISH_STARTED:BS_FINISH_DONE):e.last_lit&&(flush_block_only(e,!1),e.strm.avail_out===0)?BS_NEED_MORE:BS_BLOCK_DONE}function Config(e,r,t,v,I){this.good_length=e,this.max_lazy=r,this.nice_length=t,this.max_chain=v,this.func=I}var configuration_table;configuration_table=[new Config(0,0,0,0,deflate_stored),new Config(4,4,8,4,deflate_fast),new Config(4,5,16,8,deflate_fast),new Config(4,6,32,32,deflate_fast),new Config(4,4,16,16,deflate_slow),new Config(8,16,32,32,deflate_slow),new Config(8,16,128,128,deflate_slow),new Config(8,32,128,256,deflate_slow),new Config(32,128,258,1024,deflate_slow),new Config(32,258,258,4096,deflate_slow)];function lm_init(e){e.window_size=2*e.w_size,zero(e.head),e.max_lazy_match=configuration_table[e.level].max_lazy,e.good_match=configuration_table[e.level].good_length,e.nice_match=configuration_table[e.level].nice_length,e.max_chain_length=configuration_table[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=MIN_MATCH-1,e.match_available=0,e.ins_h=0}function DeflateState(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Z_DEFLATED$2,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new utils$i.Buf16(HEAP_SIZE*2),this.dyn_dtree=new utils$i.Buf16((2*D_CODES+1)*2),this.bl_tree=new utils$i.Buf16((2*BL_CODES+1)*2),zero(this.dyn_ltree),zero(this.dyn_dtree),zero(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new utils$i.Buf16(MAX_BITS+1),this.heap=new utils$i.Buf16(2*L_CODES+1),zero(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new utils$i.Buf16(2*L_CODES+1),zero(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function deflateResetKeep(e){var r;return!e||!e.state?err(e,Z_STREAM_ERROR$1):(e.total_in=e.total_out=0,e.data_type=Z_UNKNOWN,r=e.state,r.pending=0,r.pending_out=0,r.wrap<0&&(r.wrap=-r.wrap),r.status=r.wrap?INIT_STATE:BUSY_STATE,e.adler=r.wrap===2?0:1,r.last_flush=Z_NO_FLUSH$1,trees._tr_init(r),Z_OK$2)}function deflateReset(e){var r=deflateResetKeep(e);return r===Z_OK$2&&lm_init(e.state),r}function deflateSetHeader(e,r){return!e||!e.state||e.state.wrap!==2?Z_STREAM_ERROR$1:(e.state.gzhead=r,Z_OK$2)}function deflateInit2(e,r,t,v,I,b){if(!e)return Z_STREAM_ERROR$1;var N=1;if(r===Z_DEFAULT_COMPRESSION$1&&(r=6),v<0?(N=0,v=-v):v>15&&(N=2,v-=16),I<1||I>MAX_MEM_LEVEL||t!==Z_DEFLATED$2||v<8||v>15||r<0||r>9||b<0||b>Z_FIXED)return err(e,Z_STREAM_ERROR$1);v===8&&(v=9);var T=new DeflateState;return e.state=T,T.strm=e,T.wrap=N,T.gzhead=null,T.w_bits=v,T.w_size=1<<T.w_bits,T.w_mask=T.w_size-1,T.hash_bits=I+7,T.hash_size=1<<T.hash_bits,T.hash_mask=T.hash_size-1,T.hash_shift=~~((T.hash_bits+MIN_MATCH-1)/MIN_MATCH),T.window=new utils$i.Buf8(T.w_size*2),T.head=new utils$i.Buf16(T.hash_size),T.prev=new utils$i.Buf16(T.w_size),T.lit_bufsize=1<<I+6,T.pending_buf_size=T.lit_bufsize*4,T.pending_buf=new utils$i.Buf8(T.pending_buf_size),T.d_buf=1*T.lit_bufsize,T.l_buf=(1+2)*T.lit_bufsize,T.level=r,T.strategy=b,T.method=t,deflateReset(e)}function deflateInit(e,r){return deflateInit2(e,r,Z_DEFLATED$2,MAX_WBITS$1,DEF_MEM_LEVEL,Z_DEFAULT_STRATEGY$1)}function deflate$2(e,r){var t,v,I,b;if(!e||!e.state||r>Z_BLOCK$1||r<0)return e?err(e,Z_STREAM_ERROR$1):Z_STREAM_ERROR$1;if(v=e.state,!e.output||!e.input&&e.avail_in!==0||v.status===FINISH_STATE&&r!==Z_FINISH$2)return err(e,e.avail_out===0?Z_BUF_ERROR$1:Z_STREAM_ERROR$1);if(v.strm=e,t=v.last_flush,v.last_flush=r,v.status===INIT_STATE)if(v.wrap===2)e.adler=0,put_byte(v,31),put_byte(v,139),put_byte(v,8),v.gzhead?(put_byte(v,(v.gzhead.text?1:0)+(v.gzhead.hcrc?2:0)+(v.gzhead.extra?4:0)+(v.gzhead.name?8:0)+(v.gzhead.comment?16:0)),put_byte(v,v.gzhead.time&255),put_byte(v,v.gzhead.time>>8&255),put_byte(v,v.gzhead.time>>16&255),put_byte(v,v.gzhead.time>>24&255),put_byte(v,v.level===9?2:v.strategy>=Z_HUFFMAN_ONLY||v.level<2?4:0),put_byte(v,v.gzhead.os&255),v.gzhead.extra&&v.gzhead.extra.length&&(put_byte(v,v.gzhead.extra.length&255),put_byte(v,v.gzhead.extra.length>>8&255)),v.gzhead.hcrc&&(e.adler=crc32$2(e.adler,v.pending_buf,v.pending,0)),v.gzindex=0,v.status=EXTRA_STATE):(put_byte(v,0),put_byte(v,0),put_byte(v,0),put_byte(v,0),put_byte(v,0),put_byte(v,v.level===9?2:v.strategy>=Z_HUFFMAN_ONLY||v.level<2?4:0),put_byte(v,OS_CODE),v.status=BUSY_STATE);else{var N=Z_DEFLATED$2+(v.w_bits-8<<4)<<8,T=-1;v.strategy>=Z_HUFFMAN_ONLY||v.level<2?T=0:v.level<6?T=1:v.level===6?T=2:T=3,N|=T<<6,v.strstart!==0&&(N|=PRESET_DICT),N+=31-N%31,v.status=BUSY_STATE,putShortMSB(v,N),v.strstart!==0&&(putShortMSB(v,e.adler>>>16),putShortMSB(v,e.adler&65535)),e.adler=1}if(v.status===EXTRA_STATE)if(v.gzhead.extra){for(I=v.pending;v.gzindex<(v.gzhead.extra.length&65535)&&!(v.pending===v.pending_buf_size&&(v.gzhead.hcrc&&v.pending>I&&(e.adler=crc32$2(e.adler,v.pending_buf,v.pending-I,I)),flush_pending(e),I=v.pending,v.pending===v.pending_buf_size));)put_byte(v,v.gzhead.extra[v.gzindex]&255),v.gzindex++;v.gzhead.hcrc&&v.pending>I&&(e.adler=crc32$2(e.adler,v.pending_buf,v.pending-I,I)),v.gzindex===v.gzhead.extra.length&&(v.gzindex=0,v.status=NAME_STATE)}else v.status=NAME_STATE;if(v.status===NAME_STATE)if(v.gzhead.name){I=v.pending;do{if(v.pending===v.pending_buf_size&&(v.gzhead.hcrc&&v.pending>I&&(e.adler=crc32$2(e.adler,v.pending_buf,v.pending-I,I)),flush_pending(e),I=v.pending,v.pending===v.pending_buf_size)){b=1;break}v.gzindex<v.gzhead.name.length?b=v.gzhead.name.charCodeAt(v.gzindex++)&255:b=0,put_byte(v,b)}while(b!==0);v.gzhead.hcrc&&v.pending>I&&(e.adler=crc32$2(e.adler,v.pending_buf,v.pending-I,I)),b===0&&(v.gzindex=0,v.status=COMMENT_STATE)}else v.status=COMMENT_STATE;if(v.status===COMMENT_STATE)if(v.gzhead.comment){I=v.pending;do{if(v.pending===v.pending_buf_size&&(v.gzhead.hcrc&&v.pending>I&&(e.adler=crc32$2(e.adler,v.pending_buf,v.pending-I,I)),flush_pending(e),I=v.pending,v.pending===v.pending_buf_size)){b=1;break}v.gzindex<v.gzhead.comment.length?b=v.gzhead.comment.charCodeAt(v.gzindex++)&255:b=0,put_byte(v,b)}while(b!==0);v.gzhead.hcrc&&v.pending>I&&(e.adler=crc32$2(e.adler,v.pending_buf,v.pending-I,I)),b===0&&(v.status=HCRC_STATE)}else v.status=HCRC_STATE;if(v.status===HCRC_STATE&&(v.gzhead.hcrc?(v.pending+2>v.pending_buf_size&&flush_pending(e),v.pending+2<=v.pending_buf_size&&(put_byte(v,e.adler&255),put_byte(v,e.adler>>8&255),e.adler=0,v.status=BUSY_STATE)):v.status=BUSY_STATE),v.pending!==0){if(flush_pending(e),e.avail_out===0)return v.last_flush=-1,Z_OK$2}else if(e.avail_in===0&&rank(r)<=rank(t)&&r!==Z_FINISH$2)return err(e,Z_BUF_ERROR$1);if(v.status===FINISH_STATE&&e.avail_in!==0)return err(e,Z_BUF_ERROR$1);if(e.avail_in!==0||v.lookahead!==0||r!==Z_NO_FLUSH$1&&v.status!==FINISH_STATE){var ae=v.strategy===Z_HUFFMAN_ONLY?deflate_huff(v,r):v.strategy===Z_RLE?deflate_rle(v,r):configuration_table[v.level].func(v,r);if((ae===BS_FINISH_STARTED||ae===BS_FINISH_DONE)&&(v.status=FINISH_STATE),ae===BS_NEED_MORE||ae===BS_FINISH_STARTED)return e.avail_out===0&&(v.last_flush=-1),Z_OK$2;if(ae===BS_BLOCK_DONE&&(r===Z_PARTIAL_FLUSH?trees._tr_align(v):r!==Z_BLOCK$1&&(trees._tr_stored_block(v,0,0,!1),r===Z_FULL_FLUSH&&(zero(v.head),v.lookahead===0&&(v.strstart=0,v.block_start=0,v.insert=0))),flush_pending(e),e.avail_out===0))return v.last_flush=-1,Z_OK$2}return r!==Z_FINISH$2?Z_OK$2:v.wrap<=0?Z_STREAM_END$2:(v.wrap===2?(put_byte(v,e.adler&255),put_byte(v,e.adler>>8&255),put_byte(v,e.adler>>16&255),put_byte(v,e.adler>>24&255),put_byte(v,e.total_in&255),put_byte(v,e.total_in>>8&255),put_byte(v,e.total_in>>16&255),put_byte(v,e.total_in>>24&255)):(putShortMSB(v,e.adler>>>16),putShortMSB(v,e.adler&65535)),flush_pending(e),v.wrap>0&&(v.wrap=-v.wrap),v.pending!==0?Z_OK$2:Z_STREAM_END$2)}function deflateEnd(e){var r;return!e||!e.state?Z_STREAM_ERROR$1:(r=e.state.status,r!==INIT_STATE&&r!==EXTRA_STATE&&r!==NAME_STATE&&r!==COMMENT_STATE&&r!==HCRC_STATE&&r!==BUSY_STATE&&r!==FINISH_STATE?err(e,Z_STREAM_ERROR$1):(e.state=null,r===BUSY_STATE?err(e,Z_DATA_ERROR$1):Z_OK$2))}function deflateSetDictionary(e,r){var t=r.length,v,I,b,N,T,ae,X,G;if(!e||!e.state||(v=e.state,N=v.wrap,N===2||N===1&&v.status!==INIT_STATE||v.lookahead))return Z_STREAM_ERROR$1;for(N===1&&(e.adler=adler32$1(e.adler,r,t,0)),v.wrap=0,t>=v.w_size&&(N===0&&(zero(v.head),v.strstart=0,v.block_start=0,v.insert=0),G=new utils$i.Buf8(v.w_size),utils$i.arraySet(G,r,t-v.w_size,v.w_size,0),r=G,t=v.w_size),T=e.avail_in,ae=e.next_in,X=e.input,e.avail_in=t,e.next_in=0,e.input=r,fill_window(v);v.lookahead>=MIN_MATCH;){I=v.strstart,b=v.lookahead-(MIN_MATCH-1);do v.ins_h=(v.ins_h<<v.hash_shift^v.window[I+MIN_MATCH-1])&v.hash_mask,v.prev[I&v.w_mask]=v.head[v.ins_h],v.head[v.ins_h]=I,I++;while(--b);v.strstart=I,v.lookahead=MIN_MATCH-1,fill_window(v)}return v.strstart+=v.lookahead,v.block_start=v.strstart,v.insert=v.lookahead,v.lookahead=0,v.match_length=v.prev_length=MIN_MATCH-1,v.match_available=0,e.next_in=ae,e.input=X,e.avail_in=T,v.wrap=N,Z_OK$2}deflate$3.deflateInit=deflateInit,deflate$3.deflateInit2=deflateInit2,deflate$3.deflateReset=deflateReset,deflate$3.deflateResetKeep=deflateResetKeep,deflate$3.deflateSetHeader=deflateSetHeader,deflate$3.deflate=deflate$2,deflate$3.deflateEnd=deflateEnd,deflate$3.deflateSetDictionary=deflateSetDictionary,deflate$3.deflateInfo="pako deflate (from Nodeca project)";var strings$2={},utils$h=common,STR_APPLY_OK=!0,STR_APPLY_UIA_OK=!0;try{String.fromCharCode.apply(null,[0])}catch(e){STR_APPLY_OK=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){STR_APPLY_UIA_OK=!1}for(var _utf8len=new utils$h.Buf8(256),q=0;q<256;q++)_utf8len[q]=q>=252?6:q>=248?5:q>=240?4:q>=224?3:q>=192?2:1;_utf8len[254]=_utf8len[254]=1,strings$2.string2buf=function(e){var r,t,v,I,b,N=e.length,T=0;for(I=0;I<N;I++)t=e.charCodeAt(I),(t&64512)===55296&&I+1<N&&(v=e.charCodeAt(I+1),(v&64512)===56320&&(t=65536+(t-55296<<10)+(v-56320),I++)),T+=t<128?1:t<2048?2:t<65536?3:4;for(r=new utils$h.Buf8(T),b=0,I=0;b<T;I++)t=e.charCodeAt(I),(t&64512)===55296&&I+1<N&&(v=e.charCodeAt(I+1),(v&64512)===56320&&(t=65536+(t-55296<<10)+(v-56320),I++)),t<128?r[b++]=t:t<2048?(r[b++]=192|t>>>6,r[b++]=128|t&63):t<65536?(r[b++]=224|t>>>12,r[b++]=128|t>>>6&63,r[b++]=128|t&63):(r[b++]=240|t>>>18,r[b++]=128|t>>>12&63,r[b++]=128|t>>>6&63,r[b++]=128|t&63);return r};function buf2binstring(e,r){if(r<65534&&(e.subarray&&STR_APPLY_UIA_OK||!e.subarray&&STR_APPLY_OK))return String.fromCharCode.apply(null,utils$h.shrinkBuf(e,r));for(var t="",v=0;v<r;v++)t+=String.fromCharCode(e[v]);return t}strings$2.buf2binstring=function(e){return buf2binstring(e,e.length)},strings$2.binstring2buf=function(e){for(var r=new utils$h.Buf8(e.length),t=0,v=r.length;t<v;t++)r[t]=e.charCodeAt(t);return r},strings$2.buf2string=function(e,r){var t,v,I,b,N=r||e.length,T=new Array(N*2);for(v=0,t=0;t<N;){if(I=e[t++],I<128){T[v++]=I;continue}if(b=_utf8len[I],b>4){T[v++]=65533,t+=b-1;continue}for(I&=b===2?31:b===3?15:7;b>1&&t<N;)I=I<<6|e[t++]&63,b--;if(b>1){T[v++]=65533;continue}I<65536?T[v++]=I:(I-=65536,T[v++]=55296|I>>10&1023,T[v++]=56320|I&1023)}return buf2binstring(T,v)},strings$2.utf8border=function(e,r){var t;for(r=r||e.length,r>e.length&&(r=e.length),t=r-1;t>=0&&(e[t]&192)===128;)t--;return t<0||t===0?r:t+_utf8len[e[t]]>r?t:r};function ZStream$2(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var zstream=ZStream$2,zlib_deflate=deflate$3,utils$g=common,strings$1=strings$2,msg$1=messages,ZStream$1=zstream,toString$1=Object.prototype.toString,Z_NO_FLUSH=0,Z_FINISH$1=4,Z_OK$1=0,Z_STREAM_END$1=1,Z_SYNC_FLUSH=2,Z_DEFAULT_COMPRESSION=-1,Z_DEFAULT_STRATEGY=0,Z_DEFLATED$1=8;function Deflate(e){if(!(this instanceof Deflate))return new Deflate(e);this.options=utils$g.assign({level:Z_DEFAULT_COMPRESSION,method:Z_DEFLATED$1,chunkSize:16384,windowBits:15,memLevel:8,strategy:Z_DEFAULT_STRATEGY,to:""},e||{});var r=this.options;r.raw&&r.windowBits>0?r.windowBits=-r.windowBits:r.gzip&&r.windowBits>0&&r.windowBits<16&&(r.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new ZStream$1,this.strm.avail_out=0;var t=zlib_deflate.deflateInit2(this.strm,r.level,r.method,r.windowBits,r.memLevel,r.strategy);if(t!==Z_OK$1)throw new Error(msg$1[t]);if(r.header&&zlib_deflate.deflateSetHeader(this.strm,r.header),r.dictionary){var v;if(typeof r.dictionary=="string"?v=strings$1.string2buf(r.dictionary):toString$1.call(r.dictionary)==="[object ArrayBuffer]"?v=new Uint8Array(r.dictionary):v=r.dictionary,t=zlib_deflate.deflateSetDictionary(this.strm,v),t!==Z_OK$1)throw new Error(msg$1[t]);this._dict_set=!0}}Deflate.prototype.push=function(e,r){var t=this.strm,v=this.options.chunkSize,I,b;if(this.ended)return!1;b=r===~~r?r:r===!0?Z_FINISH$1:Z_NO_FLUSH,typeof e=="string"?t.input=strings$1.string2buf(e):toString$1.call(e)==="[object ArrayBuffer]"?t.input=new Uint8Array(e):t.input=e,t.next_in=0,t.avail_in=t.input.length;do{if(t.avail_out===0&&(t.output=new utils$g.Buf8(v),t.next_out=0,t.avail_out=v),I=zlib_deflate.deflate(t,b),I!==Z_STREAM_END$1&&I!==Z_OK$1)return this.onEnd(I),this.ended=!0,!1;(t.avail_out===0||t.avail_in===0&&(b===Z_FINISH$1||b===Z_SYNC_FLUSH))&&(this.options.to==="string"?this.onData(strings$1.buf2binstring(utils$g.shrinkBuf(t.output,t.next_out))):this.onData(utils$g.shrinkBuf(t.output,t.next_out)))}while((t.avail_in>0||t.avail_out===0)&&I!==Z_STREAM_END$1);return b===Z_FINISH$1?(I=zlib_deflate.deflateEnd(this.strm),this.onEnd(I),this.ended=!0,I===Z_OK$1):(b===Z_SYNC_FLUSH&&(this.onEnd(Z_OK$1),t.avail_out=0),!0)},Deflate.prototype.onData=function(e){this.chunks.push(e)},Deflate.prototype.onEnd=function(e){e===Z_OK$1&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=utils$g.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function deflate$1(e,r){var t=new Deflate(r);if(t.push(e,!0),t.err)throw t.msg||msg$1[t.err];return t.result}function deflateRaw(e,r){return r=r||{},r.raw=!0,deflate$1(e,r)}function gzip(e,r){return r=r||{},r.gzip=!0,deflate$1(e,r)}deflate$4.Deflate=Deflate,deflate$4.deflate=deflate$1,deflate$4.deflateRaw=deflateRaw,deflate$4.gzip=gzip;var inflate$4={},inflate$3={},BAD$1=30,TYPE$1=12,inffast=function(r,t){var v,I,b,N,T,ae,X,G,ve,fe,ce,_e,Ee,ye,be,Te,Ae,Se,$e,ke,Ne,Ce,he,Be,Ie;v=r.state,I=r.next_in,Be=r.input,b=I+(r.avail_in-5),N=r.next_out,Ie=r.output,T=N-(t-r.avail_out),ae=N+(r.avail_out-257),X=v.dmax,G=v.wsize,ve=v.whave,fe=v.wnext,ce=v.window,_e=v.hold,Ee=v.bits,ye=v.lencode,be=v.distcode,Te=(1<<v.lenbits)-1,Ae=(1<<v.distbits)-1;e:do{Ee<15&&(_e+=Be[I++]<<Ee,Ee+=8,_e+=Be[I++]<<Ee,Ee+=8),Se=ye[_e&Te];t:for(;;){if($e=Se>>>24,_e>>>=$e,Ee-=$e,$e=Se>>>16&255,$e===0)Ie[N++]=Se&65535;else if($e&16){ke=Se&65535,$e&=15,$e&&(Ee<$e&&(_e+=Be[I++]<<Ee,Ee+=8),ke+=_e&(1<<$e)-1,_e>>>=$e,Ee-=$e),Ee<15&&(_e+=Be[I++]<<Ee,Ee+=8,_e+=Be[I++]<<Ee,Ee+=8),Se=be[_e&Ae];r:for(;;){if($e=Se>>>24,_e>>>=$e,Ee-=$e,$e=Se>>>16&255,$e&16){if(Ne=Se&65535,$e&=15,Ee<$e&&(_e+=Be[I++]<<Ee,Ee+=8,Ee<$e&&(_e+=Be[I++]<<Ee,Ee+=8)),Ne+=_e&(1<<$e)-1,Ne>X){r.msg="invalid distance too far back",v.mode=BAD$1;break e}if(_e>>>=$e,Ee-=$e,$e=N-T,Ne>$e){if($e=Ne-$e,$e>ve&&v.sane){r.msg="invalid distance too far back",v.mode=BAD$1;break e}if(Ce=0,he=ce,fe===0){if(Ce+=G-$e,$e<ke){ke-=$e;do Ie[N++]=ce[Ce++];while(--$e);Ce=N-Ne,he=Ie}}else if(fe<$e){if(Ce+=G+fe-$e,$e-=fe,$e<ke){ke-=$e;do Ie[N++]=ce[Ce++];while(--$e);if(Ce=0,fe<ke){$e=fe,ke-=$e;do Ie[N++]=ce[Ce++];while(--$e);Ce=N-Ne,he=Ie}}}else if(Ce+=fe-$e,$e<ke){ke-=$e;do Ie[N++]=ce[Ce++];while(--$e);Ce=N-Ne,he=Ie}for(;ke>2;)Ie[N++]=he[Ce++],Ie[N++]=he[Ce++],Ie[N++]=he[Ce++],ke-=3;ke&&(Ie[N++]=he[Ce++],ke>1&&(Ie[N++]=he[Ce++]))}else{Ce=N-Ne;do Ie[N++]=Ie[Ce++],Ie[N++]=Ie[Ce++],Ie[N++]=Ie[Ce++],ke-=3;while(ke>2);ke&&(Ie[N++]=Ie[Ce++],ke>1&&(Ie[N++]=Ie[Ce++]))}}else if(($e&64)===0){Se=be[(Se&65535)+(_e&(1<<$e)-1)];continue r}else{r.msg="invalid distance code",v.mode=BAD$1;break e}break}}else if(($e&64)===0){Se=ye[(Se&65535)+(_e&(1<<$e)-1)];continue t}else if($e&32){v.mode=TYPE$1;break e}else{r.msg="invalid literal/length code",v.mode=BAD$1;break e}break}}while(I<b&&N<ae);ke=Ee>>3,I-=ke,Ee-=ke<<3,_e&=(1<<Ee)-1,r.next_in=I,r.next_out=N,r.avail_in=I<b?5+(b-I):5-(I-b),r.avail_out=N<ae?257+(ae-N):257-(N-ae),v.hold=_e,v.bits=Ee},utils$f=common,MAXBITS=15,ENOUGH_LENS$1=852,ENOUGH_DISTS$1=592,CODES$1=0,LENS$1=1,DISTS$1=2,lbase=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],lext=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],dbase=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],dext=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64],inftrees=function(r,t,v,I,b,N,T,ae){var X=ae.bits,G=0,ve=0,fe=0,ce=0,_e=0,Ee=0,ye=0,be=0,Te=0,Ae=0,Se,$e,ke,Ne,Ce,he=null,Be=0,Ie,De=new utils$f.Buf16(MAXBITS+1),We=new utils$f.Buf16(MAXBITS+1),Ve=null,Xe=0,et,Re,Qe;for(G=0;G<=MAXBITS;G++)De[G]=0;for(ve=0;ve<I;ve++)De[t[v+ve]]++;for(_e=X,ce=MAXBITS;ce>=1&&De[ce]===0;ce--);if(_e>ce&&(_e=ce),ce===0)return b[N++]=1<<24|64<<16|0,b[N++]=1<<24|64<<16|0,ae.bits=1,0;for(fe=1;fe<ce&&De[fe]===0;fe++);for(_e<fe&&(_e=fe),be=1,G=1;G<=MAXBITS;G++)if(be<<=1,be-=De[G],be<0)return-1;if(be>0&&(r===CODES$1||ce!==1))return-1;for(We[1]=0,G=1;G<MAXBITS;G++)We[G+1]=We[G]+De[G];for(ve=0;ve<I;ve++)t[v+ve]!==0&&(T[We[t[v+ve]]++]=ve);if(r===CODES$1?(he=Ve=T,Ie=19):r===LENS$1?(he=lbase,Be-=257,Ve=lext,Xe-=257,Ie=256):(he=dbase,Ve=dext,Ie=-1),Ae=0,ve=0,G=fe,Ce=N,Ee=_e,ye=0,ke=-1,Te=1<<_e,Ne=Te-1,r===LENS$1&&Te>ENOUGH_LENS$1||r===DISTS$1&&Te>ENOUGH_DISTS$1)return 1;for(;;){et=G-ye,T[ve]<Ie?(Re=0,Qe=T[ve]):T[ve]>Ie?(Re=Ve[Xe+T[ve]],Qe=he[Be+T[ve]]):(Re=32+64,Qe=0),Se=1<<G-ye,$e=1<<Ee,fe=$e;do $e-=Se,b[Ce+(Ae>>ye)+$e]=et<<24|Re<<16|Qe|0;while($e!==0);for(Se=1<<G-1;Ae&Se;)Se>>=1;if(Se!==0?(Ae&=Se-1,Ae+=Se):Ae=0,ve++,--De[G]===0){if(G===ce)break;G=t[v+T[ve]]}if(G>_e&&(Ae&Ne)!==ke){for(ye===0&&(ye=_e),Ce+=fe,Ee=G-ye,be=1<<Ee;Ee+ye<ce&&(be-=De[Ee+ye],!(be<=0));)Ee++,be<<=1;if(Te+=1<<Ee,r===LENS$1&&Te>ENOUGH_LENS$1||r===DISTS$1&&Te>ENOUGH_DISTS$1)return 1;ke=Ae&Ne,b[ke]=_e<<24|Ee<<16|Ce-N|0}}return Ae!==0&&(b[Ce+Ae]=G-ye<<24|64<<16|0),ae.bits=_e,0},utils$e=common,adler32=adler32_1,crc32$1=crc32_1,inflate_fast=inffast,inflate_table=inftrees,CODES=0,LENS=1,DISTS=2,Z_FINISH=4,Z_BLOCK=5,Z_TREES=6,Z_OK=0,Z_STREAM_END=1,Z_NEED_DICT=2,Z_STREAM_ERROR=-2,Z_DATA_ERROR=-3,Z_MEM_ERROR=-4,Z_BUF_ERROR=-5,Z_DEFLATED=8,HEAD=1,FLAGS=2,TIME=3,OS=4,EXLEN=5,EXTRA=6,NAME=7,COMMENT=8,HCRC=9,DICTID=10,DICT=11,TYPE=12,TYPEDO=13,STORED=14,COPY_=15,COPY=16,TABLE=17,LENLENS=18,CODELENS=19,LEN_=20,LEN=21,LENEXT=22,DIST=23,DISTEXT=24,MATCH=25,LIT=26,CHECK=27,LENGTH=28,DONE=29,BAD=30,MEM=31,SYNC=32,ENOUGH_LENS=852,ENOUGH_DISTS=592,MAX_WBITS=15,DEF_WBITS=MAX_WBITS;function zswap32(e){return(e>>>24&255)+(e>>>8&65280)+((e&65280)<<8)+((e&255)<<24)}function InflateState(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new utils$e.Buf16(320),this.work=new utils$e.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function inflateResetKeep(e){var r;return!e||!e.state?Z_STREAM_ERROR:(r=e.state,e.total_in=e.total_out=r.total=0,e.msg="",r.wrap&&(e.adler=r.wrap&1),r.mode=HEAD,r.last=0,r.havedict=0,r.dmax=32768,r.head=null,r.hold=0,r.bits=0,r.lencode=r.lendyn=new utils$e.Buf32(ENOUGH_LENS),r.distcode=r.distdyn=new utils$e.Buf32(ENOUGH_DISTS),r.sane=1,r.back=-1,Z_OK)}function inflateReset(e){var r;return!e||!e.state?Z_STREAM_ERROR:(r=e.state,r.wsize=0,r.whave=0,r.wnext=0,inflateResetKeep(e))}function inflateReset2(e,r){var t,v;return!e||!e.state||(v=e.state,r<0?(t=0,r=-r):(t=(r>>4)+1,r<48&&(r&=15)),r&&(r<8||r>15))?Z_STREAM_ERROR:(v.window!==null&&v.wbits!==r&&(v.window=null),v.wrap=t,v.wbits=r,inflateReset(e))}function inflateInit2(e,r){var t,v;return e?(v=new InflateState,e.state=v,v.window=null,t=inflateReset2(e,r),t!==Z_OK&&(e.state=null),t):Z_STREAM_ERROR}function inflateInit(e){return inflateInit2(e,DEF_WBITS)}var virgin=!0,lenfix,distfix;function fixedtables(e){if(virgin){var r;for(lenfix=new utils$e.Buf32(512),distfix=new utils$e.Buf32(32),r=0;r<144;)e.lens[r++]=8;for(;r<256;)e.lens[r++]=9;for(;r<280;)e.lens[r++]=7;for(;r<288;)e.lens[r++]=8;for(inflate_table(LENS,e.lens,0,288,lenfix,0,e.work,{bits:9}),r=0;r<32;)e.lens[r++]=5;inflate_table(DISTS,e.lens,0,32,distfix,0,e.work,{bits:5}),virgin=!1}e.lencode=lenfix,e.lenbits=9,e.distcode=distfix,e.distbits=5}function updatewindow(e,r,t,v){var I,b=e.state;return b.window===null&&(b.wsize=1<<b.wbits,b.wnext=0,b.whave=0,b.window=new utils$e.Buf8(b.wsize)),v>=b.wsize?(utils$e.arraySet(b.window,r,t-b.wsize,b.wsize,0),b.wnext=0,b.whave=b.wsize):(I=b.wsize-b.wnext,I>v&&(I=v),utils$e.arraySet(b.window,r,t-v,I,b.wnext),v-=I,v?(utils$e.arraySet(b.window,r,t-v,v,0),b.wnext=v,b.whave=b.wsize):(b.wnext+=I,b.wnext===b.wsize&&(b.wnext=0),b.whave<b.wsize&&(b.whave+=I))),0}function inflate$2(e,r){var t,v,I,b,N,T,ae,X,G,ve,fe,ce,_e,Ee,ye=0,be,Te,Ae,Se,$e,ke,Ne,Ce,he=new utils$e.Buf8(4),Be,Ie,De=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&e.avail_in!==0)return Z_STREAM_ERROR;t=e.state,t.mode===TYPE&&(t.mode=TYPEDO),N=e.next_out,I=e.output,ae=e.avail_out,b=e.next_in,v=e.input,T=e.avail_in,X=t.hold,G=t.bits,ve=T,fe=ae,Ce=Z_OK;e:for(;;)switch(t.mode){case HEAD:if(t.wrap===0){t.mode=TYPEDO;break}for(;G<16;){if(T===0)break e;T--,X+=v[b++]<<G,G+=8}if(t.wrap&2&&X===35615){t.check=0,he[0]=X&255,he[1]=X>>>8&255,t.check=crc32$1(t.check,he,2,0),X=0,G=0,t.mode=FLAGS;break}if(t.flags=0,t.head&&(t.head.done=!1),!(t.wrap&1)||(((X&255)<<8)+(X>>8))%31){e.msg="incorrect header check",t.mode=BAD;break}if((X&15)!==Z_DEFLATED){e.msg="unknown compression method",t.mode=BAD;break}if(X>>>=4,G-=4,Ne=(X&15)+8,t.wbits===0)t.wbits=Ne;else if(Ne>t.wbits){e.msg="invalid window size",t.mode=BAD;break}t.dmax=1<<Ne,e.adler=t.check=1,t.mode=X&512?DICTID:TYPE,X=0,G=0;break;case FLAGS:for(;G<16;){if(T===0)break e;T--,X+=v[b++]<<G,G+=8}if(t.flags=X,(t.flags&255)!==Z_DEFLATED){e.msg="unknown compression method",t.mode=BAD;break}if(t.flags&57344){e.msg="unknown header flags set",t.mode=BAD;break}t.head&&(t.head.text=X>>8&1),t.flags&512&&(he[0]=X&255,he[1]=X>>>8&255,t.check=crc32$1(t.check,he,2,0)),X=0,G=0,t.mode=TIME;case TIME:for(;G<32;){if(T===0)break e;T--,X+=v[b++]<<G,G+=8}t.head&&(t.head.time=X),t.flags&512&&(he[0]=X&255,he[1]=X>>>8&255,he[2]=X>>>16&255,he[3]=X>>>24&255,t.check=crc32$1(t.check,he,4,0)),X=0,G=0,t.mode=OS;case OS:for(;G<16;){if(T===0)break e;T--,X+=v[b++]<<G,G+=8}t.head&&(t.head.xflags=X&255,t.head.os=X>>8),t.flags&512&&(he[0]=X&255,he[1]=X>>>8&255,t.check=crc32$1(t.check,he,2,0)),X=0,G=0,t.mode=EXLEN;case EXLEN:if(t.flags&1024){for(;G<16;){if(T===0)break e;T--,X+=v[b++]<<G,G+=8}t.length=X,t.head&&(t.head.extra_len=X),t.flags&512&&(he[0]=X&255,he[1]=X>>>8&255,t.check=crc32$1(t.check,he,2,0)),X=0,G=0}else t.head&&(t.head.extra=null);t.mode=EXTRA;case EXTRA:if(t.flags&1024&&(ce=t.length,ce>T&&(ce=T),ce&&(t.head&&(Ne=t.head.extra_len-t.length,t.head.extra||(t.head.extra=new Array(t.head.extra_len)),utils$e.arraySet(t.head.extra,v,b,ce,Ne)),t.flags&512&&(t.check=crc32$1(t.check,v,ce,b)),T-=ce,b+=ce,t.length-=ce),t.length))break e;t.length=0,t.mode=NAME;case NAME:if(t.flags&2048){if(T===0)break e;ce=0;do Ne=v[b+ce++],t.head&&Ne&&t.length<65536&&(t.head.name+=String.fromCharCode(Ne));while(Ne&&ce<T);if(t.flags&512&&(t.check=crc32$1(t.check,v,ce,b)),T-=ce,b+=ce,Ne)break e}else t.head&&(t.head.name=null);t.length=0,t.mode=COMMENT;case COMMENT:if(t.flags&4096){if(T===0)break e;ce=0;do Ne=v[b+ce++],t.head&&Ne&&t.length<65536&&(t.head.comment+=String.fromCharCode(Ne));while(Ne&&ce<T);if(t.flags&512&&(t.check=crc32$1(t.check,v,ce,b)),T-=ce,b+=ce,Ne)break e}else t.head&&(t.head.comment=null);t.mode=HCRC;case HCRC:if(t.flags&512){for(;G<16;){if(T===0)break e;T--,X+=v[b++]<<G,G+=8}if(X!==(t.check&65535)){e.msg="header crc mismatch",t.mode=BAD;break}X=0,G=0}t.head&&(t.head.hcrc=t.flags>>9&1,t.head.done=!0),e.adler=t.check=0,t.mode=TYPE;break;case DICTID:for(;G<32;){if(T===0)break e;T--,X+=v[b++]<<G,G+=8}e.adler=t.check=zswap32(X),X=0,G=0,t.mode=DICT;case DICT:if(t.havedict===0)return e.next_out=N,e.avail_out=ae,e.next_in=b,e.avail_in=T,t.hold=X,t.bits=G,Z_NEED_DICT;e.adler=t.check=1,t.mode=TYPE;case TYPE:if(r===Z_BLOCK||r===Z_TREES)break e;case TYPEDO:if(t.last){X>>>=G&7,G-=G&7,t.mode=CHECK;break}for(;G<3;){if(T===0)break e;T--,X+=v[b++]<<G,G+=8}switch(t.last=X&1,X>>>=1,G-=1,X&3){case 0:t.mode=STORED;break;case 1:if(fixedtables(t),t.mode=LEN_,r===Z_TREES){X>>>=2,G-=2;break e}break;case 2:t.mode=TABLE;break;case 3:e.msg="invalid block type",t.mode=BAD}X>>>=2,G-=2;break;case STORED:for(X>>>=G&7,G-=G&7;G<32;){if(T===0)break e;T--,X+=v[b++]<<G,G+=8}if((X&65535)!==(X>>>16^65535)){e.msg="invalid stored block lengths",t.mode=BAD;break}if(t.length=X&65535,X=0,G=0,t.mode=COPY_,r===Z_TREES)break e;case COPY_:t.mode=COPY;case COPY:if(ce=t.length,ce){if(ce>T&&(ce=T),ce>ae&&(ce=ae),ce===0)break e;utils$e.arraySet(I,v,b,ce,N),T-=ce,b+=ce,ae-=ce,N+=ce,t.length-=ce;break}t.mode=TYPE;break;case TABLE:for(;G<14;){if(T===0)break e;T--,X+=v[b++]<<G,G+=8}if(t.nlen=(X&31)+257,X>>>=5,G-=5,t.ndist=(X&31)+1,X>>>=5,G-=5,t.ncode=(X&15)+4,X>>>=4,G-=4,t.nlen>286||t.ndist>30){e.msg="too many length or distance symbols",t.mode=BAD;break}t.have=0,t.mode=LENLENS;case LENLENS:for(;t.have<t.ncode;){for(;G<3;){if(T===0)break e;T--,X+=v[b++]<<G,G+=8}t.lens[De[t.have++]]=X&7,X>>>=3,G-=3}for(;t.have<19;)t.lens[De[t.have++]]=0;if(t.lencode=t.lendyn,t.lenbits=7,Be={bits:t.lenbits},Ce=inflate_table(CODES,t.lens,0,19,t.lencode,0,t.work,Be),t.lenbits=Be.bits,Ce){e.msg="invalid code lengths set",t.mode=BAD;break}t.have=0,t.mode=CODELENS;case CODELENS:for(;t.have<t.nlen+t.ndist;){for(;ye=t.lencode[X&(1<<t.lenbits)-1],be=ye>>>24,Te=ye>>>16&255,Ae=ye&65535,!(be<=G);){if(T===0)break e;T--,X+=v[b++]<<G,G+=8}if(Ae<16)X>>>=be,G-=be,t.lens[t.have++]=Ae;else{if(Ae===16){for(Ie=be+2;G<Ie;){if(T===0)break e;T--,X+=v[b++]<<G,G+=8}if(X>>>=be,G-=be,t.have===0){e.msg="invalid bit length repeat",t.mode=BAD;break}Ne=t.lens[t.have-1],ce=3+(X&3),X>>>=2,G-=2}else if(Ae===17){for(Ie=be+3;G<Ie;){if(T===0)break e;T--,X+=v[b++]<<G,G+=8}X>>>=be,G-=be,Ne=0,ce=3+(X&7),X>>>=3,G-=3}else{for(Ie=be+7;G<Ie;){if(T===0)break e;T--,X+=v[b++]<<G,G+=8}X>>>=be,G-=be,Ne=0,ce=11+(X&127),X>>>=7,G-=7}if(t.have+ce>t.nlen+t.ndist){e.msg="invalid bit length repeat",t.mode=BAD;break}for(;ce--;)t.lens[t.have++]=Ne}}if(t.mode===BAD)break;if(t.lens[256]===0){e.msg="invalid code -- missing end-of-block",t.mode=BAD;break}if(t.lenbits=9,Be={bits:t.lenbits},Ce=inflate_table(LENS,t.lens,0,t.nlen,t.lencode,0,t.work,Be),t.lenbits=Be.bits,Ce){e.msg="invalid literal/lengths set",t.mode=BAD;break}if(t.distbits=6,t.distcode=t.distdyn,Be={bits:t.distbits},Ce=inflate_table(DISTS,t.lens,t.nlen,t.ndist,t.distcode,0,t.work,Be),t.distbits=Be.bits,Ce){e.msg="invalid distances set",t.mode=BAD;break}if(t.mode=LEN_,r===Z_TREES)break e;case LEN_:t.mode=LEN;case LEN:if(T>=6&&ae>=258){e.next_out=N,e.avail_out=ae,e.next_in=b,e.avail_in=T,t.hold=X,t.bits=G,inflate_fast(e,fe),N=e.next_out,I=e.output,ae=e.avail_out,b=e.next_in,v=e.input,T=e.avail_in,X=t.hold,G=t.bits,t.mode===TYPE&&(t.back=-1);break}for(t.back=0;ye=t.lencode[X&(1<<t.lenbits)-1],be=ye>>>24,Te=ye>>>16&255,Ae=ye&65535,!(be<=G);){if(T===0)break e;T--,X+=v[b++]<<G,G+=8}if(Te&&(Te&240)===0){for(Se=be,$e=Te,ke=Ae;ye=t.lencode[ke+((X&(1<<Se+$e)-1)>>Se)],be=ye>>>24,Te=ye>>>16&255,Ae=ye&65535,!(Se+be<=G);){if(T===0)break e;T--,X+=v[b++]<<G,G+=8}X>>>=Se,G-=Se,t.back+=Se}if(X>>>=be,G-=be,t.back+=be,t.length=Ae,Te===0){t.mode=LIT;break}if(Te&32){t.back=-1,t.mode=TYPE;break}if(Te&64){e.msg="invalid literal/length code",t.mode=BAD;break}t.extra=Te&15,t.mode=LENEXT;case LENEXT:if(t.extra){for(Ie=t.extra;G<Ie;){if(T===0)break e;T--,X+=v[b++]<<G,G+=8}t.length+=X&(1<<t.extra)-1,X>>>=t.extra,G-=t.extra,t.back+=t.extra}t.was=t.length,t.mode=DIST;case DIST:for(;ye=t.distcode[X&(1<<t.distbits)-1],be=ye>>>24,Te=ye>>>16&255,Ae=ye&65535,!(be<=G);){if(T===0)break e;T--,X+=v[b++]<<G,G+=8}if((Te&240)===0){for(Se=be,$e=Te,ke=Ae;ye=t.distcode[ke+((X&(1<<Se+$e)-1)>>Se)],be=ye>>>24,Te=ye>>>16&255,Ae=ye&65535,!(Se+be<=G);){if(T===0)break e;T--,X+=v[b++]<<G,G+=8}X>>>=Se,G-=Se,t.back+=Se}if(X>>>=be,G-=be,t.back+=be,Te&64){e.msg="invalid distance code",t.mode=BAD;break}t.offset=Ae,t.extra=Te&15,t.mode=DISTEXT;case DISTEXT:if(t.extra){for(Ie=t.extra;G<Ie;){if(T===0)break e;T--,X+=v[b++]<<G,G+=8}t.offset+=X&(1<<t.extra)-1,X>>>=t.extra,G-=t.extra,t.back+=t.extra}if(t.offset>t.dmax){e.msg="invalid distance too far back",t.mode=BAD;break}t.mode=MATCH;case MATCH:if(ae===0)break e;if(ce=fe-ae,t.offset>ce){if(ce=t.offset-ce,ce>t.whave&&t.sane){e.msg="invalid distance too far back",t.mode=BAD;break}ce>t.wnext?(ce-=t.wnext,_e=t.wsize-ce):_e=t.wnext-ce,ce>t.length&&(ce=t.length),Ee=t.window}else Ee=I,_e=N-t.offset,ce=t.length;ce>ae&&(ce=ae),ae-=ce,t.length-=ce;do I[N++]=Ee[_e++];while(--ce);t.length===0&&(t.mode=LEN);break;case LIT:if(ae===0)break e;I[N++]=t.length,ae--,t.mode=LEN;break;case CHECK:if(t.wrap){for(;G<32;){if(T===0)break e;T--,X|=v[b++]<<G,G+=8}if(fe-=ae,e.total_out+=fe,t.total+=fe,fe&&(e.adler=t.check=t.flags?crc32$1(t.check,I,fe,N-fe):adler32(t.check,I,fe,N-fe)),fe=ae,(t.flags?X:zswap32(X))!==t.check){e.msg="incorrect data check",t.mode=BAD;break}X=0,G=0}t.mode=LENGTH;case LENGTH:if(t.wrap&&t.flags){for(;G<32;){if(T===0)break e;T--,X+=v[b++]<<G,G+=8}if(X!==(t.total&4294967295)){e.msg="incorrect length check",t.mode=BAD;break}X=0,G=0}t.mode=DONE;case DONE:Ce=Z_STREAM_END;break e;case BAD:Ce=Z_DATA_ERROR;break e;case MEM:return Z_MEM_ERROR;case SYNC:default:return Z_STREAM_ERROR}return e.next_out=N,e.avail_out=ae,e.next_in=b,e.avail_in=T,t.hold=X,t.bits=G,(t.wsize||fe!==e.avail_out&&t.mode<BAD&&(t.mode<CHECK||r!==Z_FINISH))&&updatewindow(e,e.output,e.next_out,fe-e.avail_out),ve-=e.avail_in,fe-=e.avail_out,e.total_in+=ve,e.total_out+=fe,t.total+=fe,t.wrap&&fe&&(e.adler=t.check=t.flags?crc32$1(t.check,I,fe,e.next_out-fe):adler32(t.check,I,fe,e.next_out-fe)),e.data_type=t.bits+(t.last?64:0)+(t.mode===TYPE?128:0)+(t.mode===LEN_||t.mode===COPY_?256:0),(ve===0&&fe===0||r===Z_FINISH)&&Ce===Z_OK&&(Ce=Z_BUF_ERROR),Ce}function inflateEnd(e){if(!e||!e.state)return Z_STREAM_ERROR;var r=e.state;return r.window&&(r.window=null),e.state=null,Z_OK}function inflateGetHeader(e,r){var t;return!e||!e.state||(t=e.state,(t.wrap&2)===0)?Z_STREAM_ERROR:(t.head=r,r.done=!1,Z_OK)}function inflateSetDictionary(e,r){var t=r.length,v,I,b;return!e||!e.state||(v=e.state,v.wrap!==0&&v.mode!==DICT)?Z_STREAM_ERROR:v.mode===DICT&&(I=1,I=adler32(I,r,t,0),I!==v.check)?Z_DATA_ERROR:(b=updatewindow(e,r,t,t),b?(v.mode=MEM,Z_MEM_ERROR):(v.havedict=1,Z_OK))}inflate$3.inflateReset=inflateReset,inflate$3.inflateReset2=inflateReset2,inflate$3.inflateResetKeep=inflateResetKeep,inflate$3.inflateInit=inflateInit,inflate$3.inflateInit2=inflateInit2,inflate$3.inflate=inflate$2,inflate$3.inflateEnd=inflateEnd,inflate$3.inflateGetHeader=inflateGetHeader,inflate$3.inflateSetDictionary=inflateSetDictionary,inflate$3.inflateInfo="pako inflate (from Nodeca project)";var constants$1={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};function GZheader$1(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var gzheader=GZheader$1,zlib_inflate=inflate$3,utils$d=common,strings=strings$2,c$3=constants$1,msg=messages,ZStream=zstream,GZheader=gzheader,toString=Object.prototype.toString;function Inflate(e){if(!(this instanceof Inflate))return new Inflate(e);this.options=utils$d.assign({chunkSize:16384,windowBits:0,to:""},e||{});var r=this.options;r.raw&&r.windowBits>=0&&r.windowBits<16&&(r.windowBits=-r.windowBits,r.windowBits===0&&(r.windowBits=-15)),r.windowBits>=0&&r.windowBits<16&&!(e&&e.windowBits)&&(r.windowBits+=32),r.windowBits>15&&r.windowBits<48&&(r.windowBits&15)===0&&(r.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new ZStream,this.strm.avail_out=0;var t=zlib_inflate.inflateInit2(this.strm,r.windowBits);if(t!==c$3.Z_OK)throw new Error(msg[t]);if(this.header=new GZheader,zlib_inflate.inflateGetHeader(this.strm,this.header),r.dictionary&&(typeof r.dictionary=="string"?r.dictionary=strings.string2buf(r.dictionary):toString.call(r.dictionary)==="[object ArrayBuffer]"&&(r.dictionary=new Uint8Array(r.dictionary)),r.raw&&(t=zlib_inflate.inflateSetDictionary(this.strm,r.dictionary),t!==c$3.Z_OK)))throw new Error(msg[t])}Inflate.prototype.push=function(e,r){var t=this.strm,v=this.options.chunkSize,I=this.options.dictionary,b,N,T,ae,X,G=!1;if(this.ended)return!1;N=r===~~r?r:r===!0?c$3.Z_FINISH:c$3.Z_NO_FLUSH,typeof e=="string"?t.input=strings.binstring2buf(e):toString.call(e)==="[object ArrayBuffer]"?t.input=new Uint8Array(e):t.input=e,t.next_in=0,t.avail_in=t.input.length;do{if(t.avail_out===0&&(t.output=new utils$d.Buf8(v),t.next_out=0,t.avail_out=v),b=zlib_inflate.inflate(t,c$3.Z_NO_FLUSH),b===c$3.Z_NEED_DICT&&I&&(b=zlib_inflate.inflateSetDictionary(this.strm,I)),b===c$3.Z_BUF_ERROR&&G===!0&&(b=c$3.Z_OK,G=!1),b!==c$3.Z_STREAM_END&&b!==c$3.Z_OK)return this.onEnd(b),this.ended=!0,!1;t.next_out&&(t.avail_out===0||b===c$3.Z_STREAM_END||t.avail_in===0&&(N===c$3.Z_FINISH||N===c$3.Z_SYNC_FLUSH))&&(this.options.to==="string"?(T=strings.utf8border(t.output,t.next_out),ae=t.next_out-T,X=strings.buf2string(t.output,T),t.next_out=ae,t.avail_out=v-ae,ae&&utils$d.arraySet(t.output,t.output,T,ae,0),this.onData(X)):this.onData(utils$d.shrinkBuf(t.output,t.next_out))),t.avail_in===0&&t.avail_out===0&&(G=!0)}while((t.avail_in>0||t.avail_out===0)&&b!==c$3.Z_STREAM_END);return b===c$3.Z_STREAM_END&&(N=c$3.Z_FINISH),N===c$3.Z_FINISH?(b=zlib_inflate.inflateEnd(this.strm),this.onEnd(b),this.ended=!0,b===c$3.Z_OK):(N===c$3.Z_SYNC_FLUSH&&(this.onEnd(c$3.Z_OK),t.avail_out=0),!0)},Inflate.prototype.onData=function(e){this.chunks.push(e)},Inflate.prototype.onEnd=function(e){e===c$3.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=utils$d.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function inflate$1(e,r){var t=new Inflate(r);if(t.push(e,!0),t.err)throw t.msg||msg[t.err];return t.result}function inflateRaw(e,r){return r=r||{},r.raw=!0,inflate$1(e,r)}inflate$4.Inflate=Inflate,inflate$4.inflate=inflate$1,inflate$4.inflateRaw=inflateRaw,inflate$4.ungzip=inflate$1;var assign=common.assign,deflate=deflate$4,inflate=inflate$4,constants=constants$1,pako$1={};assign(pako$1,deflate,inflate,constants);var pako_1=pako$1,USE_TYPEDARRAY=typeof Uint8Array!="undefined"&&typeof Uint16Array!="undefined"&&typeof Uint32Array!="undefined",pako=pako_1,utils$c=utils$r,GenericWorker$4=GenericWorker_1,ARRAY_TYPE=USE_TYPEDARRAY?"uint8array":"array";flate.magic="\b\0";function FlateWorker(e,r){GenericWorker$4.call(this,"FlateWorker/"+e),this._pako=null,this._pakoAction=e,this._pakoOptions=r,this.meta={}}utils$c.inherits(FlateWorker,GenericWorker$4),FlateWorker.prototype.processChunk=function(e){this.meta=e.meta,this._pako===null&&this._createPako(),this._pako.push(utils$c.transformTo(ARRAY_TYPE,e.data),!1)},FlateWorker.prototype.flush=function(){GenericWorker$4.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},FlateWorker.prototype.cleanUp=function(){GenericWorker$4.prototype.cleanUp.call(this),this._pako=null},FlateWorker.prototype._createPako=function(){this._pako=new pako[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var e=this;this._pako.onData=function(r){e.push({data:r,meta:e.meta})}},flate.compressWorker=function(e){return new FlateWorker("Deflate",e)},flate.uncompressWorker=function(){return new FlateWorker("Inflate",{})};var GenericWorker$3=GenericWorker_1;compressions$2.STORE={magic:"\0\0",compressWorker:function(){return new GenericWorker$3("STORE compression")},uncompressWorker:function(){return new GenericWorker$3("STORE decompression")}},compressions$2.DEFLATE=flate;var signature$1={};signature$1.LOCAL_FILE_HEADER="PK",signature$1.CENTRAL_FILE_HEADER="PK",signature$1.CENTRAL_DIRECTORY_END="PK",signature$1.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",signature$1.ZIP64_CENTRAL_DIRECTORY_END="PK",signature$1.DATA_DESCRIPTOR="PK\x07\b";var utils$b=utils$r,GenericWorker$2=GenericWorker_1,utf8$3=utf8$5,crc32=crc32_1$1,signature=signature$1,decToHex=function(e,r){var t="",v;for(v=0;v<r;v++)t+=String.fromCharCode(e&255),e=e>>>8;return t},generateUnixExternalFileAttr=function(e,r){var t=e;return e||(t=r?16893:33204),(t&65535)<<16},generateDosExternalFileAttr=function(e){return(e||0)&63},generateZipParts=function(e,r,t,v,I,b){var N=e.file,T=e.compression,ae=b!==utf8$3.utf8encode,X=utils$b.transformTo("string",b(N.name)),G=utils$b.transformTo("string",utf8$3.utf8encode(N.name)),ve=N.comment,fe=utils$b.transformTo("string",b(ve)),ce=utils$b.transformTo("string",utf8$3.utf8encode(ve)),_e=G.length!==N.name.length,Ee=ce.length!==ve.length,ye,be,Te="",Ae="",Se="",$e=N.dir,ke=N.date,Ne={crc32:0,compressedSize:0,uncompressedSize:0};(!r||t)&&(Ne.crc32=e.crc32,Ne.compressedSize=e.compressedSize,Ne.uncompressedSize=e.uncompressedSize);var Ce=0;r&&(Ce|=8),!ae&&(_e||Ee)&&(Ce|=2048);var he=0,Be=0;$e&&(he|=16),I==="UNIX"?(Be=798,he|=generateUnixExternalFileAttr(N.unixPermissions,$e)):(Be=20,he|=generateDosExternalFileAttr(N.dosPermissions)),ye=ke.getUTCHours(),ye=ye<<6,ye=ye|ke.getUTCMinutes(),ye=ye<<5,ye=ye|ke.getUTCSeconds()/2,be=ke.getUTCFullYear()-1980,be=be<<4,be=be|ke.getUTCMonth()+1,be=be<<5,be=be|ke.getUTCDate(),_e&&(Ae=decToHex(1,1)+decToHex(crc32(X),4)+G,Te+="up"+decToHex(Ae.length,2)+Ae),Ee&&(Se=decToHex(1,1)+decToHex(crc32(fe),4)+ce,Te+="uc"+decToHex(Se.length,2)+Se);var Ie="";Ie+=`
\0`,Ie+=decToHex(Ce,2),Ie+=T.magic,Ie+=decToHex(ye,2),Ie+=decToHex(be,2),Ie+=decToHex(Ne.crc32,4),Ie+=decToHex(Ne.compressedSize,4),Ie+=decToHex(Ne.uncompressedSize,4),Ie+=decToHex(X.length,2),Ie+=decToHex(Te.length,2);var De=signature.LOCAL_FILE_HEADER+Ie+X+Te,We=signature.CENTRAL_FILE_HEADER+decToHex(Be,2)+Ie+decToHex(fe.length,2)+"\0\0\0\0"+decToHex(he,4)+decToHex(v,4)+X+Te+fe;return{fileRecord:De,dirRecord:We}},generateCentralDirectoryEnd=function(e,r,t,v,I){var b="",N=utils$b.transformTo("string",I(v));return b=signature.CENTRAL_DIRECTORY_END+"\0\0\0\0"+decToHex(e,2)+decToHex(e,2)+decToHex(r,4)+decToHex(t,4)+decToHex(N.length,2)+N,b},generateDataDescriptors=function(e){var r="";return r=signature.DATA_DESCRIPTOR+decToHex(e.crc32,4)+decToHex(e.compressedSize,4)+decToHex(e.uncompressedSize,4),r};function ZipFileWorker$1(e,r,t,v){GenericWorker$2.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=r,this.zipPlatform=t,this.encodeFileName=v,this.streamFiles=e,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}utils$b.inherits(ZipFileWorker$1,GenericWorker$2),ZipFileWorker$1.prototype.push=function(e){var r=e.meta.percent||0,t=this.entriesCount,v=this._sources.length;this.accumulate?this.contentBuffer.push(e):(this.bytesWritten+=e.data.length,GenericWorker$2.prototype.push.call(this,{data:e.data,meta:{currentFile:this.currentFile,percent:t?(r+100*(t-v-1))/t:100}}))},ZipFileWorker$1.prototype.openedSource=function(e){this.currentSourceOffset=this.bytesWritten,this.currentFile=e.file.name;var r=this.streamFiles&&!e.file.dir;if(r){var t=generateZipParts(e,r,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:t.fileRecord,meta:{percent:0}})}else this.accumulate=!0},ZipFileWorker$1.prototype.closedSource=function(e){this.accumulate=!1;var r=this.streamFiles&&!e.file.dir,t=generateZipParts(e,r,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(t.dirRecord),r)this.push({data:generateDataDescriptors(e),meta:{percent:100}});else for(this.push({data:t.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},ZipFileWorker$1.prototype.flush=function(){for(var e=this.bytesWritten,r=0;r<this.dirRecords.length;r++)this.push({data:this.dirRecords[r],meta:{percent:100}});var t=this.bytesWritten-e,v=generateCentralDirectoryEnd(this.dirRecords.length,t,e,this.zipComment,this.encodeFileName);this.push({data:v,meta:{percent:100}})},ZipFileWorker$1.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},ZipFileWorker$1.prototype.registerPrevious=function(e){this._sources.push(e);var r=this;return e.on("data",function(t){r.processChunk(t)}),e.on("end",function(){r.closedSource(r.previous.streamInfo),r._sources.length?r.prepareNextSource():r.end()}),e.on("error",function(t){r.error(t)}),this},ZipFileWorker$1.prototype.resume=function(){if(!GenericWorker$2.prototype.resume.call(this))return!1;if(!this.previous&&this._sources.length)return this.prepareNextSource(),!0;if(!this.previous&&!this._sources.length&&!this.generatedError)return this.end(),!0},ZipFileWorker$1.prototype.error=function(e){var r=this._sources;if(!GenericWorker$2.prototype.error.call(this,e))return!1;for(var t=0;t<r.length;t++)try{r[t].error(e)}catch(v){}return!0},ZipFileWorker$1.prototype.lock=function(){GenericWorker$2.prototype.lock.call(this);for(var e=this._sources,r=0;r<e.length;r++)e[r].lock()};var ZipFileWorker_1=ZipFileWorker$1,compressions$1=compressions$2,ZipFileWorker=ZipFileWorker_1,getCompression=function(e,r){var t=e||r,v=compressions$1[t];if(!v)throw new Error(t+" is not a valid compression method !");return v};generate$1.generateWorker=function(e,r,t){var v=new ZipFileWorker(r.streamFiles,t,r.platform,r.encodeFileName),I=0;try{e.forEach(function(b,N){I++;var T=getCompression(N.options.compression,r.compression),ae=N.options.compressionOptions||r.compressionOptions||{},X=N.dir,G=N.date;N._compressWorker(T,ae).withStreamInfo("file",{name:b,dir:X,date:G,comment:N.comment||"",unixPermissions:N.unixPermissions,dosPermissions:N.dosPermissions}).pipe(v)}),v.entriesCount=I}catch(b){v.error(b)}return v};var utils$a=utils$r,GenericWorker$1=GenericWorker_1;function NodejsStreamInputAdapter$1(e,r){GenericWorker$1.call(this,"Nodejs stream input adapter for "+e),this._upstreamEnded=!1,this._bindStream(r)}utils$a.inherits(NodejsStreamInputAdapter$1,GenericWorker$1),NodejsStreamInputAdapter$1.prototype._bindStream=function(e){var r=this;this._stream=e,e.pause(),e.on("data",function(t){r.push({data:t,meta:{percent:0}})}).on("error",function(t){r.isPaused?this.generatedError=t:r.error(t)}).on("end",function(){r.isPaused?r._upstreamEnded=!0:r.end()})},NodejsStreamInputAdapter$1.prototype.pause=function(){return GenericWorker$1.prototype.pause.call(this)?(this._stream.pause(),!0):!1},NodejsStreamInputAdapter$1.prototype.resume=function(){return GenericWorker$1.prototype.resume.call(this)?(this._upstreamEnded?this.end():this._stream.resume(),!0):!1};var NodejsStreamInputAdapter_1=NodejsStreamInputAdapter$1,utf8$2=utf8$5,utils$9=utils$r,GenericWorker=GenericWorker_1,StreamHelper=StreamHelper_1,defaults=defaults$1,CompressedObject$1=compressedObject,ZipObject=zipObject,generate=generate$1,nodejsUtils$1=nodejsUtils$2,NodejsStreamInputAdapter=NodejsStreamInputAdapter_1,fileAdd=function(e,r,t){var v=utils$9.getTypeOf(r),I,b=utils$9.extend(t||{},defaults);b.date=b.date||new Date,b.compression!==null&&(b.compression=b.compression.toUpperCase()),typeof b.unixPermissions=="string"&&(b.unixPermissions=parseInt(b.unixPermissions,8)),b.unixPermissions&&b.unixPermissions&16384&&(b.dir=!0),b.dosPermissions&&b.dosPermissions&16&&(b.dir=!0),b.dir&&(e=forceTrailingSlash(e)),b.createFolders&&(I=parentFolder(e))&&folderAdd.call(this,I,!0);var N=v==="string"&&b.binary===!1&&b.base64===!1;(!t||typeof t.binary=="undefined")&&(b.binary=!N);var T=r instanceof CompressedObject$1&&r.uncompressedSize===0;(T||b.dir||!r||r.length===0)&&(b.base64=!1,b.binary=!0,r="",b.compression="STORE",v="string");var ae=null;r instanceof CompressedObject$1||r instanceof GenericWorker?ae=r:nodejsUtils$1.isNode&&nodejsUtils$1.isStream(r)?ae=new NodejsStreamInputAdapter(e,r):ae=utils$9.prepareContent(e,r,b.binary,b.optimizedBinaryString,b.base64);var X=new ZipObject(e,ae,b);this.files[e]=X},parentFolder=function(e){e.slice(-1)==="/"&&(e=e.substring(0,e.length-1));var r=e.lastIndexOf("/");return r>0?e.substring(0,r):""},forceTrailingSlash=function(e){return e.slice(-1)!=="/"&&(e+="/"),e},folderAdd=function(e,r){return r=typeof r!="undefined"?r:defaults.createFolders,e=forceTrailingSlash(e),this.files[e]||fileAdd.call(this,e,null,{dir:!0,createFolders:r}),this.files[e]};function isRegExp(e){return Object.prototype.toString.call(e)==="[object RegExp]"}var out={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(e){var r,t,v;for(r in this.files)v=this.files[r],t=r.slice(this.root.length,r.length),t&&r.slice(0,this.root.length)===this.root&&e(t,v)},filter:function(e){var r=[];return this.forEach(function(t,v){e(t,v)&&r.push(v)}),r},file:function(e,r,t){if(arguments.length===1)if(isRegExp(e)){var v=e;return this.filter(function(b,N){return!N.dir&&v.test(b)})}else{var I=this.files[this.root+e];return I&&!I.dir?I:null}else e=this.root+e,fileAdd.call(this,e,r,t);return this},folder:function(e){if(!e)return this;if(isRegExp(e))return this.filter(function(I,b){return b.dir&&e.test(I)});var r=this.root+e,t=folderAdd.call(this,r),v=this.clone();return v.root=t.name,v},remove:function(e){e=this.root+e;var r=this.files[e];if(r||(e.slice(-1)!=="/"&&(e+="/"),r=this.files[e]),r&&!r.dir)delete this.files[e];else for(var t=this.filter(function(I,b){return b.name.slice(0,e.length)===e}),v=0;v<t.length;v++)delete this.files[t[v].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(e){var r,t={};try{if(t=utils$9.extend(e||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:utf8$2.utf8encode}),t.type=t.type.toLowerCase(),t.compression=t.compression.toUpperCase(),t.type==="binarystring"&&(t.type="string"),!t.type)throw new Error("No output type specified.");utils$9.checkSupport(t.type),(t.platform==="darwin"||t.platform==="freebsd"||t.platform==="linux"||t.platform==="sunos")&&(t.platform="UNIX"),t.platform==="win32"&&(t.platform="DOS");var v=t.comment||this.comment||"";r=generate.generateWorker(this,t,v)}catch(I){r=new GenericWorker("error"),r.error(I)}return new StreamHelper(r,t.type||"string",t.mimeType)},generateAsync:function(e,r){return this.generateInternalStream(e).accumulate(r)},generateNodeStream:function(e,r){return e=e||{},e.type||(e.type="nodebuffer"),this.generateInternalStream(e).toNodejsStream(r)}},object=out,utils$8=utils$r;function DataReader$2(e){this.data=e,this.length=e.length,this.index=0,this.zero=0}DataReader$2.prototype={checkOffset:function(e){this.checkIndex(this.index+e)},checkIndex:function(e){if(this.length<this.zero+e||e<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+e+"). Corrupted zip ?")},setIndex:function(e){this.checkIndex(e),this.index=e},skip:function(e){this.setIndex(this.index+e)},byteAt:function(){},readInt:function(e){var r=0,t;for(this.checkOffset(e),t=this.index+e-1;t>=this.index;t--)r=(r<<8)+this.byteAt(t);return this.index+=e,r},readString:function(e){return utils$8.transformTo("string",this.readData(e))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var e=this.readInt(4);return new Date(Date.UTC((e>>25&127)+1980,(e>>21&15)-1,e>>16&31,e>>11&31,e>>5&63,(e&31)<<1))}};var DataReader_1=DataReader$2,DataReader$1=DataReader_1,utils$7=utils$r;function ArrayReader$2(e){DataReader$1.call(this,e);for(var r=0;r<this.data.length;r++)e[r]=e[r]&255}utils$7.inherits(ArrayReader$2,DataReader$1),ArrayReader$2.prototype.byteAt=function(e){return this.data[this.zero+e]},ArrayReader$2.prototype.lastIndexOfSignature=function(e){for(var r=e.charCodeAt(0),t=e.charCodeAt(1),v=e.charCodeAt(2),I=e.charCodeAt(3),b=this.length-4;b>=0;--b)if(this.data[b]===r&&this.data[b+1]===t&&this.data[b+2]===v&&this.data[b+3]===I)return b-this.zero;return-1},ArrayReader$2.prototype.readAndCheckSignature=function(e){var r=e.charCodeAt(0),t=e.charCodeAt(1),v=e.charCodeAt(2),I=e.charCodeAt(3),b=this.readData(4);return r===b[0]&&t===b[1]&&v===b[2]&&I===b[3]},ArrayReader$2.prototype.readData=function(e){if(this.checkOffset(e),e===0)return[];var r=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,r};var ArrayReader_1=ArrayReader$2,DataReader=DataReader_1,utils$6=utils$r;function StringReader$1(e){DataReader.call(this,e)}utils$6.inherits(StringReader$1,DataReader),StringReader$1.prototype.byteAt=function(e){return this.data.charCodeAt(this.zero+e)},StringReader$1.prototype.lastIndexOfSignature=function(e){return this.data.lastIndexOf(e)-this.zero},StringReader$1.prototype.readAndCheckSignature=function(e){var r=this.readData(4);return e===r},StringReader$1.prototype.readData=function(e){this.checkOffset(e);var r=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,r};var StringReader_1=StringReader$1,ArrayReader$1=ArrayReader_1,utils$5=utils$r;function Uint8ArrayReader$2(e){ArrayReader$1.call(this,e)}utils$5.inherits(Uint8ArrayReader$2,ArrayReader$1),Uint8ArrayReader$2.prototype.readData=function(e){if(this.checkOffset(e),e===0)return new Uint8Array(0);var r=this.data.subarray(this.zero+this.index,this.zero+this.index+e);return this.index+=e,r};var Uint8ArrayReader_1=Uint8ArrayReader$2,Uint8ArrayReader$1=Uint8ArrayReader_1,utils$4=utils$r;function NodeBufferReader$1(e){Uint8ArrayReader$1.call(this,e)}utils$4.inherits(NodeBufferReader$1,Uint8ArrayReader$1),NodeBufferReader$1.prototype.readData=function(e){this.checkOffset(e);var r=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,r};var NodeBufferReader_1=NodeBufferReader$1,utils$3=utils$r,support$2=support$5,ArrayReader=ArrayReader_1,StringReader=StringReader_1,NodeBufferReader=NodeBufferReader_1,Uint8ArrayReader=Uint8ArrayReader_1,readerFor$2=function(e){var r=utils$3.getTypeOf(e);return utils$3.checkSupport(r),r==="string"&&!support$2.uint8array?new StringReader(e):r==="nodebuffer"?new NodeBufferReader(e):support$2.uint8array?new Uint8ArrayReader(utils$3.transformTo("uint8array",e)):new ArrayReader(utils$3.transformTo("array",e))},readerFor$1=readerFor$2,utils$2=utils$r,CompressedObject=compressedObject,crc32fn=crc32_1$1,utf8$1=utf8$5,compressions=compressions$2,support$1=support$5,MADE_BY_DOS=0,MADE_BY_UNIX=3,findCompression=function(e){for(var r in compressions)if(!!Object.prototype.hasOwnProperty.call(compressions,r)&&compressions[r].magic===e)return compressions[r];return null};function ZipEntry$1(e,r){this.options=e,this.loadOptions=r}ZipEntry$1.prototype={isEncrypted:function(){return(this.bitFlag&1)===1},useUTF8:function(){return(this.bitFlag&2048)===2048},readLocalPart:function(e){var r,t;if(e.skip(22),this.fileNameLength=e.readInt(2),t=e.readInt(2),this.fileName=e.readData(this.fileNameLength),e.skip(t),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(r=findCompression(this.compressionMethod),r===null)throw new Error("Corrupted zip : compression "+utils$2.pretty(this.compressionMethod)+" unknown (inner file : "+utils$2.transformTo("string",this.fileName)+")");this.decompressed=new CompressedObject(this.compressedSize,this.uncompressedSize,this.crc32,r,e.readData(this.compressedSize))},readCentralPart:function(e){this.versionMadeBy=e.readInt(2),e.skip(2),this.bitFlag=e.readInt(2),this.compressionMethod=e.readString(2),this.date=e.readDate(),this.crc32=e.readInt(4),this.compressedSize=e.readInt(4),this.uncompressedSize=e.readInt(4);var r=e.readInt(2);if(this.extraFieldsLength=e.readInt(2),this.fileCommentLength=e.readInt(2),this.diskNumberStart=e.readInt(2),this.internalFileAttributes=e.readInt(2),this.externalFileAttributes=e.readInt(4),this.localHeaderOffset=e.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");e.skip(r),this.readExtraFields(e),this.parseZIP64ExtraField(e),this.fileComment=e.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var e=this.versionMadeBy>>8;this.dir=!!(this.externalFileAttributes&16),e===MADE_BY_DOS&&(this.dosPermissions=this.externalFileAttributes&63),e===MADE_BY_UNIX&&(this.unixPermissions=this.externalFileAttributes>>16&65535),!this.dir&&this.fileNameStr.slice(-1)==="/"&&(this.dir=!0)},parseZIP64ExtraField:function(){if(!!this.extraFields[1]){var e=readerFor$1(this.extraFields[1].value);this.uncompressedSize===utils$2.MAX_VALUE_32BITS&&(this.uncompressedSize=e.readInt(8)),this.compressedSize===utils$2.MAX_VALUE_32BITS&&(this.compressedSize=e.readInt(8)),this.localHeaderOffset===utils$2.MAX_VALUE_32BITS&&(this.localHeaderOffset=e.readInt(8)),this.diskNumberStart===utils$2.MAX_VALUE_32BITS&&(this.diskNumberStart=e.readInt(4))}},readExtraFields:function(e){var r=e.index+this.extraFieldsLength,t,v,I;for(this.extraFields||(this.extraFields={});e.index+4<r;)t=e.readInt(2),v=e.readInt(2),I=e.readData(v),this.extraFields[t]={id:t,length:v,value:I};e.setIndex(r)},handleUTF8:function(){var e=support$1.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=utf8$1.utf8decode(this.fileName),this.fileCommentStr=utf8$1.utf8decode(this.fileComment);else{var r=this.findExtraFieldUnicodePath();if(r!==null)this.fileNameStr=r;else{var t=utils$2.transformTo(e,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(t)}var v=this.findExtraFieldUnicodeComment();if(v!==null)this.fileCommentStr=v;else{var I=utils$2.transformTo(e,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(I)}}},findExtraFieldUnicodePath:function(){var e=this.extraFields[28789];if(e){var r=readerFor$1(e.value);return r.readInt(1)!==1||crc32fn(this.fileName)!==r.readInt(4)?null:utf8$1.utf8decode(r.readData(e.length-5))}return null},findExtraFieldUnicodeComment:function(){var e=this.extraFields[25461];if(e){var r=readerFor$1(e.value);return r.readInt(1)!==1||crc32fn(this.fileComment)!==r.readInt(4)?null:utf8$1.utf8decode(r.readData(e.length-5))}return null}};var zipEntry=ZipEntry$1,readerFor=readerFor$2,utils$1=utils$r,sig=signature$1,ZipEntry=zipEntry,support=support$5;function ZipEntries$1(e){this.files=[],this.loadOptions=e}ZipEntries$1.prototype={checkSignature:function(e){if(!this.reader.readAndCheckSignature(e)){this.reader.index-=4;var r=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+utils$1.pretty(r)+", expected "+utils$1.pretty(e)+")")}},isSignature:function(e,r){var t=this.reader.index;this.reader.setIndex(e);var v=this.reader.readString(4),I=v===r;return this.reader.setIndex(t),I},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var e=this.reader.readData(this.zipCommentLength),r=support.uint8array?"uint8array":"array",t=utils$1.transformTo(r,e);this.zipComment=this.loadOptions.decodeFileName(t)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var e=this.zip64EndOfCentralSize-44,r=0,t,v,I;r<e;)t=this.reader.readInt(2),v=this.reader.readInt(4),I=this.reader.readData(v),this.zip64ExtensibleData[t]={id:t,length:v,value:I}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),this.disksCount>1)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var e,r;for(e=0;e<this.files.length;e++)r=this.files[e],this.reader.setIndex(r.localHeaderOffset),this.checkSignature(sig.LOCAL_FILE_HEADER),r.readLocalPart(this.reader),r.handleUTF8(),r.processAttributes()},readCentralDir:function(){var e;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(sig.CENTRAL_FILE_HEADER);)e=new ZipEntry({zip64:this.zip64},this.loadOptions),e.readCentralPart(this.reader),this.files.push(e);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var e=this.reader.lastIndexOfSignature(sig.CENTRAL_DIRECTORY_END);if(e<0){var r=!this.isSignature(0,sig.LOCAL_FILE_HEADER);throw r?new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html"):new Error("Corrupted zip: can't find end of central directory")}this.reader.setIndex(e);var t=e;if(this.checkSignature(sig.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===utils$1.MAX_VALUE_16BITS||this.diskWithCentralDirStart===utils$1.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===utils$1.MAX_VALUE_16BITS||this.centralDirRecords===utils$1.MAX_VALUE_16BITS||this.centralDirSize===utils$1.MAX_VALUE_32BITS||this.centralDirOffset===utils$1.MAX_VALUE_32BITS){if(this.zip64=!0,e=this.reader.lastIndexOfSignature(sig.ZIP64_CENTRAL_DIRECTORY_LOCATOR),e<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(e),this.checkSignature(sig.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,sig.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(sig.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(sig.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var v=this.centralDirOffset+this.centralDirSize;this.zip64&&(v+=20,v+=12+this.zip64EndOfCentralSize);var I=t-v;if(I>0)this.isSignature(t,sig.CENTRAL_FILE_HEADER)||(this.reader.zero=I);else if(I<0)throw new Error("Corrupted zip: missing "+Math.abs(I)+" bytes.")},prepareReader:function(e){this.reader=readerFor(e)},load:function(e){this.prepareReader(e),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}};var zipEntries=ZipEntries$1,utils=utils$r,external=external$3,utf8=utf8$5,ZipEntries=zipEntries,Crc32Probe=Crc32Probe_1,nodejsUtils=nodejsUtils$2;function checkEntryCRC32(e){return new external.Promise(function(r,t){var v=e.decompressed.getContentWorker().pipe(new Crc32Probe);v.on("error",function(I){t(I)}).on("end",function(){v.streamInfo.crc32!==e.decompressed.crc32?t(new Error("Corrupted zip : CRC32 mismatch")):r()}).resume()})}var load=function(e,r){var t=this;return r=utils.extend(r||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:utf8.utf8decode}),nodejsUtils.isNode&&nodejsUtils.isStream(e)?external.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):utils.prepareContent("the loaded zip file",e,!0,r.optimizedBinaryString,r.base64).then(function(v){var I=new ZipEntries(r);return I.load(v),I}).then(function(I){var b=[external.Promise.resolve(I)],N=I.files;if(r.checkCRC32)for(var T=0;T<N.length;T++)b.push(checkEntryCRC32(N[T]));return external.Promise.all(b)}).then(function(I){for(var b=I.shift(),N=b.files,T=0;T<N.length;T++){var ae=N[T],X=ae.fileNameStr,G=utils.resolve(ae.fileNameStr);t.file(G,ae.decompressed,{binary:!0,optimizedBinaryString:!0,date:ae.date,dir:ae.dir,comment:ae.fileCommentStr.length?ae.fileCommentStr:null,unixPermissions:ae.unixPermissions,dosPermissions:ae.dosPermissions,createFolders:r.createFolders}),ae.dir||(t.file(G).unsafeOriginalName=X)}return b.zipComment.length&&(t.comment=b.zipComment),t})};function JSZip(){if(!(this instanceof JSZip))return new JSZip;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var e=new JSZip;for(var r in this)typeof this[r]!="function"&&(e[r]=this[r]);return e}}JSZip.prototype=object,JSZip.prototype.loadAsync=load,JSZip.support=support$5,JSZip.defaults=defaults$1,JSZip.version="3.10.1",JSZip.loadAsync=function(e,r){return new JSZip().loadAsync(e,r)},JSZip.external=external$3;var lib=JSZip;const n=e=>lib.loadAsync(e),s$1=(e,r)=>{const t=e.file(r);return t?t.async("text"):null},p$3=(e,r,t)=>e.file(r,t),o=(e,r,t)=>e.file(r,t,{binary:!0}),a$2=(e,r,t)=>e.file(r,t,{base64:!0}),c$2=e=>e.generateAsync({type:"uint8array",compression:"DEFLATE",compressionOptions:{level:1}});var sax={},string_decoder={},safeBuffer={exports:{}};/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */(function(e,r){var t=buffer$1,v=t.Buffer;function I(N,T){for(var ae in N)T[ae]=N[ae]}v.from&&v.alloc&&v.allocUnsafe&&v.allocUnsafeSlow?e.exports=t:(I(t,r),r.Buffer=b);function b(N,T,ae){return v(N,T,ae)}b.prototype=Object.create(v.prototype),I(v,b),b.from=function(N,T,ae){if(typeof N=="number")throw new TypeError("Argument must not be a number");return v(N,T,ae)},b.alloc=function(N,T,ae){if(typeof N!="number")throw new TypeError("Argument must be a number");var X=v(N);return T!==void 0?typeof ae=="string"?X.fill(T,ae):X.fill(T):X.fill(0),X},b.allocUnsafe=function(N){if(typeof N!="number")throw new TypeError("Argument must be a number");return v(N)},b.allocUnsafeSlow=function(N){if(typeof N!="number")throw new TypeError("Argument must be a number");return t.SlowBuffer(N)}})(safeBuffer,safeBuffer.exports);var Buffer$1=safeBuffer.exports.Buffer,isEncoding=Buffer$1.isEncoding||function(e){switch(e=""+e,e&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function _normalizeEncoding(e){if(!e)return"utf8";for(var r;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(r)return;e=(""+e).toLowerCase(),r=!0}}function normalizeEncoding(e){var r=_normalizeEncoding(e);if(typeof r!="string"&&(Buffer$1.isEncoding===isEncoding||!isEncoding(e)))throw new Error("Unknown encoding: "+e);return r||e}string_decoder.StringDecoder=StringDecoder;function StringDecoder(e){this.encoding=normalizeEncoding(e);var r;switch(this.encoding){case"utf16le":this.text=utf16Text,this.end=utf16End,r=4;break;case"utf8":this.fillLast=utf8FillLast,r=4;break;case"base64":this.text=base64Text,this.end=base64End,r=3;break;default:this.write=simpleWrite,this.end=simpleEnd;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=Buffer$1.allocUnsafe(r)}StringDecoder.prototype.write=function(e){if(e.length===0)return"";var r,t;if(this.lastNeed){if(r=this.fillLast(e),r===void 0)return"";t=this.lastNeed,this.lastNeed=0}else t=0;return t<e.length?r?r+this.text(e,t):this.text(e,t):r||""},StringDecoder.prototype.end=utf8End,StringDecoder.prototype.text=utf8Text,StringDecoder.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length};function utf8CheckByte(e){return e<=127?0:e>>5===6?2:e>>4===14?3:e>>3===30?4:e>>6===2?-1:-2}function utf8CheckIncomplete(e,r,t){var v=r.length-1;if(v<t)return 0;var I=utf8CheckByte(r[v]);return I>=0?(I>0&&(e.lastNeed=I-1),I):--v<t||I===-2?0:(I=utf8CheckByte(r[v]),I>=0?(I>0&&(e.lastNeed=I-2),I):--v<t||I===-2?0:(I=utf8CheckByte(r[v]),I>=0?(I>0&&(I===2?I=0:e.lastNeed=I-3),I):0))}function utf8CheckExtraBytes(e,r,t){if((r[0]&192)!==128)return e.lastNeed=0,"\uFFFD";if(e.lastNeed>1&&r.length>1){if((r[1]&192)!==128)return e.lastNeed=1,"\uFFFD";if(e.lastNeed>2&&r.length>2&&(r[2]&192)!==128)return e.lastNeed=2,"\uFFFD"}}function utf8FillLast(e){var r=this.lastTotal-this.lastNeed,t=utf8CheckExtraBytes(this,e);if(t!==void 0)return t;if(this.lastNeed<=e.length)return e.copy(this.lastChar,r,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,r,0,e.length),this.lastNeed-=e.length}function utf8Text(e,r){var t=utf8CheckIncomplete(this,e,r);if(!this.lastNeed)return e.toString("utf8",r);this.lastTotal=t;var v=e.length-(t-this.lastNeed);return e.copy(this.lastChar,0,v),e.toString("utf8",r,v)}function utf8End(e){var r=e&&e.length?this.write(e):"";return this.lastNeed?r+"\uFFFD":r}function utf16Text(e,r){if((e.length-r)%2===0){var t=e.toString("utf16le",r);if(t){var v=t.charCodeAt(t.length-1);if(v>=55296&&v<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],t.slice(0,-1)}return t}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",r,e.length-1)}function utf16End(e){var r=e&&e.length?this.write(e):"";if(this.lastNeed){var t=this.lastTotal-this.lastNeed;return r+this.lastChar.toString("utf16le",0,t)}return r}function base64Text(e,r){var t=(e.length-r)%3;return t===0?e.toString("base64",r):(this.lastNeed=3-t,this.lastTotal=3,t===1?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",r,e.length-t))}function base64End(e){var r=e&&e.length?this.write(e):"";return this.lastNeed?r+this.lastChar.toString("base64",0,3-this.lastNeed):r}function simpleWrite(e){return e.toString(this.encoding)}function simpleEnd(e){return e&&e.length?this.write(e):""}(function(e){(function(r){r.parser=function(Q,j){return new v(Q,j)},r.SAXParser=v,r.SAXStream=G,r.createStream=X,r.MAX_BUFFER_LENGTH=64*1024;var t=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];r.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"];function v(Q,j){if(!(this instanceof v))return new v(Q,j);var xe=this;b(xe),xe.q=xe.c="",xe.bufferCheckPosition=r.MAX_BUFFER_LENGTH,xe.opt=j||{},xe.opt.lowercase=xe.opt.lowercase||xe.opt.lowercasetags,xe.looseCase=xe.opt.lowercase?"toLowerCase":"toUpperCase",xe.tags=[],xe.closed=xe.closedRoot=xe.sawRoot=!1,xe.tag=xe.error=null,xe.strict=!!Q,xe.noscript=!!(Q||xe.opt.noscript),xe.state=he.BEGIN,xe.strictEntities=xe.opt.strictEntities,xe.ENTITIES=xe.strictEntities?Object.create(r.XML_ENTITIES):Object.create(r.ENTITIES),xe.attribList=[],xe.opt.xmlns&&(xe.ns=Object.create(Ee)),xe.trackPosition=xe.opt.position!==!1,xe.trackPosition&&(xe.position=xe.line=xe.column=0),Ie(xe,"onready")}Object.create||(Object.create=function(Q){function j(){}j.prototype=Q;var xe=new j;return xe}),Object.keys||(Object.keys=function(Q){var j=[];for(var xe in Q)Q.hasOwnProperty(xe)&&j.push(xe);return j});function I(Q){for(var j=Math.max(r.MAX_BUFFER_LENGTH,10),xe=0,me=0,Fe=t.length;me<Fe;me++){var Ze=Q[t[me]].length;if(Ze>j)switch(t[me]){case"textNode":We(Q);break;case"cdata":De(Q,"oncdata",Q.cdata),Q.cdata="";break;case"script":De(Q,"onscript",Q.script),Q.script="";break;default:Xe(Q,"Max buffer length exceeded: "+t[me])}xe=Math.max(xe,Ze)}var Ue=r.MAX_BUFFER_LENGTH-xe;Q.bufferCheckPosition=Ue+Q.position}function b(Q){for(var j=0,xe=t.length;j<xe;j++)Q[t[j]]=""}function N(Q){We(Q),Q.cdata!==""&&(De(Q,"oncdata",Q.cdata),Q.cdata=""),Q.script!==""&&(De(Q,"onscript",Q.script),Q.script="")}v.prototype={end:function(){et(this)},write:ut,resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){N(this)}};var T;try{T=require("stream").Stream}catch(Q){T=function(){}}var ae=r.EVENTS.filter(function(Q){return Q!=="error"&&Q!=="end"});function X(Q,j){return new G(Q,j)}function G(Q,j){if(!(this instanceof G))return new G(Q,j);T.apply(this),this._parser=new v(Q,j),this.writable=!0,this.readable=!0;var xe=this;this._parser.onend=function(){xe.emit("end")},this._parser.onerror=function(me){xe.emit("error",me),xe._parser.error=null},this._decoder=null,ae.forEach(function(me){Object.defineProperty(xe,"on"+me,{get:function(){return xe._parser["on"+me]},set:function(Fe){if(!Fe)return xe.removeAllListeners(me),xe._parser["on"+me]=Fe,Fe;xe.on(me,Fe)},enumerable:!0,configurable:!1})})}G.prototype=Object.create(T.prototype,{constructor:{value:G}}),G.prototype.write=function(Q){if(typeof Buffer=="function"&&typeof Buffer.isBuffer=="function"&&Buffer.isBuffer(Q)){if(!this._decoder){var j=string_decoder.StringDecoder;this._decoder=new j("utf8")}Q=this._decoder.write(Q)}return this._parser.write(Q.toString()),this.emit("data",Q),!0},G.prototype.end=function(Q){return Q&&Q.length&&this.write(Q),this._parser.end(),!0},G.prototype.on=function(Q,j){var xe=this;return!xe._parser["on"+Q]&&ae.indexOf(Q)!==-1&&(xe._parser["on"+Q]=function(){var me=arguments.length===1?[arguments[0]]:Array.apply(null,arguments);me.splice(0,0,Q),xe.emit.apply(xe,me)}),T.prototype.on.call(xe,Q,j)};var ve="[CDATA[",fe="DOCTYPE",ce="http://www.w3.org/XML/1998/namespace",_e="http://www.w3.org/2000/xmlns/",Ee={xml:ce,xmlns:_e},ye=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,be=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,Te=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,Ae=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;function Se(Q){return Q===" "||Q===`
`||Q==="\r"||Q==="	"}function $e(Q){return Q==='"'||Q==="'"}function ke(Q){return Q===">"||Se(Q)}function Ne(Q,j){return Q.test(j)}function Ce(Q,j){return!Ne(Q,j)}var he=0;r.STATE={BEGIN:he++,BEGIN_WHITESPACE:he++,TEXT:he++,TEXT_ENTITY:he++,OPEN_WAKA:he++,SGML_DECL:he++,SGML_DECL_QUOTED:he++,DOCTYPE:he++,DOCTYPE_QUOTED:he++,DOCTYPE_DTD:he++,DOCTYPE_DTD_QUOTED:he++,COMMENT_STARTING:he++,COMMENT:he++,COMMENT_ENDING:he++,COMMENT_ENDED:he++,CDATA:he++,CDATA_ENDING:he++,CDATA_ENDING_2:he++,PROC_INST:he++,PROC_INST_BODY:he++,PROC_INST_ENDING:he++,OPEN_TAG:he++,OPEN_TAG_SLASH:he++,ATTRIB:he++,ATTRIB_NAME:he++,ATTRIB_NAME_SAW_WHITE:he++,ATTRIB_VALUE:he++,ATTRIB_VALUE_QUOTED:he++,ATTRIB_VALUE_CLOSED:he++,ATTRIB_VALUE_UNQUOTED:he++,ATTRIB_VALUE_ENTITY_Q:he++,ATTRIB_VALUE_ENTITY_U:he++,CLOSE_TAG:he++,CLOSE_TAG_SAW_WHITE:he++,SCRIPT:he++,SCRIPT_ENDING:he++},r.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},r.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(r.ENTITIES).forEach(function(Q){var j=r.ENTITIES[Q],xe=typeof j=="number"?String.fromCharCode(j):j;r.ENTITIES[Q]=xe});for(var Be in r.STATE)r.STATE[r.STATE[Be]]=Be;he=r.STATE;function Ie(Q,j,xe){Q[j]&&Q[j](xe)}function De(Q,j,xe){Q.textNode&&We(Q),Ie(Q,j,xe)}function We(Q){Q.textNode=Ve(Q.opt,Q.textNode),Q.textNode&&Ie(Q,"ontext",Q.textNode),Q.textNode=""}function Ve(Q,j){return Q.trim&&(j=j.trim()),Q.normalize&&(j=j.replace(/\s+/g," ")),j}function Xe(Q,j){return We(Q),Q.trackPosition&&(j+=`
Line: `+Q.line+`
Column: `+Q.column+`
Char: `+Q.c),j=new Error(j),Q.error=j,Ie(Q,"onerror",j),Q}function et(Q){return Q.sawRoot&&!Q.closedRoot&&Re(Q,"Unclosed root tag"),Q.state!==he.BEGIN&&Q.state!==he.BEGIN_WHITESPACE&&Q.state!==he.TEXT&&Xe(Q,"Unexpected end"),We(Q),Q.c="",Q.closed=!0,Ie(Q,"onend"),v.call(Q,Q.strict,Q.opt),Q}function Re(Q,j){if(typeof Q!="object"||!(Q instanceof v))throw new Error("bad call to strictFail");Q.strict&&Xe(Q,j)}function Qe(Q){Q.strict||(Q.tagName=Q.tagName[Q.looseCase]());var j=Q.tags[Q.tags.length-1]||Q,xe=Q.tag={name:Q.tagName,attributes:{}};Q.opt.xmlns&&(xe.ns=j.ns),Q.attribList.length=0,De(Q,"onopentagstart",xe)}function nt(Q,j){var xe=Q.indexOf(":"),me=xe<0?["",Q]:Q.split(":"),Fe=me[0],Ze=me[1];return j&&Q==="xmlns"&&(Fe="xmlns",Ze=""),{prefix:Fe,local:Ze}}function at(Q){if(Q.strict||(Q.attribName=Q.attribName[Q.looseCase]()),Q.attribList.indexOf(Q.attribName)!==-1||Q.tag.attributes.hasOwnProperty(Q.attribName)){Q.attribName=Q.attribValue="";return}if(Q.opt.xmlns){var j=nt(Q.attribName,!0),xe=j.prefix,me=j.local;if(xe==="xmlns")if(me==="xml"&&Q.attribValue!==ce)Re(Q,"xml: prefix must be bound to "+ce+`
Actual: `+Q.attribValue);else if(me==="xmlns"&&Q.attribValue!==_e)Re(Q,"xmlns: prefix must be bound to "+_e+`
Actual: `+Q.attribValue);else{var Fe=Q.tag,Ze=Q.tags[Q.tags.length-1]||Q;Fe.ns===Ze.ns&&(Fe.ns=Object.create(Ze.ns)),Fe.ns[me]=Q.attribValue}Q.attribList.push([Q.attribName,Q.attribValue])}else Q.tag.attributes[Q.attribName]=Q.attribValue,De(Q,"onattribute",{name:Q.attribName,value:Q.attribValue});Q.attribName=Q.attribValue=""}function Me(Q,j){if(Q.opt.xmlns){var xe=Q.tag,me=nt(Q.tagName);xe.prefix=me.prefix,xe.local=me.local,xe.uri=xe.ns[me.prefix]||"",xe.prefix&&!xe.uri&&(Re(Q,"Unbound namespace prefix: "+JSON.stringify(Q.tagName)),xe.uri=me.prefix);var Fe=Q.tags[Q.tags.length-1]||Q;xe.ns&&Fe.ns!==xe.ns&&Object.keys(xe.ns).forEach(function(Ke){De(Q,"onopennamespace",{prefix:Ke,uri:xe.ns[Ke]})});for(var Ze=0,Ue=Q.attribList.length;Ze<Ue;Ze++){var Ge=Q.attribList[Ze],Je=Ge[0],tt=Ge[1],je=nt(Je,!0),qe=je.prefix,ct=je.local,lt=qe===""?"":xe.ns[qe]||"",rt={name:Je,value:tt,prefix:qe,local:ct,uri:lt};qe&&qe!=="xmlns"&&!lt&&(Re(Q,"Unbound namespace prefix: "+JSON.stringify(qe)),rt.uri=qe),Q.tag.attributes[Je]=rt,De(Q,"onattribute",rt)}Q.attribList.length=0}Q.tag.isSelfClosing=!!j,Q.sawRoot=!0,Q.tags.push(Q.tag),De(Q,"onopentag",Q.tag),j||(!Q.noscript&&Q.tagName.toLowerCase()==="script"?Q.state=he.SCRIPT:Q.state=he.TEXT,Q.tag=null,Q.tagName=""),Q.attribName=Q.attribValue="",Q.attribList.length=0}function Ye(Q){if(!Q.tagName){Re(Q,"Weird empty close tag."),Q.textNode+="</>",Q.state=he.TEXT;return}if(Q.script){if(Q.tagName!=="script"){Q.script+="</"+Q.tagName+">",Q.tagName="",Q.state=he.SCRIPT;return}De(Q,"onscript",Q.script),Q.script=""}var j=Q.tags.length,xe=Q.tagName;Q.strict||(xe=xe[Q.looseCase]());for(var me=xe;j--;){var Fe=Q.tags[j];if(Fe.name!==me)Re(Q,"Unexpected close tag");else break}if(j<0){Re(Q,"Unmatched closing tag: "+Q.tagName),Q.textNode+="</"+Q.tagName+">",Q.state=he.TEXT;return}Q.tagName=xe;for(var Ze=Q.tags.length;Ze-- >j;){var Ue=Q.tag=Q.tags.pop();Q.tagName=Q.tag.name,De(Q,"onclosetag",Q.tagName);var Ge={};for(var Je in Ue.ns)Ge[Je]=Ue.ns[Je];var tt=Q.tags[Q.tags.length-1]||Q;Q.opt.xmlns&&Ue.ns!==tt.ns&&Object.keys(Ue.ns).forEach(function(je){var qe=Ue.ns[je];De(Q,"onclosenamespace",{prefix:je,uri:qe})})}j===0&&(Q.closedRoot=!0),Q.tagName=Q.attribValue=Q.attribName="",Q.attribList.length=0,Q.state=he.TEXT}function ft(Q){var j=Q.entity,xe=j.toLowerCase(),me,Fe="";return Q.ENTITIES[j]?Q.ENTITIES[j]:Q.ENTITIES[xe]?Q.ENTITIES[xe]:(j=xe,j.charAt(0)==="#"&&(j.charAt(1)==="x"?(j=j.slice(2),me=parseInt(j,16),Fe=me.toString(16)):(j=j.slice(1),me=parseInt(j,10),Fe=me.toString(10))),j=j.replace(/^0+/,""),isNaN(me)||Fe.toLowerCase()!==j?(Re(Q,"Invalid character entity"),"&"+Q.entity+";"):String.fromCodePoint(me))}function ot(Q,j){j==="<"?(Q.state=he.OPEN_WAKA,Q.startTagPosition=Q.position):Se(j)||(Re(Q,"Non-whitespace before first tag."),Q.textNode=j,Q.state=he.TEXT)}function st(Q,j){var xe="";return j<Q.length&&(xe=Q.charAt(j)),xe}function ut(Q){var j=this;if(this.error)throw this.error;if(j.closed)return Xe(j,"Cannot write after close. Assign an onready handler.");if(Q===null)return et(j);typeof Q=="object"&&(Q=Q.toString());for(var xe=0,me="";me=st(Q,xe++),j.c=me,!!me;)switch(j.trackPosition&&(j.position++,me===`
`?(j.line++,j.column=0):j.column++),j.state){case he.BEGIN:if(j.state=he.BEGIN_WHITESPACE,me==="\uFEFF")continue;ot(j,me);continue;case he.BEGIN_WHITESPACE:ot(j,me);continue;case he.TEXT:if(j.sawRoot&&!j.closedRoot){for(var Fe=xe-1;me&&me!=="<"&&me!=="&";)me=st(Q,xe++),me&&j.trackPosition&&(j.position++,me===`
`?(j.line++,j.column=0):j.column++);j.textNode+=Q.substring(Fe,xe-1)}me==="<"&&!(j.sawRoot&&j.closedRoot&&!j.strict)?(j.state=he.OPEN_WAKA,j.startTagPosition=j.position):(!Se(me)&&(!j.sawRoot||j.closedRoot)&&Re(j,"Text data outside of root node."),me==="&"?j.state=he.TEXT_ENTITY:j.textNode+=me);continue;case he.SCRIPT:me==="<"?j.state=he.SCRIPT_ENDING:j.script+=me;continue;case he.SCRIPT_ENDING:me==="/"?j.state=he.CLOSE_TAG:(j.script+="<"+me,j.state=he.SCRIPT);continue;case he.OPEN_WAKA:if(me==="!")j.state=he.SGML_DECL,j.sgmlDecl="";else if(!Se(me))if(Ne(ye,me))j.state=he.OPEN_TAG,j.tagName=me;else if(me==="/")j.state=he.CLOSE_TAG,j.tagName="";else if(me==="?")j.state=he.PROC_INST,j.procInstName=j.procInstBody="";else{if(Re(j,"Unencoded <"),j.startTagPosition+1<j.position){var Ze=j.position-j.startTagPosition;me=new Array(Ze).join(" ")+me}j.textNode+="<"+me,j.state=he.TEXT}continue;case he.SGML_DECL:(j.sgmlDecl+me).toUpperCase()===ve?(De(j,"onopencdata"),j.state=he.CDATA,j.sgmlDecl="",j.cdata=""):j.sgmlDecl+me==="--"?(j.state=he.COMMENT,j.comment="",j.sgmlDecl=""):(j.sgmlDecl+me).toUpperCase()===fe?(j.state=he.DOCTYPE,(j.doctype||j.sawRoot)&&Re(j,"Inappropriately located doctype declaration"),j.doctype="",j.sgmlDecl=""):me===">"?(De(j,"onsgmldeclaration",j.sgmlDecl),j.sgmlDecl="",j.state=he.TEXT):($e(me)&&(j.state=he.SGML_DECL_QUOTED),j.sgmlDecl+=me);continue;case he.SGML_DECL_QUOTED:me===j.q&&(j.state=he.SGML_DECL,j.q=""),j.sgmlDecl+=me;continue;case he.DOCTYPE:me===">"?(j.state=he.TEXT,De(j,"ondoctype",j.doctype),j.doctype=!0):(j.doctype+=me,me==="["?j.state=he.DOCTYPE_DTD:$e(me)&&(j.state=he.DOCTYPE_QUOTED,j.q=me));continue;case he.DOCTYPE_QUOTED:j.doctype+=me,me===j.q&&(j.q="",j.state=he.DOCTYPE);continue;case he.DOCTYPE_DTD:j.doctype+=me,me==="]"?j.state=he.DOCTYPE:$e(me)&&(j.state=he.DOCTYPE_DTD_QUOTED,j.q=me);continue;case he.DOCTYPE_DTD_QUOTED:j.doctype+=me,me===j.q&&(j.state=he.DOCTYPE_DTD,j.q="");continue;case he.COMMENT:me==="-"?j.state=he.COMMENT_ENDING:j.comment+=me;continue;case he.COMMENT_ENDING:me==="-"?(j.state=he.COMMENT_ENDED,j.comment=Ve(j.opt,j.comment),j.comment&&De(j,"oncomment",j.comment),j.comment=""):(j.comment+="-"+me,j.state=he.COMMENT);continue;case he.COMMENT_ENDED:me!==">"?(Re(j,"Malformed comment"),j.comment+="--"+me,j.state=he.COMMENT):j.state=he.TEXT;continue;case he.CDATA:me==="]"?j.state=he.CDATA_ENDING:j.cdata+=me;continue;case he.CDATA_ENDING:me==="]"?j.state=he.CDATA_ENDING_2:(j.cdata+="]"+me,j.state=he.CDATA);continue;case he.CDATA_ENDING_2:me===">"?(j.cdata&&De(j,"oncdata",j.cdata),De(j,"onclosecdata"),j.cdata="",j.state=he.TEXT):me==="]"?j.cdata+="]":(j.cdata+="]]"+me,j.state=he.CDATA);continue;case he.PROC_INST:me==="?"?j.state=he.PROC_INST_ENDING:Se(me)?j.state=he.PROC_INST_BODY:j.procInstName+=me;continue;case he.PROC_INST_BODY:if(!j.procInstBody&&Se(me))continue;me==="?"?j.state=he.PROC_INST_ENDING:j.procInstBody+=me;continue;case he.PROC_INST_ENDING:me===">"?(De(j,"onprocessinginstruction",{name:j.procInstName,body:j.procInstBody}),j.procInstName=j.procInstBody="",j.state=he.TEXT):(j.procInstBody+="?"+me,j.state=he.PROC_INST_BODY);continue;case he.OPEN_TAG:Ne(be,me)?j.tagName+=me:(Qe(j),me===">"?Me(j):me==="/"?j.state=he.OPEN_TAG_SLASH:(Se(me)||Re(j,"Invalid character in tag name"),j.state=he.ATTRIB));continue;case he.OPEN_TAG_SLASH:me===">"?(Me(j,!0),Ye(j)):(Re(j,"Forward-slash in opening tag not followed by >"),j.state=he.ATTRIB);continue;case he.ATTRIB:if(Se(me))continue;me===">"?Me(j):me==="/"?j.state=he.OPEN_TAG_SLASH:Ne(ye,me)?(j.attribName=me,j.attribValue="",j.state=he.ATTRIB_NAME):Re(j,"Invalid attribute name");continue;case he.ATTRIB_NAME:me==="="?j.state=he.ATTRIB_VALUE:me===">"?(Re(j,"Attribute without value"),j.attribValue=j.attribName,at(j),Me(j)):Se(me)?j.state=he.ATTRIB_NAME_SAW_WHITE:Ne(be,me)?j.attribName+=me:Re(j,"Invalid attribute name");continue;case he.ATTRIB_NAME_SAW_WHITE:if(me==="=")j.state=he.ATTRIB_VALUE;else{if(Se(me))continue;Re(j,"Attribute without value"),j.tag.attributes[j.attribName]="",j.attribValue="",De(j,"onattribute",{name:j.attribName,value:""}),j.attribName="",me===">"?Me(j):Ne(ye,me)?(j.attribName=me,j.state=he.ATTRIB_NAME):(Re(j,"Invalid attribute name"),j.state=he.ATTRIB)}continue;case he.ATTRIB_VALUE:if(Se(me))continue;$e(me)?(j.q=me,j.state=he.ATTRIB_VALUE_QUOTED):(Re(j,"Unquoted attribute value"),j.state=he.ATTRIB_VALUE_UNQUOTED,j.attribValue=me);continue;case he.ATTRIB_VALUE_QUOTED:if(me!==j.q){me==="&"?j.state=he.ATTRIB_VALUE_ENTITY_Q:j.attribValue+=me;continue}at(j),j.q="",j.state=he.ATTRIB_VALUE_CLOSED;continue;case he.ATTRIB_VALUE_CLOSED:Se(me)?j.state=he.ATTRIB:me===">"?Me(j):me==="/"?j.state=he.OPEN_TAG_SLASH:Ne(ye,me)?(Re(j,"No whitespace between attributes"),j.attribName=me,j.attribValue="",j.state=he.ATTRIB_NAME):Re(j,"Invalid attribute name");continue;case he.ATTRIB_VALUE_UNQUOTED:if(!ke(me)){me==="&"?j.state=he.ATTRIB_VALUE_ENTITY_U:j.attribValue+=me;continue}at(j),me===">"?Me(j):j.state=he.ATTRIB;continue;case he.CLOSE_TAG:if(j.tagName)me===">"?Ye(j):Ne(be,me)?j.tagName+=me:j.script?(j.script+="</"+j.tagName,j.tagName="",j.state=he.SCRIPT):(Se(me)||Re(j,"Invalid tagname in closing tag"),j.state=he.CLOSE_TAG_SAW_WHITE);else{if(Se(me))continue;Ce(ye,me)?j.script?(j.script+="</"+me,j.state=he.SCRIPT):Re(j,"Invalid tagname in closing tag."):j.tagName=me}continue;case he.CLOSE_TAG_SAW_WHITE:if(Se(me))continue;me===">"?Ye(j):Re(j,"Invalid characters in closing tag");continue;case he.TEXT_ENTITY:case he.ATTRIB_VALUE_ENTITY_Q:case he.ATTRIB_VALUE_ENTITY_U:var Ue,Ge;switch(j.state){case he.TEXT_ENTITY:Ue=he.TEXT,Ge="textNode";break;case he.ATTRIB_VALUE_ENTITY_Q:Ue=he.ATTRIB_VALUE_QUOTED,Ge="attribValue";break;case he.ATTRIB_VALUE_ENTITY_U:Ue=he.ATTRIB_VALUE_UNQUOTED,Ge="attribValue";break}me===";"?(j[Ge]+=ft(j),j.entity="",j.state=Ue):Ne(j.entity.length?Ae:Te,me)?j.entity+=me:(Re(j,"Invalid character in entity name"),j[Ge]+="&"+j.entity+me,j.entity="",j.state=Ue);continue;default:throw new Error(j,"Unknown state: "+j.state)}return j.position>=j.bufferCheckPosition&&I(j),j}/*! http://mths.be/fromcodepoint v0.1.0 by @mathias */String.fromCodePoint||function(){var Q=String.fromCharCode,j=Math.floor,xe=function(){var me=16384,Fe=[],Ze,Ue,Ge=-1,Je=arguments.length;if(!Je)return"";for(var tt="";++Ge<Je;){var je=Number(arguments[Ge]);if(!isFinite(je)||je<0||je>1114111||j(je)!==je)throw RangeError("Invalid code point: "+je);je<=65535?Fe.push(je):(je-=65536,Ze=(je>>10)+55296,Ue=je%1024+56320,Fe.push(Ze,Ue)),(Ge+1===Je||Fe.length>me)&&(tt+=Q.apply(null,Fe),Fe.length=0)}return tt};Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:xe,configurable:!0,writable:!0}):String.fromCodePoint=xe}()})(e)})(sax);const logger={debug:()=>{}},p$2=e=>{const r=sax.parser(!0,{trim:!1,normalize:!1});let t,v=null;return new Promise((I,b)=>{r.onopentag=N=>{const T={_parent:v||void 0,_children:[],_fTextNode:!1,_tag:N.name,_attrs:N.attributes};v!=null?v._children.push(T):t=T,v=T},r.onclosetag=()=>{v=v!=null?v._parent:null},r.ontext=N=>{v!=null&&v._children.push({_parent:v,_children:[],_fTextNode:!0,_text:N})},r.onend=()=>{I(t)},r.onerror=N=>{b(N)},r.write(e),r.end()})},u$2=(e,r,t="")=>{let v=t.length?"":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>';if(e._fTextNode)v+=g$2(e._text,r);else{let I="";const b=e._attrs;Object.keys(b).forEach(X=>{I+=` ${X}="${d(b[X])}"`});const N=e._children.length>0,T=N?"":"/";v+=`
${t}<${e._tag}${I}${T}>`;let ae=!1;e._children.forEach(X=>{v+=u$2(X,r,`${t}  `),ae=!X._fTextNode}),N&&(v+=`${ae?`
${t}`:""}</${e._tag}>`)}return v},g$2=(e,r)=>{let t="";const v=e.split(r.literalXmlDelimiter);let I=!1;for(let b=0;b<v.length;b++){let N=v[b];I||(N=N.replace(/&/g,"&amp;"),N=N.replace(/</g,"&lt;"),N=N.replace(/>/g,"&gt;")),t+=N,I=!I}return t},d=e=>{let r=typeof e=="string"?e:e.value;return r=r.replace(/&/g,"&amp;"),r=r.replace(/</g,"&lt;"),r=r.replace(/>/g,"&gt;"),r=r.replace(/'/g,"&apos;"),r=r.replace(/"/g,"&quot;"),r};class NullishCommandResultError extends Error{constructor(r){super(`Result of command ${r} is null or undefined and rejectNullish is set`),Object.setPrototypeOf(this,NullishCommandResultError.prototype),this.command=r}}class ObjectCommandResultError extends Error{constructor(r){super(`Result of command '${r}' is an object`),Object.setPrototypeOf(this,ObjectCommandResultError.prototype),this.command=r}}class CommandSyntaxError extends Error{constructor(r){super(`Invalid command syntax: ${r}`),Object.setPrototypeOf(this,CommandSyntaxError.prototype),this.command=r}}class InvalidCommandError extends Error{constructor(r,t){super(`${r}: ${t}`),Object.setPrototypeOf(this,InvalidCommandError.prototype),this.command=t}}class CommandExecutionError extends Error{constructor(r,t){super(`Error executing command '${t}': ${r.message}`),Object.setPrototypeOf(this,CommandExecutionError.prototype),this.command=t,this.err=r}}class ImageError extends CommandExecutionError{}class InternalError extends Error{constructor(r){super(`INTERNAL ERROR: ${r}`)}}class TemplateParseError extends Error{}class IncompleteConditionalStatementError extends Error{constructor(){super("Incomplete IF/END-IF statement. Make sure each IF-statement has a corresponding END-IF command.")}}class UnterminatedForLoopError extends Error{constructor(r){super(`Unterminated FOR-loop ('FOR ${r.varName}'). Make sure each FOR loop has a corresponding END-FOR command.`)}}const i=e=>e._fTextNode?{_children:[],_fTextNode:!0,_text:e._text}:{_children:[],_fTextNode:!1,_tag:e._tag,_attrs:e._attrs},_$1=e=>{const r=e._parent;if(r==null)return null;const t=r._children,v=t.indexOf(e);return v<0||v>=t.length-1?null:t[v+1]},a$1=e=>{const r=e._parent;if(!(r&&!r._fTextNode&&r._tag==="w:t"))throw new TemplateParseError("Template syntax error: text node not within w:t");const t=r._parent;if(t==null)throw new TemplateParseError("Template syntax error: w:t node has no parent");const v=t._children.indexOf(r);if(v<0)throw new TemplateParseError("Template syntax error");const I=i(r);I._parent=t;const b={_parent:I,_children:[],_fTextNode:!0,_text:""};return I._children=[b],t._children.splice(v+1,0,I),b},c$1=(e,r={},t=[])=>{const v={_fTextNode:!1,_tag:e,_attrs:r,_children:t};return v._children.forEach(I=>{I._parent=v}),v},u$1=e=>({_children:[],_fTextNode:!0,_text:e}),p$1=(e,r)=>(e._children.push(r),r._parent=e,r),s=e=>e.loops.length?e.loops[e.loops.length-1]:null,f=e=>{const r=s(e);return r!=null&&r.idx<0},h$1=e=>{if(!e.length)return;const r=e.length-1,{varName:t,idx:v,loopOver:I,isIf:b}=e[r],N=v>=0?v+1:"EXPLORATION";logger.debug(`${b?"IF":"FOR"} loop on ${r}:${t}${N}/${I.length}`)},g$1=(e,r)=>{let t=e,v=!1,I=null,b=0;const N=`${r[0]}CMD_NODE${r[1]}`;for(;t!=null;){if(!t._fTextNode&&t._tag==="w:t"&&(t._attrs["xml:space"]="preserve"),!t._fTextNode&&t._tag==="w:p"&&I&&(I._text+=" "),t._fTextNode&&t._parent&&!t._parent._fTextNode&&t._parent._tag==="w:t"){I==null&&(I=t);const T=t._text;t._text="";for(let ae=0;ae<T.length;ae++){const X=T[ae],G=v?r[1]:r[0];if(X===G[b]){if(b+=1,b===G.length){v=!v;const ve=t===I;v&&I._text.length&&(I=a$1(I),ve&&(t=I)),I._text+=G,!v&&ae<T.length-1&&(I=a$1(I),ve&&(t=I)),b=0,v||(I=t)}}else b&&(I._text+=G.slice(0,b),b=0,v||(I=t)),I._text+=X}!v&&!b&&(I=null),T.length&&!t._text.length&&(t._text=N)}if(t._children.length)t=t._children[0];else{let T=!1;for(;t._parent!=null;){const ae=t._parent,X=_$1(t);if(X){T=!0,t=X;break}t=ae}T||(t=null)}}return e};var vmBrowserify={};(function(exports){var indexOf=function(e,r){if(e.indexOf)return e.indexOf(r);for(var t=0;t<e.length;t++)if(e[t]===r)return t;return-1},Object_keys=function(e){if(Object.keys)return Object.keys(e);var r=[];for(var t in e)r.push(t);return r},forEach=function(e,r){if(e.forEach)return e.forEach(r);for(var t=0;t<e.length;t++)r(e[t],t,e)},defineProp=function(){try{return Object.defineProperty({},"_",{}),function(e,r,t){Object.defineProperty(e,r,{writable:!0,enumerable:!1,configurable:!0,value:t})}}catch(e){return function(r,t,v){r[t]=v}}}(),globals=["Array","Boolean","Date","Error","EvalError","Function","Infinity","JSON","Math","NaN","Number","Object","RangeError","ReferenceError","RegExp","String","SyntaxError","TypeError","URIError","decodeURI","decodeURIComponent","encodeURI","encodeURIComponent","escape","eval","isFinite","isNaN","parseFloat","parseInt","undefined","unescape"];function Context(){}Context.prototype={};var Script=exports.Script=function(r){if(!(this instanceof Script))return new Script(r);this.code=r};Script.prototype.runInContext=function(e){if(!(e instanceof Context))throw new TypeError("needs a 'context' argument.");var r=document.createElement("iframe");r.style||(r.style={}),r.style.display="none",document.body.appendChild(r);var t=r.contentWindow,v=t.eval,I=t.execScript;!v&&I&&(I.call(t,"null"),v=t.eval),forEach(Object_keys(e),function(T){t[T]=e[T]}),forEach(globals,function(T){e[T]&&(t[T]=e[T])});var b=Object_keys(t),N=v.call(t,this.code);return forEach(Object_keys(t),function(T){(T in e||indexOf(b,T)===-1)&&(e[T]=t[T])}),forEach(globals,function(T){T in e||defineProp(e,T,t[T])}),document.body.removeChild(r),N},Script.prototype.runInThisContext=function(){return eval(this.code)},Script.prototype.runInNewContext=function(e){var r=Script.createContext(e),t=this.runInContext(r);return e&&forEach(Object_keys(r),function(v){e[v]=r[v]}),t},forEach(Object_keys(Script.prototype),function(e){exports[e]=Script[e]=function(r){var t=Script(r);return t[e].apply(t,[].slice.call(arguments,1))}}),exports.isContext=function(e){return e instanceof Context},exports.createScript=function(e){return exports.Script(e)},exports.createContext=Script.createContext=function(e){var r=new Context;return typeof e=="object"&&forEach(Object_keys(e),function(t){r[t]=e[t]}),r}})(vmBrowserify);var m=Object.defineProperty,w=Object.defineProperties,c=Object.getOwnPropertyDescriptors,u=Object.getOwnPropertySymbols,C$1=Object.prototype.hasOwnProperty,h=Object.prototype.propertyIsEnumerable,p=(e,r,t)=>r in e?m(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,a=(e,r)=>{for(var t in r||(r={}))C$1.call(r,t)&&p(e,t,r[t]);if(u)for(var t of u(r))h.call(r,t)&&p(e,t,r[t]);return e},l=(e,r)=>w(e,c(r));async function runUserJsAndGetRaw(e,r,t){const v=a(a(l(a({},t.jsSandbox||{}),{__code__:r,__result__:void 0}),e),t.options.additionalJsContext),I=s(t);I&&(v.$idx=I.idx),Object.keys(t.vars).forEach(T=>{v[`$${T}`]=t.vars[T]});let b,N;try{if(t.options.runJs){const T=t.options.runJs({sandbox:v,ctx:t});b=T.modifiedSandbox,N=await T.result}else if(t.options.noSandbox)b=v,N=await new Function("with(this) { return eval(__code__); }").call(b);else{const T=new vmBrowserify.Script(`
      __result__ = eval(__code__);
      `,{});b=vmBrowserify.createContext(v),T.runInContext(b),N=await b.__result__}}catch(T){const ae=T instanceof Error?T:new Error(`${T}`);if(t.options.errorHandler!=null)b=v,N=await t.options.errorHandler(ae,r);else throw new CommandExecutionError(ae,r)}if(t.options.rejectNullish&&N==null){const T=new NullishCommandResultError(r);if(t.options.errorHandler!=null)N=await t.options.errorHandler(T,r);else throw T}return t.jsSandbox=l(a({},b),{__code__:void 0,__result__:void 0}),N}const ImageExtensions=[".png",".gif",".jpg",".jpeg",".svg"],BUILT_IN_COMMANDS=["QUERY","CMD_NODE","ALIAS","FOR","END-FOR","IF","END-IF","INS","EXEC","IMAGE","LINK","HTML"];var B=Object.defineProperty,U=Object.defineProperties,H=Object.getOwnPropertyDescriptors,k=Object.getOwnPropertySymbols,M=Object.prototype.hasOwnProperty,J$1=Object.prototype.propertyIsEnumerable,R=(e,r,t)=>r in e?B(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,L=(e,r)=>{for(var t in r||(r={}))M.call(r,t)&&R(e,t,r[t]);if(k)for(var t of k(r))J$1.call(r,t)&&R(e,t,r[t]);return e},S=(e,r)=>U(e,H(r));function newContext(e,r=0){return{gCntIf:0,gCntEndIf:0,level:1,fCmd:!1,cmd:"",fSeekQuery:!1,buffers:{"w:p":{text:"",cmds:"",fInsertedText:!1},"w:tr":{text:"",cmds:"",fInsertedText:!1}},imageAndShapeIdIncrement:r,images:{},linkId:0,links:{},htmlId:0,htmls:{},vars:{},loops:[],fJump:!1,shorthands:{},options:e}}async function extractQuery(e,r){const t=newContext(r);t.fSeekQuery=!0;let v=e;for(;;){if(v._children.length)v=v._children[0];else{let b=!1;for(;v._parent!=null;){const N=v._parent,T=_$1(v);if(T){v=T,b=!0;break}v=N}if(!b)break}if(!v)break;const I=v._parent;if(v._fTextNode&&I&&!I._fTextNode&&I._tag==="w:t"&&await D(null,v,t,F$1),t.query!=null)break}return t.query}async function produceJsReport(e,r,t){return walkTemplate(e,r,t,F$1)}function findHighestImgId(e){const r=[],t=v=>{for(const I of v._children){const b=I._fTextNode?null:I._tag;if(b!=null){if(b==="wp:docPr"){if(I._fTextNode)continue;const N=I._attrs.id;if(typeof N!="string")continue;const T=Number.parseInt(N,10);Number.isSafeInteger(T)&&r.push(T)}I._children.length>0&&t(I)}}};return t(e),r.length>0?Math.max(...r):0}const _=e=>JSON.stringify(e._fTextNode?{_ifName:e._ifName,_fTextNode:e._fTextNode,_text:e==null?void 0:e._text}:{_ifName:e._ifName,_fTextNode:e._fTextNode,_tag:e==null?void 0:e._tag,_attrs:e==null?void 0:e._attrs});async function walkTemplate(e,r,t,v){const I=i(r);let b=r,N=I,T,ae=0;const X=[];for(;;){const G=s(t);let ve=null;if(t.fJump){if(!G)throw new InternalError("jumping while curLoop is null");logger.debug(`Jumping to level ${G.refNodeLevel}...`,_(G.refNode)),ae=t.level-G.refNodeLevel,b=G.refNode,t.level=G.refNodeLevel,t.fJump=!1,T="JUMP"}else if(b._children.length&&T!=="UP")b=b._children[0],t.level+=1,T="DOWN";else if(ve=_$1(b))b=ve,T="SIDE";else{const fe=b._parent;if(fe==null)break;b=fe,t.level-=1,T="UP"}if(logger.debug(`Next node [${T}, level ${t.level}]`,_(b)),T!=="DOWN"){const fe=N._fTextNode?null:N._tag;let ce=!1;if((fe==="w:p"||fe==="w:tbl"||fe==="w:tr")&&f(t))ce=!0;else if(fe==="w:p"||fe==="w:tr"){const _e=t.buffers[fe];ce=_e.text===""&&_e.cmds!==""&&!_e.fInsertedText}ce&&N._parent!=null&&N._parent._children.pop()}if(T==="UP"){f(t)&&G&&b===G.refNode._parent&&(G.refNode=b,G.refNodeLevel-=1,logger.debug(`Updated loop '${G.varName}' refNode: `+_(b)));const fe=N._parent;if(fe==null)throw new InternalError("node parent is null");if(N=fe,t.pendingImageNode&&!N._fTextNode&&N._tag==="w:t"){const ce=t.pendingImageNode.image,_e=t.pendingImageNode.caption,Ee=N._parent;Ee&&(ce._parent=Ee,Ee._children.pop(),Ee._children.push(ce),_e&&Ee._children.push(..._e),t.buffers["w:p"].fInsertedText=!0,t.buffers["w:tr"].fInsertedText=!0),delete t.pendingImageNode}if(t.pendingLinkNode&&!N._fTextNode&&N._tag==="w:r"){const ce=t.pendingLinkNode,_e=N._parent;_e&&(ce._parent=_e,_e._children.pop(),_e._children.push(ce),t.buffers["w:p"].fInsertedText=!0,t.buffers["w:tr"].fInsertedText=!0),delete t.pendingLinkNode}if(t.pendingHtmlNode&&!N._fTextNode&&N._tag==="w:p"){const ce=t.pendingHtmlNode,_e=N._parent;_e&&(ce._parent=_e,_e._children.pop(),_e._children.push(ce),t.buffers["w:p"].fInsertedText=!0,t.buffers["w:tr"].fInsertedText=!0),delete t.pendingHtmlNode}!N._fTextNode&&N._tag==="w:tc"&&!N._children.filter(ce=>!ce._fTextNode&&(ce._tag==="w:p"||ce._tag==="w:altChunk")).length&&N._children.push({_parent:N,_children:[],_fTextNode:!1,_tag:"w:p",_attrs:{}}),!N._fTextNode&&N._tag==="w:rPr"&&(t.textRunPropsNode=N),!b._fTextNode&&b._tag==="w:r"&&delete t.textRunPropsNode}if(T==="DOWN"||T==="SIDE"){if(T==="SIDE"){if(N._parent==null)throw new InternalError("node parent is null");N=N._parent}const fe=b._fTextNode?null:b._tag;(fe==="w:p"||fe==="w:tr")&&(t.buffers[fe]={text:"",cmds:"",fInsertedText:!1});const ce=i(b);ce._parent=N,N._children.push(ce);const _e=ce._tag;!f(t)&&(_e==="wp:docPr"||_e==="v:shape")&&(logger.debug("detected a - ",_(ce)),se(ce,t));const Ee=b._parent;if(b._fTextNode&&Ee&&!Ee._fTextNode&&Ee._tag==="w:t"){const ye=await D(e,b,t,v);typeof ye=="string"?(ce._text=ye,logger.debug("Inserted command result string into node. Updated node: "+_(ce))):X.push(...ye)}N=ce}if(T==="JUMP")for(;ae>0;){if(N._parent==null)throw new InternalError("node parent is null");N=N._parent,ae-=1}}if(t.gCntIf!==t.gCntEndIf){const G=new IncompleteConditionalStatementError;if(t.options.failFast)throw G;X.push(G)}if(t.loops.filter(G=>!G.isIf).length>0){const G=t.loops[t.loops.length-1],ve=new UnterminatedForLoopError(G);if(t.options.failFast)throw ve;X.push(ve)}return X.length>0?{status:"errors",errors:X}:{status:"success",report:I,images:t.images,links:t.links,htmls:t.htmls}}const D=async(e,r,t,v)=>{const{cmdDelimiter:I,failFast:b}=t.options,N=r._text;if(N==null||N==="")return"";const T=N.split(I[0]).map(G=>G.split(I[1])).reduce((G,ve)=>G.concat(ve));let ae="";const X=[];for(let G=0;G<T.length;G++){G>0&&y(I[0],t,{fCmd:!0});const ve=T[G];if(t.fCmd?t.cmd+=ve:f(t)||(ae+=ve),y(ve,t,{fCmd:t.fCmd}),G<T.length-1){if(t.fCmd){const fe=await v(e,r,t);if(fe!=null)if(typeof fe=="string")ae+=fe,y(fe,t,{fCmd:!1,fInsertedText:!0});else{if(b)throw fe;X.push(fe)}}t.fCmd=!t.fCmd}}return X.length>0?X:ae},F$1=async(e,r,t)=>{const v=getCommand(t.cmd,t.shorthands,t.options.fixSmartQuotes);t.cmd="";try{const{cmdName:I,cmdRest:b}=splitCommand(v);if(I!=="CMD_NODE"&&logger.debug(`Processing cmd: ${v}`),t.fSeekQuery){I==="QUERY"&&(t.query=b);return}if(!(I==="QUERY"||I==="CMD_NODE"))if(I==="ALIAS"){const N=/^(\S+)\s+(.+)/.exec(b);if(!N)throw new InvalidCommandError("Invalid ALIAS command",v);const T=N[1],ae=N[2];t.shorthands[T]=ae,logger.debug(`Defined alias '${T}' for: ${ae}`)}else if(I==="FOR"||I==="IF")await Z(e,r,t,v,I,b);else if(I==="END-FOR"||I==="END-IF")z(r,t,v,I,b);else if(I==="INS"){if(!f(t)){let N=await runUserJsAndGetRaw(e,b,t);if(N==null)return"";if(typeof N=="object"&&!Array.isArray(N)){const ae=new ObjectCommandResultError(b);if(t.options.errorHandler!=null)N=await t.options.errorHandler(ae,b);else throw ae}let T=String(N);if(t.options.processLineBreaks){const{literalXmlDelimiter:ae}=t.options;if(t.options.processLineBreaksAsNewText){const X=T.split(`
`),G=`${ae}<w:br/>${ae}`,ve=`${ae}</w:t>${ae}`,fe=`${ae}<w:t xml:space="preserve">${ae}`;T=X.join(`${ve}${G}${fe}`)}else T=T.replace(/\n/g,`${ae}<w:br/>${ae}`)}return T}}else if(I==="EXEC")f(t)||await runUserJsAndGetRaw(e,b,t);else if(I==="IMAGE"){if(!f(t)){const N=await runUserJsAndGetRaw(e,b,t);if(N!=null)try{te$1(t,N)}catch(T){throw T instanceof Error?new ImageError(T,v):T}}}else if(I==="LINK"){if(!f(t)){const N=await runUserJsAndGetRaw(e,b,t);N!=null&&await re(t,N)}}else if(I==="HTML"){if(!f(t)){const N=await runUserJsAndGetRaw(e,b,t);N!=null&&await oe(t,N)}}else throw new CommandSyntaxError(v);return}catch(I){if(!(I instanceof Error))throw I;return t.options.errorHandler!=null?t.options.errorHandler(I):I}},Y$1=BUILT_IN_COMMANDS.map(e=>new RegExp(`^${e}\\b`)),V$1=e=>!Y$1.some(r=>r.test(e.toUpperCase()));function getCommand(e,r,t){let v=e.trim();if(v[0]==="*"){const I=v.slice(1).trim();if(!r[I])throw new InvalidCommandError("Unknown alias",v);v=r[I]}else v[0]==="="?v=`INS ${v.slice(1).trim()}`:v[0]==="!"?v=`EXEC ${v.slice(1).trim()}`:V$1(v)&&(v=`INS ${v.trim()}`);return t&&(v=v.replace(/[\u201C\u201D\u201E]/g,'"').replace(/[\u2018\u2019\u201A]/g,"'")),v.trim()}function splitCommand(e){const r=/^(\S+)\s*/.exec(e);let t,v="";return r!=null&&(t=r[1].toUpperCase(),v=e.slice(t.length).trim()),{cmdName:t,cmdRest:v}}const Z=async(e,r,t,v,I,b)=>{const N=I==="IF";let T=null,ae;if(N)r._ifName||(r._ifName=`__if_${t.gCntIf}`,t.gCntIf+=1),ae=r._ifName;else{if(T=/^(\S+)\s+IN\s+(.+)/i.exec(b),!T)throw new InvalidCommandError("Invalid FOR command",v);ae=T[1]}const X=s(t);if(!(X&&X.varName===ae)){const G=t.loops.length-1,ve=G>=0&&t.loops[G].idx===-1;let fe;if(ve)fe=[];else if(N)fe=await runUserJsAndGetRaw(e,b,t)?[1]:[];else{if(!T)throw new InvalidCommandError("Invalid FOR command",v);if(fe=await runUserJsAndGetRaw(e,T[2],t),!Array.isArray(fe))throw new InvalidCommandError("Invalid FOR command (can only iterate over Array)",v)}t.loops.push({refNode:r,refNodeLevel:t.level,varName:ae,loopOver:fe,isIf:N,idx:-1})}h$1(t.loops)},z=(e,r,t,v,I)=>{const b=v==="END-IF",N=s(r);if(!N)throw new InvalidCommandError(`Unexpected ${v} outside of ${b?"IF statement":"FOR loop"} context`,t);b&&!e._ifName&&(e._ifName=N.varName,r.gCntEndIf+=1);const T=b?e._ifName:I;if(N.varName!==T){if(r.loops.find(G=>G.varName===T)==null){logger.debug(`Ignoring ${t} (${T}, but we're expecting ${N.varName})`);return}throw new InvalidCommandError("Invalid command",t)}const ae=N.idx+1,X=N.loopOver[ae];X!=null?(r.vars[T]=X,r.fJump=!0,N.idx=ae):r.loops.pop()},O=(e,r)=>{E(r),e.imageAndShapeIdIncrement+=1;const t=`img${String(e.imageAndShapeIdIncrement)}`;return e.images[t]=r,t};function E(e){if(!(e.data instanceof Buffer||e.data instanceof ArrayBuffer||typeof e.data=="string"))throw new Error("image .data property needs to be provided as Buffer, ArrayBuffer, or as a base64-encoded string");if(!ImageExtensions.includes(e.extension))throw new Error(`An extension (one of ${ImageExtensions}) needs to be provided when providing an image or a thumbnail.`)}function ee$1(e){if(!Number.isFinite(e.width))throw new Error(`invalid image width: ${e.width} (in cm)`);if(!Number.isFinite(e.height))throw new Error(`invalid image height: ${e.height} (in cm)`);E(e),e.thumbnail&&E(e.thumbnail)}const te$1=(e,r)=>{var t;ee$1(r);const v=(r.width*36e4).toFixed(0),I=(r.height*36e4).toFixed(0);let b=O(e,ne(r));const N=String(e.imageAndShapeIdIncrement),T=r.alt||"desc",ae=c$1,X=[];X.push(ae("a:ext",{uri:"{28A0092B-C50C-407E-A947-70E740481C1C}"},[ae("a14:useLocalDpi",{"xmlns:a14":"http://schemas.microsoft.com/office/drawing/2010/main",val:"0"})]));const G=r.rotation?(r.rotation*6e4).toString():void 0;if(e.images[b].extension===".svg"){const ce=(t=r.thumbnail)!=null?t:{data:"bm90aGluZwo=",extension:".png"},_e=O(e,ce);X.push(ae("a:ext",{uri:"{96DAC541-7B7A-43D3-8B79-37D633B846F1}"},[ae("asvg:svgBlip",{"xmlns:asvg":"http://schemas.microsoft.com/office/drawing/2016/SVG/main","r:embed":b})])),b=_e}const ve=ae("pic:pic",{"xmlns:pic":"http://schemas.openxmlformats.org/drawingml/2006/picture"},[ae("pic:nvPicPr",{},[ae("pic:cNvPr",{id:"0",name:`Picture ${N}`,descr:T}),ae("pic:cNvPicPr",{},[ae("a:picLocks",{noChangeAspect:"1",noChangeArrowheads:"1"})])]),ae("pic:blipFill",{},[ae("a:blip",{"r:embed":b,cstate:"print"},[ae("a:extLst",{},X)]),ae("a:srcRect"),ae("a:stretch",{},[ae("a:fillRect")])]),ae("pic:spPr",{bwMode:"auto"},[ae("a:xfrm",G?{rot:G}:{},[ae("a:off",{x:"0",y:"0"}),ae("a:ext",{cx:v,cy:I})]),ae("a:prstGeom",{prst:"rect"},[ae("a:avLst")]),ae("a:noFill"),ae("a:ln",{},[ae("a:noFill")])])]),fe=ae("w:drawing",{},[ae("wp:inline",{distT:"0",distB:"0",distL:"0",distR:"0"},[ae("wp:extent",{cx:v,cy:I}),ae("wp:docPr",{id:N,name:`Picture ${N}`,descr:T}),ae("wp:cNvGraphicFramePr",{},[ae("a:graphicFrameLocks",{"xmlns:a":"http://schemas.openxmlformats.org/drawingml/2006/main",noChangeAspect:"1"})]),ae("a:graphic",{"xmlns:a":"http://schemas.openxmlformats.org/drawingml/2006/main"},[ae("a:graphicData",{uri:"http://schemas.openxmlformats.org/drawingml/2006/picture"},[ve])])])]);e.pendingImageNode={image:fe},r.caption&&(e.pendingImageNode.caption=[ae("w:br"),ae("w:t",{},[u$1(r.caption)])])};function ne(e){const{data:r,extension:t}=e;if(!t)throw new Error("If you return image `data`, make sure you return an extension as well!");return{extension:t,data:r}}const re=async(e,r)=>{const{url:t,label:v=t}=r;e.linkId+=1;const I=`link${String(e.linkId)}`;e.links[I]={url:t};const b=c$1,{textRunPropsNode:N}=e,T=b("w:hyperlink",{"r:id":I,"w:history":"1"},[b("w:r",{},[N||b("w:rPr",{},[b("w:u",{"w:val":"single"})]),b("w:t",{},[u$1(v)])])]);e.pendingLinkNode=T},oe=async(e,r)=>{e.htmlId+=1;const t=`html${String(e.htmlId)}`;e.htmls[t]=r;const v=c$1("w:altChunk",{"r:id":t});e.pendingHtmlNode=v},ie=["w:p","w:tr"],y=(e,r,t)=>{if(r.fSeekQuery)return;const{fCmd:v,fInsertedText:I}=t,b=v?"cmds":"text";ie.forEach(N=>{const T=r.buffers[N];T[b]+=e,I&&(T.fInsertedText=!0)})};function se(e,r){r.imageAndShapeIdIncrement+=1;const t=String(r.imageAndShapeIdIncrement);e._attrs=S(L({},e._attrs),{id:`${t}`})}const W="+++",C="||",J="[Content_Types].xml",g="word",de=new RegExp(`${g}\\/[^\\/]+\\.xml`);async function parseTemplate(e){const r=await n(e),t=await readContentTypes(r),v=getMainDoc(t),I=`${g}/${v}`,b=await s$1(r,I);if(b==null)throw new TemplateParseError(`${v} could not be found`);logger.debug(`${I} file length: ${b.length}`),new Date().getTime();const N=await p$2(b);return new Date().getTime(),{jsTemplate:N,mainDocument:v,zip:r,contentTypes:t}}async function V(e,r,t){const v=[];e.forEach(async b=>{de.test(b)&&b!==`${g}/${r}`&&b.indexOf(`${g}/template`)!==0&&v.push(b)}),v.sort();const I=[];for(const b of v){const N=await s$1(e,b);if(N==null)throw new TemplateParseError(`${b} could not be read`);logger.debug(`${b} file length: ${N.length}`);const T=await p$2(N),ae=g$1(T,t.cmdDelimiter);I.push([ae,b])}return I}async function ue(e,r){const{template:t,data:v,queryVars:I}=e,b=e.literalXmlDelimiter||C,N={cmdDelimiter:te(e.cmdDelimiter),literalXmlDelimiter:b,processLineBreaks:e.processLineBreaks!=null?e.processLineBreaks:!0,noSandbox:e.noSandbox||!1,runJs:e.runJs,additionalJsContext:e.additionalJsContext||{},failFast:e.failFast==null?!0:e.failFast,rejectNullish:e.rejectNullish==null?!1:e.rejectNullish,errorHandler:typeof e.errorHandler=="function"?e.errorHandler:null,fixSmartQuotes:e.fixSmartQuotes==null?!1:e.fixSmartQuotes,processLineBreaksAsNewText:e.processLineBreaksAsNewText==null?!1:e.processLineBreaksAsNewText},T={literalXmlDelimiter:b},{jsTemplate:ae,mainDocument:X,zip:G,contentTypes:ve}=await parseTemplate(t),fe=g$1(ae,N.cmdDelimiter);let ce=null;if(typeof v=="function"){const he=await extractQuery(fe,N);ce=await v(he,I)}else ce=v;const _e=await V(G,X,N),Ee=Math.max(..._e.map(([he,Be])=>findHighestImgId(he)),findHighestImgId(fe));let ye=newContext(N,Ee);const be=await produceJsReport(ce,fe,ye);if(be.status==="errors")throw be.errors;const{report:Te,images:Ae,links:Se,htmls:$e}=be;if(r==="JS")return Te;const ke=u$2(Te,T);if(r==="XML")return ke;p$3(G,`${g}/${X}`,ke);let Ne=Object.keys(Ae).length,Ce=Object.keys($e).length;await Y(Ae,X,G),await K(Se,X,G),await ee($e,X,G);for(const[he,Be]of _e){ye=newContext(N,ye.imageAndShapeIdIncrement);const Ie=await produceJsReport(ce,he,ye);if(Ie.status==="errors")throw Ie.errors;const{report:De,images:We,links:Ve,htmls:Xe}=Ie,et=u$2(De,T);p$3(G,Be,et),Ne+=Object.keys(We).length,Ce+=Object.keys(Xe).length;const Re=Be.split("/"),Qe=Re[Re.length-1];await Y(We,Qe,G),await K(Ve,X,G),await ee(Xe,X,G)}if(Ne||Ce){const he=(Ie,De)=>{ve._children.filter(We=>!We._fTextNode&&We._attrs.Extension===Ie).length||p$1(ve,c$1("Default",{Extension:Ie,ContentType:De}))};Ne&&(he("png","image/png"),he("jpg","image/jpeg"),he("jpeg","image/jpeg"),he("gif","image/gif"),he("bmp","image/bmp"),he("svg","image/svg+xml")),Ce&&he("html","text/html");const Be=u$2(ve,T);p$3(G,J,Be)}return await c$2(G)}async function listCommands(e,r){const t={cmdDelimiter:te(r),literalXmlDelimiter:C,processLineBreaks:!0,noSandbox:!1,additionalJsContext:{},failFast:!1,rejectNullish:!1,errorHandler:null,fixSmartQuotes:!1,processLineBreaksAsNewText:!1},{jsTemplate:v,mainDocument:I,zip:b}=await parseTemplate(e),N=await V(b,I,t),T=[v,...N.map(([X,G])=>X)],ae=[];for(const X of T){const G=g$1(X,t.cmdDelimiter),ve=newContext(t);await walkTemplate(void 0,G,ve,async(fe,ce,_e)=>{const Ee=getCommand(_e.cmd,_e.shorthands,_e.options.fixSmartQuotes);_e.cmd="";const{cmdName:ye,cmdRest:be}=splitCommand(Ee),Te=ye;Te!=null&&Te!=="CMD_NODE"&&ae.push({raw:Ee,type:Te,code:be})})}return ae}async function getMetadata(e){const r="docProps/app.xml",t="docProps/core.xml",v=await n(e),I=await A(v,r),b=await A(v,t);function N(X){if(X._children.length===0)return;const G=X._children[0];if(G._fTextNode)return G._text;throw new Error("Not a text node")}function T(X,G){for(const ve of X._children)if(!ve._fTextNode&&ve._tag===G)return N(ve)}const ae=X=>{const G=Number(X);if(Number.isFinite(G))return G};return{pages:ae(T(I,"Pages")),words:ae(T(I,"Words")),characters:ae(T(I,"Characters")),lines:ae(T(I,"Lines")),paragraphs:ae(T(I,"Paragraphs")),company:T(I,"Company"),template:T(I,"Template"),title:T(b,"dc:title"),subject:T(b,"dc:subject"),creator:T(b,"dc:creator"),description:T(b,"dc:description"),lastModifiedBy:T(b,"cp:lastModifiedBy"),revision:T(b,"cp:revision"),lastPrinted:T(b,"cp:lastPrinted"),created:T(b,"dcterms:created"),modified:T(b,"dcterms:modified"),category:T(b,"cp:category")}}async function A(e,r){const t=await s$1(e,r);if(t==null)throw new TemplateParseError(`${r} could not be read`);const v=await p$2(t);if(v._fTextNode)throw new TemplateParseError(`${r} is a text node when parsed`);return v}async function readContentTypes(e){return await A(e,J)}function getMainDoc(e){const r=["application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml","application/vnd.ms-word.document.macroEnabled.main+xml"];for(const t of e._children)if(!t._fTextNode&&t._attrs.ContentType!=null&&r.includes(t._attrs.ContentType)){const v=t._attrs.PartName;if(v)return v.replace("/word/","")}throw new TemplateParseError(`Could not find main document (e.g. document.xml) in ${J}`)}const Y=async(e,r,t)=>{const v=Object.keys(e);if(!v.length)return;const I=`${g}/_rels/${r}.rels`,b=await F(t,I);for(const T of v){const{extension:ae,data:X}=e[T],G=`template_${r}_${T}${ae}`,ve=`${g}/media/${G}`;typeof X=="string"?a$2(t,ve,X):o(t,ve,X),p$1(b,c$1("Relationship",{Id:T,Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",Target:`media/${G}`}))}const N=u$2(b,{literalXmlDelimiter:C});p$3(t,I,N)},K=async(e,r,t)=>{const v=Object.keys(e);if(v.length){const I=`${g}/_rels/${r}.rels`,b=await F(t,I);for(const T of v){const{url:ae}=e[T];p$1(b,c$1("Relationship",{Id:T,Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",Target:ae,TargetMode:"External"}))}const N=u$2(b,{literalXmlDelimiter:C});p$3(t,I,N)}},ee=async(e,r,t)=>{const v=Object.keys(e);if(v.length){const I=`${g}/_rels/${r}.rels`,b=await F(t,I);for(const T of v){const ae=e[T],X=`template_${r.replace(/\./g,"_")}_${T}.html`,G=`${g}/${X}`;p$3(t,G,ae),p$1(b,c$1("Relationship",{Id:T,Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/aFChunk",Target:`${X}`}))}const N=u$2(b,{literalXmlDelimiter:C});p$3(t,I,N)}},F=async(e,r)=>{let t=await s$1(e,r);return t||(t=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
        <Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">
        </Relationships>`),p$2(t)},te=e=>e?typeof e=="string"?[e,e]:e:[W,W];export{CommandExecutionError,CommandSyntaxError,ImageError,IncompleteConditionalStatementError,InternalError,InvalidCommandError,NullishCommandResultError,ObjectCommandResultError,TemplateParseError,UnterminatedForLoopError,ue as createReport,getMetadata,listCommands};
//# sourceMappingURL=browser.js.map